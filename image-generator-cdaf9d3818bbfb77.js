(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6780],{17231:function(e,t,i){"use strict";Object.defineProperty(t,"Z",{enumerable:!0,get:function(){return s}});var l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var i=n(t);if(i&&i.has(e))return i.get(e);var l={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=a?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(l,o,r):l[o]=e[o]}return l.default=e,i&&i.set(e,l),l}(i(2784)),a=r(i(75543)),o=r(i(96736));function r(e){return e&&e.__esModule?e:{default:e}}function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(n=function(e){return e?i:t})(e)}var s=l.forwardRef(function(e,t){var i,r;return l.createElement(o.default,(i=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},l=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),l.forEach(function(t){var l;l=i[t],t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l})}return e}({},e),r=r={ref:t,icon:a.default},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):(function(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);i.push.apply(i,l)}return i})(Object(r)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(r,e))}),i))})},88664:function(e,t,i){"use strict";var l,a=i(2784);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}t.Z=function(e){return a.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:16,height:17,fill:"none"},e),l||(l=a.createElement("path",{stroke:"#fff",strokeWidth:1.2,d:"m8 4.675-.935-.934a3.2 3.2 0 0 0-4.798.316 3.73 3.73 0 0 0 .24 4.83l1.979 2.104 3 2.996a.727.727 0 0 0 1.028 0l3-2.996 1.978-2.104a3.73 3.73 0 0 0 .241-4.83 3.2 3.2 0 0 0-4.798-.316z"})))}},15041:function(e,t,i){"use strict";var l,a=i(2784);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}t.Z=function(e){return a.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:16,height:17,fill:"none"},e),l||(l=a.createElement("path",{fill:"#FC4B51",stroke:"#FC4B51",strokeWidth:1.2,d:"m8 4.675-.935-.934a3.2 3.2 0 0 0-4.798.316 3.73 3.73 0 0 0 .24 4.83l1.979 2.104 3 2.996a.727.727 0 0 0 1.028 0l3-2.996 1.978-2.104a3.73 3.73 0 0 0 .241-4.83 3.2 3.2 0 0 0-4.798-.316z"})))}},54372:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ai-tool/image-generator",function(){return i(50590)}])},67894:function(e,t,i){"use strict";i.d(t,{I:function(){return a},b:function(){return l}});let l={closeTimeout:12e4,localKey:"AccelerationActivity",localData:{time:0,lastOpenTime:"2025-03-13T12:40:17.089Z"},maxTime:5,intervalTime:36e5},a={localKey:"AccelerationActivityAbtest",localData:{time:0,lastOpenTime:"2025-03-13T12:40:17.089Z"},maxTime:10,intervalTime:18e5,queueNum:30}},40045:function(e,t,i){"use strict";i.d(t,{Z:function(){return eH}});var l,a=i(52322),o=i(2784),r=i(5632),n=i(27134),s=i(36671),d=i(28879),c=i.n(d),u=i(56804),m=i(66012),p=i(55),v=i.n(p),g=i(16409),h=i.n(g),x=i(13830),f=i(25620),b=i(65085),j=i(55208),_=i(14959),y=i(46792),N=i(5394),w=i(76018),I=i(23363),T=i(38493),k=i(3554),M=i(64031),D=i(57842),S=i(97453),C=i(31763),L=i(7319),U=i.n(L),O=i(30051),P=i.n(O),E=i(21124),V=i(7731),z=i(20334),A=e=>{let{isMobile:t}=(0,I.z9)(),{scrollToBottom:i,tasks:l,classNames:r}=e,{isDark:n}=(0,z.f)(),[s,d]=(0,o.useState)(0),c=(0,o.useRef)(0),u=(0,o.useRef)(0),m=(0,j.aV)("unReadTasks"),p=(0,o.useMemo)(()=>{var e,t;if(!m.length&&!l.length)return null;let i=(null==l?void 0:null===(e=l.at(-1))||void 0===e?void 0:e.mediaType)||(null==m?void 0:null===(t=m.at(-1))||void 0===t?void 0:t.mediaType);return i},[l,m]),v=(0,o.useMemo)(()=>p===V.MR?"https://liblibai-online.liblib.cloud/web/e6484f0bca9c4ff7aaa019eb46405170/9fc53939-e147-4ba7-89f8-3ba44b2b73c8.svg":"https://liblibai-online.liblib.cloud/web/e6484f0bca9c4ff7aaa019eb46405170/cb8bb91f-7d31-4e9a-8c4a-b40cc6d078cf.svg",[p]),g=()=>{let e=c.current-1;c.current=e};(0,o.useEffect)(()=>(T.Y.on("updateUnReadTaskCount",g),()=>{T.Y.off("updateUnReadTaskCount",g)}),[]),(0,o.useEffect)(()=>{d(Math.max(c.current,l.length)),u.current=l.length},[l.length]),(0,o.useEffect)(()=>{c.current=s},[s]);let h=(0,o.useMemo)(()=>{let e="";if(s){let t=s-l.length;e=l.length>0?"".concat(t>0?t:0,"/").concat(s," 生成中… "):"".concat(s,"/").concat(s," 生成完成 ")}return e},[l,s]);return(0,a.jsx)("button",{onClick:()=>{if(i(),c.current>0){let e=(0,j.hC)("searchParams"),t=(0,j.hC)("unReadTasks"),i=e.generateType,l=(0,V.jm)(t,i);if(i&&l){let t={...e,generateType:0,timeRange:"lastThreeMonths"};T.Y.emit("updateSearchParams",t),(0,j.qb)({searchParams:t,unReadTasks:[]})}u.current||setTimeout(()=>{d(0)},100)}},style:{borderWidth:"0.5px",minWidth:!t&&h?"220px":"110px"},className:"absolute h-[36px] right-0 gap-[2px] py-[8px] text-[14px] px-[8px] pr-[4px] rounded-[12px] text-[#666] flex items-center justify-center transition-all z-50 ml-[271px] w-fit min-w-[110px] \n  bg-[#F8F8F8] border border-solid border-[#E5E5E5] backdrop-blur-sm dark:bg-[rgba(21,21,31,0.94)] dark:border dark:border-solid dark:border-[rgba(13,13,13,0.10)] dark:text-[rgba(255,255,255,0.85)] ".concat(r||""),children:t?(0,a.jsxs)(a.Fragment,{children:["回到底部",(0,a.jsx)("img",{height:14,className:"block opacity-80 dark:opacity-100",src:n?U():P(),width:10})]}):(0,a.jsxs)(a.Fragment,{children:[!!s&&(0,a.jsx)(a.Fragment,{children:(null==l?void 0:l.length)?(0,a.jsx)("div",{className:"h-12 w-12 rounded-[8px] -ml-[18px] mr-1 flex items-center justify-center shrink-0",style:{background:p===V.MR?"linear-gradient(163deg, #4CA6FF 11.74%, #9AD7FF 91.28%)":"linear-gradient(163deg, #FFB223 11.74%, #FFD994 91.28%)"},children:(0,a.jsx)(E.Z,{className:"animate-spin"})}):(0,a.jsx)("img",{src:v,alt:"last task media type",className:"h-12 w-12 rounded-[8px] -ml-[18px] mr-1 shrink-0"})}),(0,a.jsxs)("div",{className:"shrink-0 w-fit flex gap-[2px]",children:[h," 回到底部",(0,a.jsx)("img",{height:14,className:"block opacity-80 dark:opacity-100",src:n?U():P(),width:10})]})]})})},Z=i(76378),R=i(98757),F=i(11187),G=i(6364),H=i(41625),W=i(64365),B=i(54941),Y=i(76882),q=i(29072),Q=i(966),J=i(88664),K=i(15041),X=i(72673),$=i(33988),ee=i(65829);function et(e){let{data:t,onDrawSameModel:i,onHandleLike:l,isSelected:r=!1,index:n,isMobile:s=!1}=e,{menuConfig:d}=(0,X.W)(),c=(0,ee.sz)(t.imageUrl,600),u=null==t?void 0:t.videoUrl,[m,p]=(0,o.useState)(null==t?void 0:t.isLike),[v,g]=(0,o.useState)(null==t?void 0:t.likeCount),h=(0,o.useRef)({}),x=(0,o.useMemo)(()=>{var e;let i=null==t?void 0:t.baseType;if(!i)return"";{if(30===i&&(null==t?void 0:t.uuid)==="028c029e7d3747abb19fb686da52ac71")return"Seedream 3.0";let l=[...(null==d?void 0:d.TYPE_LIST)||[],...(null==d?void 0:d.VIDEO_TYPE_LIST)||[]];return(null==l?void 0:null===(e=l.find(e=>e.id===i))||void 0===e?void 0:e.name)||""}},[t,null==d?void 0:d.TYPE_LIST,null==d?void 0:d.VIDEO_TYPE_LIST]),f=()=>{if(p(!m),m){let e=v-1>0?v-1:0;g(e)}else g(v+1);null==l||l(t)};return(0,a.jsxs)("div",{className:"w-full aspect-[3/4] rounded-[12px] overflow-hidden relative bg-red bg-[#f0f0f0] dark:bg-[#20242A] cursor-pointer group",onMouseEnter:()=>{let e=h.current[t.uuid];e&&!s&&e&&e.play().catch(e=>{console.warn("视频自动播放失败:",e)})},onMouseLeave:()=>{let e=h.current[t.uuid];e&&!s&&e&&(e.pause(),e.currentTime=0)},onClick:()=>i(t,n),children:[t.webpUrl?(0,a.jsx)("img",{src:t.webpUrl,className:"w-full h-full object-cover rounded-[12px]",alt:(null==t?void 0:t.title)||"inspiration cover"}):u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{src:c,className:"w-full h-full object-cover rounded-[12px] duration-200",alt:(null==t?void 0:t.title)||"inspiration cover"}),u?(0,a.jsx)("video",{src:u,className:"w-full h-full object-cover rounded-[12px] absolute inset-0 transition-opacity duration-200 opacity-0 group-hover:!opacity-100 ".concat(s||r?"!opacity-100":""),muted:!0,loop:!0,playsInline:!0,preload:"none",autoPlay:s,ref:e=>{h.current[t.uuid]=e},poster:c}):null]}):(0,a.jsx)("img",{src:c,className:"w-full h-full object-cover rounded-[12px]",alt:(null==t?void 0:t.title)||"inspiration cover"}),(0,a.jsxs)("div",{className:"absolute bottom-0 left-0 w-full h-full flex p-2 items-start justify-between flex-col gap-2",style:{background:"linear-gradient(180deg, rgba(0, 0, 0, 0.00) 68.85%, rgba(0, 0, 0, 0.50) 100%)"},children:[(0,a.jsx)("div",{className:"text-[10px] rounded-[12px] bg-black/50 text-white px-3 py-1 ".concat(!s&&x?"opacity-100":"opacity-0"),children:x}),!r&&(0,a.jsx)("div",{className:"text-white line-clamp-1 text-ellipsis w-full overflow-hidden text-left ".concat(s?"text-[12px]":"text-[13px]"),children:null==t?void 0:t.title})]}),r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"absolute bottom-0 left-0 w-full h-full border-2 border-[#1F6DFF] rounded-[12px]"}),(0,a.jsx)("div",{className:"absolute bottom-[1px] right-[1px]",children:(0,a.jsxs)("svg",{width:"60",height:"25",viewBox:"0 0 60 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("path",{d:"M6.2293 16.7733C7.1184 9.67759 13.1479 4.35183 20.2991 4.3457L47.2668 4.3226C50.8782 4.3195 54.4214 3.33861 57.5203 1.48403L60 0V15C60 20.5228 55.5228 25 50 25H0L3.00832 22.5653C4.79001 21.1233 5.94433 19.0476 6.2293 16.7733Z",fill:"#1F6DFF"}),(0,a.jsx)("path",{d:"M20.104 10.288H23.116V9.16H24.256V10.288H27.484V11.38H24.256V12.328H27.028V15.892H24.208C24.112 16.876 23.932 17.656 23.656 18.22C24.808 18.808 26.116 19.132 27.58 19.204L27.304 20.296C25.672 20.188 24.244 19.792 23.008 19.096C22.36 19.708 21.352 20.104 19.984 20.296L19.492 19.264C20.62 19.168 21.46 18.892 22 18.448C21.34 17.956 20.752 17.38 20.224 16.732L21.1 16.132C21.556 16.696 22.072 17.188 22.648 17.596C22.84 17.14 22.984 16.576 23.056 15.892H20.44V12.328H23.116V11.38H20.104V10.288ZM25.96 14.872V13.336H24.256V14.872H25.96ZM23.116 14.872V13.336H21.508V14.872H23.116ZM17.752 13.948C17.428 14.356 17.08 14.764 16.72 15.16L16.348 13.936C17.524 12.544 18.388 10.924 18.94 9.064L20.02 9.568C19.732 10.48 19.36 11.344 18.904 12.184V20.26H17.752V13.948ZM30.712 13.516V15.352H33.472V13.516H30.712ZM30.652 16.408C30.508 17.92 30.064 19.168 29.32 20.152L28.444 19.372C29.164 18.34 29.536 17.032 29.56 15.448V9.568H38.764V18.604C38.764 19.504 38.296 19.96 37.384 19.96H36.004L35.704 18.844C36.172 18.88 36.604 18.904 37.012 18.904C37.396 18.904 37.6 18.664 37.6 18.196V16.408H34.624V19.828H33.472V16.408H30.652ZM37.6 15.352V13.516H34.624V15.352H37.6ZM37.6 12.472V10.672H34.624V12.472H37.6ZM33.472 10.672H30.712V12.472H33.472V10.672ZM45.412 9.112H46.588V11.188H50.86V16.984H49.72V16.3H46.588V20.32H45.412V16.3H42.292V16.984H41.152V11.188H45.412V9.112ZM42.292 15.184H45.412V12.304H42.292V15.184ZM46.588 15.184H49.72V12.304H46.588V15.184Z",fill:"white"})]})})]}),!s&&(0,a.jsxs)("div",{className:"absolute bottom-0 left-0 w-full h-full bg-black/30 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[l&&(0,a.jsxs)("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),f()},className:"absolute top-1 h-8 right-2 flex justify-center items-center rounded-[8px] cursor-pointer",children:[m?(0,a.jsx)(K.Z,{}):(0,a.jsx)(J.Z,{}),(0,a.jsx)("span",{className:"ml-1 text-white text-[12px] ",children:(0,$.x)(v||0)})]}),(0,a.jsx)("div",{onClick:e=>{e.stopPropagation(),e.preventDefault(),i(t,n)},className:"absolute bottom-2 left-2 cursor-pointer w-[calc(100%-16px)] h-9 bg-white rounded-[8px] flex justify-center items-center text-[#303030] font-[500] text-[14px]",children:"做同款"})]})]})}var ei=i(87234),el=i.n(ei),ea=e=>{let{isExpanded:t,onExpandedChange:i}=e,{isMobile:l}=(0,I.z9)(),{simpleGeneratorType:n}=(0,D.j)(),[s,d]=(0,o.useState)([]),[c,u]=(0,o.useState)(!1),[m,p]=(0,o.useState)(!0),[v,g]=(0,o.useState)(1),h=(0,o.useRef)((0,G.Z)()),x=(0,o.useRef)([]),b=(0,o.useRef)(null),[j,_]=(0,o.useState)(!1),[w,T]=(0,o.useState)(!1),[M,S]=(0,o.useState)(!0),[C,L]=(0,o.useState)(void 0),U=(0,o.useMemo)(()=>l?162:872,[l]),O=void 0!==t?t:M,P=i||S,{taskQueuePriority:E}=(0,B.uA)("generatorData"),z=(0,B.uA)("generatorData"),A=(0,N.T4)(),Z=(0,r.useRouter)(),{query:J}=Z,{collectionId:K,ps:X}=J,$=(0,o.useRef)(v),ee=(0,o.useMemo)(()=>n===V.oZ.IMAGE,[n]),ei=(0,o.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{var t;u(!0);let i={page:$.current,pageSize:ee?20:X||20,cid:(0,q.ey)(),requestId:h.current,scene:ee?"ImgGenerator":"VideoGenerator"+(K?"-".concat(K):"")},l=(0,Q.Cb)("checkpointId");l&&(i.modelVersionId=parseInt(l));let a=await k.i7.getList(i),o=(0,Y.c)(a),{data:r}=o;if((null==r?void 0:r.length)>0){if(e)d(e=>[...e,...r]);else if(d(r),K){let e=Math.floor(Math.random()*r.length);setTimeout(()=>{ea(r[e],e)},400)}p(null==a?void 0:a.hasMore)}else p(!1);g(e=>e+1);let n=null==r?void 0:null===(t=r.map(e=>e.uuid))||void 0===t?void 0:t.filter(e=>e);A({e:"lib.editor.exchange",t:2,var:{batch_uuid_list_before:x.current,batch_uuid_list_after:n}}),x.current=n}catch(e){console.error("获取图片列表失败:",e)}finally{u(!1)}},[v,ee]);(0,o.useEffect)(()=>{$.current=v},[v]),(0,o.useEffect)(()=>{g(1),$.current=1,setTimeout(()=>{ei()},200);let e=n===V.oZ.IMAGE?"lib.image.editor.inspiration.show":"lib.video.editor.inspiration.show";A({e:e,t:1})},[n]);let ea=(0,o.useCallback)(async(e,t)=>{try{var i,l,a,o,r,n,s,d,c,u,m;L(null==e?void 0:e.uuid);let t=await (0,R.ZN)(null==e?void 0:e.imageUuid);if(!(null==t?void 0:t.pngInfo)){F.ZP.error("缺少生图信息，请稍后重试");return}let p=JSON.parse(t.generateInfo),v=JSON.parse(t.pngInfo),g=p||v||{},h=t.v2MixModels||t.v2Models,x=h.find(e=>e.baseType);if(!x){F.ZP.error("缺少生图信息");return}let f={},b=null==v?void 0:null===(i=v.frontCustomerReq)||void 0===i?void 0:i.overallStore;if((null==t?void 0:t.contentId)&&!b&&!(null==g?void 0:g.generateId))try{f=await (0,H.Ci)(null==t?void 0:t.contentId).then(JSON.parse)}catch(e){console.error("画同款totalPngInfo获取失败",e)}let j=x.baseType,_=[];if((null===(l=g.additionalNetwork)||void 0===l?void 0:l.length)>0||(null===(o=f)||void 0===o?void 0:null===(a=o.additionalNetwork)||void 0===a?void 0:a.length)>0){let e=g.additionalNetwork||(null===(d=f)||void 0===d?void 0:d.additionalNetwork)||[];g.additionalNetwork=e.map(e=>{var i,l;if(_.push({lora_name:e.modelName,lora_version_id:e.modelId}),e.imageUrl)return e;if((null===(i=t.v2MixModels)||void 0===i?void 0:i.length)>0||(null===(l=t.v2Models)||void 0===l?void 0:l.length)>0){let i=t.v2MixModels||t.v2Models,l=i.find(t=>t.versionId===e.modelId);return{...e,imageUrl:null==l?void 0:l.imageUrl}}return{...e,imageUrl:(null==e?void 0:e.imageUrl)||(null==e?void 0:e.referenceImage)}})}if(Object.values(V.q2).includes(j)||(j=V.q2.F1),(null==v?void 0:null===(r=v.frontCustomerReq)||void 0===r?void 0:r.overallStore)||(null===(s=f)||void 0===s?void 0:null===(n=s.frontCustomerReq)||void 0===n?void 0:n.overallStore))(0,B.ae)((null==v?void 0:null===(c=v.frontCustomerReq)||void 0===c?void 0:c.overallStore)||(null===(m=f)||void 0===m?void 0:null===(u=m.frontCustomerReq)||void 0===u?void 0:u.overallStore));else{let{text2img:e="",img2img:t=""}=f||{};(0,W.$)({text2img:e,img2img:t,...g,baseType:j,taskQueuePriority:E})}(0,B.ae)({promptMagicInit:!1});let y=null==z?void 0:z.width,N=null==z?void 0:z.height,w=null;if(y&&N){let e=(t,i)=>0===i?t:e(i,t%i),t=e(y,N);w="".concat(y/t,":").concat(N/t)}else w=null;setTimeout(()=>{A({e:"lib.image.editor.redraw",t:2,var:{detail_uuid:null==e?void 0:e.imageUuid,batch_uuid:null==e?void 0:e.uuid,prompt:g.prompt,ckp_model_name:g.checkPointName,ckp_model_uuid:g.checkPointModelUuid,lora_list:_,img_size:w,img_cnt:z.count}})},200)}catch(e){console.error("处理图片数据失败:",e),F.ZP.error("处理图片数据失败，请稍后重试")}},[E,z]),eo=(0,o.useCallback)(async(e,t)=>{try{var i,l,a,o,r,n,s;L(null==e?void 0:e.uuid);let t=await (0,R.ZN)(null==e?void 0:e.imageUuid);if(t.metainformation){console.log("remoteDetailInfo",t);let d=JSON.parse(t.metainformation),c=null==d?void 0:null===(i=d.frontCustomerReq)||void 0===i?void 0:i.overallStore,u=[];c?(0,y.setVideoGeneratorState)({...c,drawSource:!0,promptMagicInit:!1}):(null==d?void 0:null===(l=d.frontCustomerReq)||void 0===l?void 0:l.tabType)&&((0,f.$)(d),(0,y.setVideoGeneratorState)({drawSource:!0,promptMagicInit:!1})),null==c||null===(a=c.videoEffectList)||void 0===a||a.forEach(e=>{u.push({lora_name:e.name,lora_version_id:e.versionId,lora_model_uuid:e.versionUuid})}),A({e:"lib.video.editor.redraw",t:2,var:{detail_uuid:null==e?void 0:e.imageUuid,batch_uuid:null==e?void 0:e.uuid,prompt:null==c?void 0:null===(o=c.generatorData)||void 0===o?void 0:o.prompt,ckp_model_name:null==c?void 0:null===(r=c.generatorData)||void 0===r?void 0:r.modelName,ckp_model_uuid:null==c?void 0:null===(n=c.generatorData)||void 0===n?void 0:n.checkpointId,lora_list:u,img_size:null==c?void 0:null===(s=c.generatorData)||void 0===s?void 0:s.ratio,img_cnt:1}})}else t.contentId&&((0,f.H)(t.contentId),(0,y.setVideoGeneratorState)({drawSource:!0,promptMagicInit:!1}))}catch(e){console.error("处理视频数据失败:",e),F.ZP.error("处理视频数据失败，请稍后重试")}},[]),er=(0,o.useCallback)(()=>{P(e=>!e)},[]),en=(0,o.useCallback)(()=>{if(b.current){let{scrollLeft:e,scrollWidth:t,clientWidth:i}=b.current;_(e>0),T(e<t-i-1);let l=e>=t-i-100;l&&m&&!c&&ei(!0)}},[m,c,ei]);return((0,o.useEffect)(()=>{let e=b.current;return e&&e.addEventListener("scroll",en),()=>{e&&e.removeEventListener("scroll",en)}},[en]),(0,o.useEffect)(()=>{let e=()=>{if(b.current){let{scrollWidth:e,clientWidth:t}=b.current;T(e>t)}};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[s]),0===s.length)?null:(0,a.jsxs)("div",{className:"pb-4 b768:pb-11",children:[!l&&(0,a.jsx)("div",{className:el().imgListWrapTitle,children:(0,a.jsx)("div",{className:el().imgListWrapTitleLeftTitle,children:(0,a.jsxs)("div",{className:el().imgListWrapTitleLeftTitleText,onClick:er,children:[ee?"图像灵感库":"视频灵感库",(0,a.jsx)("svg",{className:"".concat(el().expandIcon," ").concat(O?"":el().expanded),xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,a.jsx)("path",{d:"M15 7.5L10 12.5L5 7.5",stroke:"#A3A3A3",strokeWidth:"2.08333",strokeLinecap:"round",strokeLinejoin:"round"})})]})})}),(0,a.jsxs)("div",{className:"".concat(el().container," ").concat(O?el().expanded:el().collapsed),children:[j&&O&&(0,a.jsx)("div",{onClick:()=>{b.current&&b.current.scrollBy({left:-U,behavior:"smooth"})},className:"".concat(el().arrowButtonWrap," ").concat(l?"left-4":"left-5"),children:(0,a.jsx)("div",{className:"".concat(el().arrowButton," rotate-180"),children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 28 28",fill:"none",children:(0,a.jsx)("path",{d:"M10.5 7L17.5 14L10.5 21",stroke:"#ffffff",strokeWidth:"2.91667",strokeLinecap:"round",strokeLinejoin:"round"})})})}),(0,a.jsx)("div",{className:el().scrollContainer,ref:b,children:(0,a.jsxs)("div",{className:el().imgListWrap,children:[s.map((e,t)=>(0,a.jsx)("div",{className:el().imgItemCard,children:(0,a.jsx)(et,{data:e,onDrawSameModel:ee?ea:eo,index:t,isSelected:C==e.uuid,isMobile:l},e.uuid+t)},e.uuid+t)),c&&O&&(0,a.jsxs)("div",{className:el().loadingIndicator,children:[(0,a.jsx)("div",{className:el().loadingSpinner}),(0,a.jsx)("span",{children:"加载中..."})]})]},n)}),w&&O&&(0,a.jsx)("div",{onClick:()=>{if(b.current){let{scrollLeft:e,scrollWidth:t,clientWidth:i}=b.current;b.current.scrollTo({left:Math.min(t-i,e+U),behavior:"smooth"})}},className:"".concat(el().arrowButtonWrap," ").concat(l?"right-4":"right-5"),children:(0,a.jsx)("div",{className:"".concat(el().arrowButton),children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 28 28",fill:"none",children:(0,a.jsx)("path",{d:"M10.5 7L17.5 14L10.5 21",stroke:"#ffffff",strokeWidth:"2.91667",strokeLinecap:"round",strokeLinejoin:"round"})})})})]})]})},eo=i(17231),er=i(53625),en=i(14321),es=i(64749);i(98833);var ed=i(55825),ec=i.n(ed);c().locale("zh-cn");let eu=[{label:"全部",value:"all"},{label:"最近一周",value:"lastWeek"},{label:"最近一个月",value:"lastMonth"},{label:"最近三个月",value:"lastThreeMonths"}],em=[{label:"全部",value:0},{label:"图片",value:V.MR},{label:"视频",value:V.iC},{label:"数字人",value:V.nY},{label:"动作模仿",value:V.Aw}],ep=em.reduce((e,t)=>(e[t.value]=t.label,e),{}),ev=eu.reduce((e,t)=>(e[t.value]=t.label,e),{});var eg=e=>{let{onSearch:t}=e,[i,l]=(0,o.useState)(!1),[r,s]=(0,o.useState)(!1),[d,u]=(0,o.useState)("lastThreeMonths"),[m,p]=(0,o.useState)(0),[v,g]=(0,o.useState)(null),[h,x]=(0,o.useState)(!1),[f,b]=(0,o.useState)(!1),_=(0,j.aV)("unReadTasks"),[y,w]=(0,o.useState)(!1),k=(0,o.useRef)(!1),M="dark"===(0,n.X)().colorScheme,{isMobile:D}=(0,I.z9)(),S=(0,N.T4)(),C=e=>{let i=e||(0,j.hC)("searchParams");p((null==i?void 0:i.generateType)||0);let{fromTime:l,toTime:a,timeRange:o}=i||{};o?u(o):g(l&&a?[c()(l),c()(a)]:null),e&&(null==t||t()),w(!1)};(0,o.useEffect)(()=>(C(),T.Y.on("updateSearchParams",C),()=>{T.Y.off("updateSearchParams",C)}),[]),(0,o.useEffect)(()=>{if(_.length>0&&m){let e=(0,V.jm)(_,m);e&&w(!0)}else w(!1)},[_,m]),(0,o.useEffect)(()=>{k.current=y},[y]);let L=e=>{try{S({e:"lib.editor.filter",t:2,var:e})}catch(e){console.error("编辑器筛选埋点上报错误",e)}},U=e=>{var i,a,o,r;u(e),g(null);let n=null;"all"===e?n=null:"lastWeek"===e?n=[c()().subtract(7,"day").startOf("day"),c()().endOf("day")]:"lastMonth"===e?n=[c()().subtract(1,"month").startOf("day"),c()().endOf("day")]:"lastThreeMonths"===e&&(n=[c()().subtract(3,"month").startOf("day"),c()().endOf("day")]),L({range:(null==ev?void 0:ev[e])||""}),(0,j.qb)({searchParams:{...(0,j.hC)("searchParams"),fromTime:(null===(a=n)||void 0===a?void 0:null===(i=a[0])||void 0===i?void 0:i.format("YYYY-MM-DD HH:mm:ss"))||"",toTime:(null===(r=n)||void 0===r?void 0:null===(o=r[1])||void 0===o?void 0:o.format("YYYY-MM-DD HH:mm:ss"))||"",timeRange:e}}),setTimeout(()=>{null==t||t()},100),l(!1)},O=(e,i)=>{var a,o,r,n;l(!0);let s=[(null==v?void 0:v[0])||null,e];"start"===i&&(s=[e,(null==v?void 0:v[1])||null]);let d="";s[0]||s[1]||(d="all",u("all")),g(s);let m=(null===(o=s)||void 0===o?void 0:null===(a=o[0])||void 0===a?void 0:a.format("YYYY-MM-DD HH:mm:ss"))||"",p=(null===(n=s)||void 0===n?void 0:null===(r=n[1])||void 0===r?void 0:r.endOf("day").format("YYYY-MM-DD HH:mm:ss"))||c()().endOf("day").format("YYYY-MM-DD HH:mm:ss");(0,j.qb)({searchParams:{...(0,j.hC)("searchParams"),fromTime:m,toTime:p,timeRange:d}}),setTimeout(()=>{null==t||t()},100),L({range:"".concat(m," ~ ").concat(p)}),(s[0]||s[1])&&u(null)},P=e=>{p(e),L({gen_type:(null==ep?void 0:ep[e])||""}),k.current&&(0,j.qb)({unReadTasks:[]}),(0,j.qb)({searchParams:{...(0,j.hC)("searchParams"),generateType:e}}),s(!1),setTimeout(()=>{null==t||t()},100)},E=(0,o.useMemo)(()=>{let e=new Set;return _.forEach(t=>{e.add(t.mediaType)}),e},[_]);return(0,a.jsxs)("div",{className:"".concat(ec().editorSearchContainer," ").concat(M?ec().editorSearchContainerDark:""),children:[(0,a.jsx)("div",{className:ec().timeSelectWrapper,children:(0,a.jsx)(es.default,{open:i,onOpenChange:e=>{l(e)},value:(()=>{var e,t;if(d){let e=eu.find(e=>e.value===d);return e&&"全部"!==e.label?null==e?void 0:e.label:""}if(v){let i=(null==v?void 0:null===(e=v[0])||void 0===e?void 0:e.format("YYYY-MM-DD"))||"开始",l=(null==v?void 0:null===(t=v[1])||void 0===t?void 0:t.format("YYYY-MM-DD"))||c()().format("YYYY-MM-DD");return"".concat(i," - ").concat(l)}return""})()||void 0,placeholder:"时间",size:"small",placement:"bottomRight",className:"editor-search-time-select ".concat(ec().select),popupMatchSelectWidth:!1,classNames:{popup:{root:ec().timeDropdown}},popupRender:()=>(0,a.jsxs)("div",{className:ec().timeDropdownContent,onClick:e=>{e.stopPropagation()},children:[(0,a.jsxs)("div",{className:ec().dateRangeSection,children:[(0,a.jsx)(en.default,{value:d?null:(null==v?void 0:v[0])||null,onChange:e=>O(e,"start"),format:"YYYY-MM-DD",className:ec().datePicker,size:"middle",open:h,classNames:{popup:{root:ec().datePickerDropdown}},onOpenChange:e=>{x(e),l(!0)},getPopupContainer:e=>e.parentElement||document.body,placeholder:"开始日期",variant:"filled"}),(0,a.jsx)("div",{className:"w-2 h-[1px] bg-[#D9D9D9]"}),(0,a.jsx)(en.default,{value:d?null:(null==v?void 0:v[1])||null,onChange:e=>O(e,"end"),format:"YYYY-MM-DD",className:ec().datePicker,size:"middle",open:f,onOpenChange:e=>{b(e),l(!0)},classNames:{popup:{root:ec().datePickerDropdown}},getPopupContainer:e=>e.parentElement||document.body,placeholder:"结束日期",variant:"filled",disabledDate:e=>null!=v&&!!v[0]&&!d&&e&&e<v[0]})]}),eu.map(e=>(0,a.jsxs)("div",{onClick:()=>U(e.value),className:"".concat(ec().timeOption," ").concat(d===e.value?ec().timeOptionSelected:""),children:[(0,a.jsx)("span",{children:e.label}),d===e.value&&(0,a.jsx)(eo.Z,{className:ec().checkIcon})]},e.value))]}),suffixIcon:(0,a.jsx)(er.J,{className:"icon-border_".concat(i?"up":"down"," transition-transform ").concat(ec().suffixIcon),fontSize:14}),styles:{},allowClear:!1,autoFocus:!1,getPopupContainer:e=>e.parentElement||document.body,dropdownAlign:{offset:[D?20:0,D?10:0],targetOffset:[0,D?10:0]}})}),(0,a.jsx)("div",{className:ec().separator}),(0,a.jsx)("div",{className:ec().generationTypeWrapper,children:(0,a.jsx)(es.default,{placeholder:"生成类型",size:"small",open:r,onOpenChange:s,className:"editor-search-generation-select ".concat(ec().select),popupMatchSelectWidth:!1,styles:{popup:{root:{minWidth:"160px"}}},classNames:{popup:{root:ec().generationTypeDropdown}},value:(()=>{if(m){let e=em.find(e=>e.value==m);return(null==e?void 0:e.label)||""}return""})()||void 0,popupRender:()=>(0,a.jsx)("div",{className:ec().generationTypeDropdownContent,children:em.map(e=>(0,a.jsxs)("div",{onClick:()=>P(e.value),className:"".concat(ec().generationTypeOption," ").concat(m===e.value?ec().generationTypeOptionSelected:""," relative"),children:[(0,a.jsx)("span",{children:e.label}),m===e.value&&(0,a.jsx)(eo.Z,{className:ec().checkIcon}),y&&m!=e.value&&0!=e.value&&E.has(e.value)&&(0,a.jsx)("div",{className:"".concat(ec().unReadTag," !top-5 !right-[14px]")})]},e.value))}),suffixIcon:(0,a.jsx)(er.J,{className:"icon-border_".concat(r?"up":"down"," transition-transform ").concat(ec().suffixIcon),fontSize:14}),allowClear:!1,getPopupContainer:e=>e.parentElement||document.body})}),y&&(0,a.jsx)("div",{className:ec().unReadTag})]})},eh=i(6154),ex=i(89552),ef=i(94055),eb=i(9850),ej=i.n(eb),e_=i(39424),ey=i(32811),eN=i(95976),ew=i(88916),eI=i(98547);function eT(){return(eT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}var ek=function(e){return o.createElement("svg",eT({xmlns:"http://www.w3.org/2000/svg",width:16,height:17,fill:"none"},e),l||(l=o.createElement("path",{fill:"currentColor",d:"M8 2.066c3.881 0 7.266 2.539 7.267 5.934 0 1.925-1.112 3.593-2.76 4.657.067 1.507-.898 3.047-2.717 3.43l-.247-1.174c.948-.2 1.527-.86 1.707-1.604-.981.4-2.086.624-3.25.624-.852 0-1.54-.237-1.98-.713-.448-.483-.547-1.114-.418-1.685C5.852 10.418 6.979 9.4 8.5 9.4c1.147 0 2.073.308 2.753.835.424.328.738.732.947 1.173 1.174-.881 1.866-2.101 1.866-3.408 0-2.496-2.584-4.733-6.066-4.733q-.314 0-.62.024l-.095-1.196A9 9 0 0 1 8 2.065M2.22 6.56A3.8 3.8 0 0 0 1.934 8c0 1.487.892 2.861 2.375 3.752l-.619 1.029C1.935 11.726.732 10 .732 8c0-.664.134-1.301.377-1.895zm6.28 4.04c-.98 0-1.604.647-1.728 1.197-.058.262-.001.466.13.607.137.149.45.328 1.098.328a7.3 7.3 0 0 0 3.164-.698 2.03 2.03 0 0 0-.646-.852c-.434-.336-1.088-.583-2.018-.583M5.418 2.557a.133.133 0 0 1 .233 0l.47.859c.184.335.46.61.795.794l.858.47a.134.134 0 0 1 0 .235l-.858.468c-.335.184-.611.46-.795.796l-.47.859a.133.133 0 0 1-.233 0l-.47-.859a2 2 0 0 0-.796-.796l-.858-.468a.134.134 0 0 1 0-.235l.858-.47a2 2 0 0 0 .795-.795zM1.695.734a.134.134 0 0 1 .235 0l.285.52c.122.224.306.408.53.53l.52.286a.133.133 0 0 1 0 .233l-.52.285a1.34 1.34 0 0 0-.53.53l-.285.521a.134.134 0 0 1-.235 0l-.284-.52a1.34 1.34 0 0 0-.53-.53l-.52-.286a.133.133 0 0 1 0-.233l.52-.285c.223-.123.408-.307.53-.53z"})))},eM=i(69185),eD=i(53907),eS=i(53629),eC=i(56798),eL=i(40679),eU=i.n(eL);let eO=[{id:"video",tagLabel:"视频灵感"},{id:"image",tagLabel:"图片灵感"},{id:"like",tagLabel:"我的点赞"}],eP=[{id:"image",tagLabel:"图片"},{id:"video",tagLabel:"视频"}],eE=u.tY();function eV(){let e=(0,eI.P4)("inspirationLibraryOpen"),t=(0,eI.P4)("isShowCollected"),i=(0,eI.P4)("collectionName"),l=(0,eI.P4)("activeType"),r=(0,eI.P4)("collectionId"),{taskQueuePriority:d}=(0,B.uA)("generatorData"),{changeEditorMediaType:c,clearInspirationCollectionInfo:u}=(0,eM.N)(),{setShowFullGenerator:p,simpleGeneratorType:v}=(0,D.j)(),g=(0,N.T4)(),{isMobile:h}=(0,I.z9)(),x=(0,o.useRef)({page:1,pageSize:30}),[b,j]=(0,o.useState)([]),_=(0,o.useRef)((0,G.Z)()),w=(0,o.useRef)(l);(0,o.useRef)(!1);let[M,S]=(0,o.useState)("image"),C=(0,o.useRef)(M),[L,U]=(0,o.useState)(""),O=(0,o.useRef)(L),[P,E]=(0,o.useState)(!1),[z,A]=(0,o.useState)(!1),Z=(0,o.useRef)(null),[Q,J]=(0,o.useState)(!0),K=(0,o.useRef)(!1),X=(0,o.useRef)(!0),$=(0,o.useRef)(!1),ee=(0,o.useRef)(v),[ei,el]=(0,o.useState)(""),ea="dark"===(0,n.X)().colorScheme,eo=(0,o.useRef)(t),[er,en]=(0,o.useState)(!1),{getImageModelName:es}=(0,eD.cl)();(0,o.useEffect)(()=>(T.Y.on("showInspirationTip",e=>{en(e),setTimeout(()=>{en(!1)},5e3)}),()=>{T.Y.off("showInspirationTip",e=>{en(e)})}),[]),(0,o.useEffect)(()=>{eo.current=t},[t]),(0,o.useEffect)(()=>{ee.current=v},[v]),(0,o.useEffect)(()=>{K.current=P},[P]),(0,o.useEffect)(()=>{X.current=Q},[Q]),(0,o.useEffect)(()=>{w.current=l},[l]),(0,o.useEffect)(()=>{C.current=M},[M]);let ed=(0,o.useCallback)(()=>{setTimeout(()=>{let e=document.querySelector(".inspiration-library-scroll-container");e&&(e.scrollTop=0)},100)},[]),ec=()=>{x.current.page=1,ed(),setTimeout(()=>{j([]),eg(!0)},200)},eu=e=>{U(e),ec()};(0,o.useEffect)(()=>{O.current=L},[L]);let em=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(_.current=(0,G.Z)());let t={...x.current,cid:(0,q.ey)(),requestId:_.current,keyword:O.current||""};if("like"!==w.current&&(t.scene="video"===w.current?"VideoGenerateInspiration":"ImgGenerateInspiration"),"like"===w.current){let e="image"===C.current;t.liked=1,t.imageCapability=[1],t.imageFuncs=[1],t.imageSources=e?[5]:[6],t.mediaType=e?1:2,t.createTools=e?[5]:[6]}return eo.current&&(t.collectionId=r,t.scene="CollectionDirectSearch"),t},ep=async(e,t)=>{var i,l,a,o,r,n,s,u,m,v,h,x,b,j,_;try{g({e:"lib.editor.inspiration.draw.same.model",t:2,var:{batch_uuid:(null==e?void 0:e.uuid)||""}})}catch(e){console.error("灵感库画同款埋点上报失败",e)}let N=("image"===w.current||"like"===w.current&&"image"===C.current)&&!(null==e?void 0:e.videoUrl),I=await (0,R.ZN)(null==e?void 0:e.imageUuid),T=(null==I?void 0:I.metainformation)&&JSON.parse(I.metainformation),M=(null==T?void 0:T.generateType)===80,D=(null==T?void 0:T.generateType)===81;if(D&&ee.current!=V.oZ.ACTION_FOLLOW?c(V.oZ.ACTION_FOLLOW):N&&ee.current!=V.oZ.IMAGE?c(V.oZ.IMAGE):M&&ee.current!=V.oZ.DIGITAL_HUMAN?c(V.oZ.DIGITAL_HUMAN):N||M||ee.current==V.oZ.VIDEO||c(V.oZ.VIDEO),el((null==e?void 0:e.uuid)||""),p(!0),M){if(I.metainformation){let t=JSON.parse(I.metainformation),l=null==t?void 0:null===(i=t.frontCustomerReq)||void 0===i?void 0:i.overallStore,a=await k.i7.getImages(null==e?void 0:e.uuid),o=ej()(l);(null==a?void 0:a.audioPermissions)!==1&&o.generatorData.audio&&(o.generatorData.audio="",o.generatorData.voiceType&&(o.generatorData.voiceType="")),(0,eC.Qj)(o)}}else if(D){if(I.metainformation){let e=null==T?void 0:null===(l=T.frontCustomerReq)||void 0===l?void 0:l.overallStore;(0,eS.Mb)({...e})}}else if(N){let e=JSON.parse(null==I?void 0:I.generateInfo),t=JSON.parse(null==I?void 0:I.pngInfo),i=e||t||{},l=(null==I?void 0:I.v2MixModels)||(null==I?void 0:I.v2Models),a=null==l?void 0:l.find(e=>e.baseType);if(!a){F.ZP.error("缺少生图信息");return}let o={},c=null==t?void 0:null===(r=t.frontCustomerReq)||void 0===r?void 0:r.overallStore;if((null==I?void 0:I.contentId)&&!c&&!(null==i?void 0:i.generateId))try{o=await (0,H.Ci)(null==I?void 0:I.contentId).then(JSON.parse)}catch(e){console.error("画同款totalPngInfo获取失败",e)}let p=a.baseType,g=[];if((null===(n=i.additionalNetwork)||void 0===n?void 0:n.length)>0||(null===(u=o)||void 0===u?void 0:null===(s=u.additionalNetwork)||void 0===s?void 0:s.length)>0){let e=i.additionalNetwork||(null===(x=o)||void 0===x?void 0:x.additionalNetwork)||[];i.additionalNetwork=e.map(e=>{var t,i;if(g.push({lora_name:e.modelName,lora_version_id:e.modelId}),e.imageUrl)return e;if((null===(t=I.v2MixModels)||void 0===t?void 0:t.length)>0||(null===(i=I.v2Models)||void 0===i?void 0:i.length)>0){let t=I.v2MixModels||I.v2Models,i=t.find(t=>t.versionId===e.modelId);return{...e,imageUrl:null==i?void 0:i.imageUrl}}return{...e,imageUrl:(null==e?void 0:e.imageUrl)||(null==e?void 0:e.referenceImage)}})}if(Object.values(V.q2).includes(p)||(p=V.q2.F1),(null==t?void 0:null===(m=t.frontCustomerReq)||void 0===m?void 0:m.overallStore)||(null===(h=o)||void 0===h?void 0:null===(v=h.frontCustomerReq)||void 0===v?void 0:v.overallStore))(0,B.ae)((null==t?void 0:null===(b=t.frontCustomerReq)||void 0===b?void 0:b.overallStore)||(null===(_=o)||void 0===_?void 0:null===(j=_.frontCustomerReq)||void 0===j?void 0:j.overallStore));else{let{text2img:e="",img2img:t=""}=o||{},l=es(p,a.checkpointId);(0,W.$)({text2img:e,img2img:t,...i,baseType:p,taskQueuePriority:d,modelName:l})}(0,B.ae)({promptMagicInit:!1})}else{if(I.metainformation){let e=null==T?void 0:null===(a=T.frontCustomerReq)||void 0===a?void 0:a.overallStore;e?(0,y.setVideoGeneratorState)({...e}):(null==T?void 0:null===(o=T.frontCustomerReq)||void 0===o?void 0:o.tabType)&&(0,f.$)(T)}else I.contentId&&((0,f.H)(I.contentId),(0,y.setVideoGeneratorState)({drawSource:!0}));(0,y.setVideoGeneratorState)({promptMagicInit:!1})}},ev=()=>{var e,t,i,l;let a=window.location.pathname.includes("video-generator")?(0,y.getVideoGeneratorState)():(0,B.p4)(),o=(null==a?void 0:null===(e=a.generatorData)||void 0===e?void 0:e.prompt)||!!(null==a?void 0:null===(t=a.videoEffectList)||void 0===t?void 0:t.length)||!!(null==a?void 0:null===(i=a.additionalNetwork)||void 0===i?void 0:i.length)||!!(null==a?void 0:null===(l=a.imageStyleList)||void 0===l?void 0:l.length);return o},eg=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!X.current&&!e||$.current)return;let t=!e&&x.current.page>1;$.current=!0,t?A(!0):E(!0);let i=em(e);k.p1.getInspirationList(i).then(t=>{var i,l;J(void 0!==t.hasMore&&t.hasMore);let a=(null===(l=(0,Y.c)(t))||void 0===l?void 0:null===(i=l.data)||void 0===i?void 0:i.filter(e=>null==e?void 0:e.recurrentEnabled))||[];e||1===x.current.page?j(a):j(e=>[...e,...a]);let o=window.location.search.includes("isOfficialChannel");eo.current&&1===x.current.page&&o&&a.length>0&&(p(!0),ev()||setTimeout(()=>{ep(a[0],0)},500))}).catch(e=>{console.error("getInspirationList error",e)}).finally(()=>{E(!1),A(!1),$.current=!1})};(0,o.useEffect)(()=>{e&&(j([]),x.current.page=1,(0,eI.nw)({activeType:ee.current}),E(!0),setTimeout(()=>{eg(!0)},200))},[e]),(0,o.useEffect)(()=>{if(!e||!Z.current)return;let t=Z.current,i=()=>{let{scrollTop:e,scrollHeight:i,clientHeight:l}=t;i-e-l<100&&X.current&&!K.current&&!$.current?(x.current.page+=1,eg()):p(!1)};return t.addEventListener("scroll",i),()=>{t.removeEventListener("scroll",i)}},[e]);let eb=e=>{(0,eI.nw)({activeType:e}),"like"==e&&U(""),ec()},eT=e=>{k.i7.toggleLike({uuid:e.uuid,type:1}).then(e=>{0===e.code?F.ZP.success(null==e?void 0:e.msg):F.ZP.error(null==e?void 0:e.msg)})};return eE?null:(0,a.jsxs)("div",{className:"".concat(eU().inspirationLibrary," ").concat(e?eU().inspirationLibraryOpen:""," ").concat(h?eU().inspirationLibraryMobile:""," ").concat(ea?eU().inspirationDark:""),children:[!e&&(0,a.jsx)(ef.default,{title:"这里有海量的灵感视频和图片～",placement:"topRight",color:ea?"#fff":"#000",open:er,children:(0,a.jsxs)("div",{className:eU().entry,onClick:()=>{try{g({t:2,e:"lib.editor.inspiration.click"})}catch(e){console.error("灵感库打开埋点上报失败",e)}en(!1),e||setTimeout(()=>{p(!1)},100),(0,eI.nw)({inspirationLibraryOpen:!e})},children:[(0,a.jsx)(ek,{}),"灵感库"]})}),e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{onClick:()=>{(0,eI.nw)({inspirationLibraryOpen:!1,isShowCollected:!1}),u()},className:"fixed right-2 z-[201] w-7 h-7 flex justify-center items-center rounded-[8px] hover:bg-[#F0F0F0] dark:hover:bg-[#2C2C2D] dark:text-[#B0B0B0] text-[#787878] cursor-pointer ".concat(h?"top-[50px]":"top-[56px]"),children:(0,a.jsx)(e_.Z,{className:"w-[12px] h-[12px]"})}),(0,a.jsx)("div",{className:eU().inspirationBottomBg}),(0,a.jsxs)("div",{ref:Z,className:"".concat(eU().inspirationLibraryContent," dark:!bg-[#1c1c1c]"),children:[(0,a.jsxs)("div",{className:"pb-4 ".concat(h?"pt-2 !pb-2":"pt-[28px]"," sticky top-0 bg-white z-10 dark:!bg-[#1c1c1c]"),children:[(0,a.jsx)(eh.Z,{justify:"space-between",align:"flex-end",gap:12,children:t?(0,a.jsx)("div",{className:"text-[16px] font-[500] text-[#0D0D0D] dark:!text-[#F7F7F7] line-clamp-1 text-ellipsis w-full overflow-hidden flex-1",children:i}):(0,a.jsxs)("div",{className:"flex justify-between shrink-0 flex-wrap gap-2 flex-1 w-fit gap-3 items-end",children:[(0,a.jsx)("div",{style:{borderBottom:"1px solid #E5E5E5"},className:"flex-1 shrink-0 dark:!border-none",children:(0,a.jsx)(ew.Z,{tagList:eO,activeKey:l,onChange:e=>eb(e),className:"flex-1"})}),"like"!==l&&(0,a.jsx)("div",{className:"h-8",children:(0,a.jsx)(ey.Z,{onSearch:e=>eu(e),onClear:()=>eu(""),onChange:U,value:L,placeholder:"搜索视频/图片灵感",inputClass:{height:"32px",fontSize:"12px"}})})]})}),(L||"like"===l)&&(0,a.jsxs)("div",{className:"mt-4 flex gap-3 items-center justify-between",children:["like"===l&&(0,a.jsx)(eN.Z,{tagList:eP,activeKey:M,onChange:e=>{S(e),ec()},isShowAll:!1,className:"!w-fit"}),L&&(0,a.jsxs)("div",{className:"text-[12px] text-[#000] dark:!text-[#F7F7F7]",children:["搜索“",L,"”相关结果"]})]})]}),(0,a.jsxs)("div",{className:"".concat(eU().inspirationList," relative inspiration-library-scroll-container"),children:[P&&(0,a.jsx)("div",{className:"flex justify-center items-center absolute w-full h-[calc(100vh-130px)] top-0 left-0 z-[200]",children:(0,a.jsx)(m.Z,{size:h?30:50,textClass:"!text-white"})}),null==b?void 0:b.map((e,t)=>(0,a.jsx)(et,{data:e,onDrawSameModel:ep,onHandleLike:eT,index:t,isSelected:ei==e.uuid,isMobile:h},e.uuid)),(null==b?void 0:b.length)===0&&!P&&(0,a.jsx)("div",{className:"flex justify-center items-center absolute w-full h-[60vh] top-0 left-0 z-[200]",children:(0,a.jsx)(s.default,{description:"暂无数据",styles:{image:{filter:ea?"brightness(0.3)":"brightness(1)"}},className:"dark:!text-[#F7F7F7] text-[#000]"})}),z&&!P&&(0,a.jsxs)("div",{className:"w-full flex justify-center items-center py-4",style:{gridColumn:"1 / -1"},children:[(0,a.jsx)(ex.default,{size:"small"}),(0,a.jsx)("span",{className:"ml-2 text-[#666] text-[14px]",children:"加载中..."})]})]},l),!Q&&!P&&(null==b?void 0:b.length)>0&&(0,a.jsx)("div",{className:"h-4 -m-[260px] text-center text-[#666] text-[14px]",children:"暂无更多数据"})]})]})]})}var ez=i(22900),eA=i(56215),eZ=i(98673),eR=i(14359),eF=i(92122);let eG=u.tY();function eH(){let{top:e,bottom:t}=(0,C.B)(),{setShowFullGenerator:i,simpleGeneratorType:l,setSimpleGeneratorType:d,showFullGenerator:u}=(0,D.j)(),{clearInspirationCollectionInfo:p}=(0,eM.N)(),{isMobile:g}=(0,I.z9)(),[L,U]=(0,o.useState)([]),[O,P]=(0,o.useState)(!0),[E,z]=(0,o.useState)(!1),[R,F]=(0,o.useState)(!0),[G,H]=(0,o.useState)(!1),[B,Y]=(0,o.useState)(!0),q=(0,o.useRef)(null),[Q,J]=(0,o.useState)({current:1,pageSize:10,total:0}),[K,X]=(0,o.useState)(210),$=(0,o.useRef)(null),ee=(0,j.aV)("tasks"),et=(0,eF.Cl)("tasks"),ei=(0,eR.jZ)("tasks"),el=(0,eZ.qf)("tasks"),eo="dark"===(0,n.X)().colorScheme,er=(0,o.useRef)(!1),en=(0,o.useRef)(L),es=(0,o.useRef)(R),ed=(0,o.useRef)({current:1,pageSize:10,total:0}),ec=(0,M.useCurrentUser)(),eu=(0,N.T4)(),em=(0,o.useMemo)(()=>!!ec,[ec]),ep=(0,j.aV)("searchParams"),ev=(0,o.useRef)(!1),[eh,ex]=(0,o.useState)(!1),ef=(0,r.useRouter)(),eb=ef.pathname.includes("/image-generator"),ej=(0,eI.P4)("inspirationLibraryOpen"),[e_,ey]=(0,o.useState)(!1),eN=ef.pathname.includes("/digital-human"),ew=ef.pathname.includes("/action-follow"),eT=(ef.pathname.includes("/video-generator"),(0,_.J7)("videoInputConfig")),ek=(0,_.J7)("imageInputConfig"),eD=()=>eb?V.oZ.IMAGE:eN?V.oZ.DIGITAL_HUMAN:ew?V.oZ.ACTION_FOLLOW:V.oZ.VIDEO,eL=(e,t,i,l)=>{var a,o;return(null==e?void 0:e.concat(t||[]).concat(i||[]).concat(l||[]).sort((e,t)=>(null!==(a=e.generateId)&&void 0!==a?a:1/0)-(null!==(o=t.generateId)&&void 0!==o?o:1/0)))||[]},eU=(0,o.useMemo)(()=>{let e=eL(ee,et,ei,el);return e||[]},[ee,et,ei,el]),eO=e=>{let t=new Map;return e.forEach(e=>{var i;let l=null===(i=e.generateId)||void 0===i?void 0:i.toString().trim();l&&t.set(l,e)}),Array.from(t.values())};(0,o.useEffect)(()=>{let e=(0,j.hC)().unReadTasks||[],t=eO([...e,...eU]);(0,j.qb)({unReadTasks:t})},[eU]);let eP=()=>{i(!0),setTimeout(()=>{window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"})},100)};(0,o.useEffect)(()=>{en.current=L||[]},[L]),(0,o.useEffect)(()=>{ed.current=Q},[Q]),(0,o.useEffect)(()=>{es.current=R},[R]),(0,o.useEffect)(()=>{if(!$.current)return;let e=new ResizeObserver(e=>{for(let t of e){let e=t.contentRect.height;X(e)}});return e.observe($.current),()=>{e.disconnect()}},[$.current]);let eE=(0,o.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(er.current)return;z(!0),er.current=!0;let i={pageNo:e?ed.current.current+1:1,pageSize:Q.pageSize,fromTime:(0,S.oi)(ez.Pq),toTime:(0,S.oi)(),bizType:22,source:0,generateTypes:[],generateType:0};if(ev.current){let e=(0,j.hC)("searchParams");i.generateType=(null==e?void 0:e.generateType)||0,i.fromTime=(0,S.oi)((null==e?void 0:e.fromTime)||"2025-05-01 00:00:00"),i.toTime=(0,S.oi)((null==e?void 0:e.toTime)||c()().endOf("day"))}k.p1.getEditorList(i).then(t=>{var i,l;if(!t)return;let a=(null==t?void 0:null===(l=t.list)||void 0===l?void 0:null===(i=l.reverse())||void 0===i?void 0:i.filter(e=>{var t,i;return(null==e?void 0:null===(t=e.images)||void 0===t?void 0:t.length)>0||(null==e?void 0:null===(i=e.videos)||void 0===i?void 0:i.length)>0}))||[];if(0===a.length){F(!1),ev.current&&!e&&U([...a]);return}if(e){let e=document.documentElement.scrollHeight;U(e=>[...a,...e]),J(e=>({...e,current:e.current+1,total:t.total||0})),setTimeout(()=>{let t=document.documentElement.scrollHeight;window.scrollTo({top:t-e+window.scrollY,behavior:"auto"})},0)}else U([...a]),J(e=>({...e,current:1,total:t.total||0}))}).finally(()=>{P(!1),z(!1),er.current=!1,ex(!1),t&&eP()})},[Q,E]),eH=(0,o.useCallback)(()=>{ev.current=!0,ex(!0),setTimeout(()=>{eE(!1,!0)},100)},[eE]),eW=async()=>{var e,t;(0,eI.nw)({inspirationLibraryOpen:!1});let l=new URLSearchParams(window.location.search),a=l.get("isOfficialChannel"),o=l.get("collectionId");if(!o){(0,eI.nw)({isShowCollected:!1});return}let r={isShowCollected:!0,inspirationLibraryOpen:!0,collectionId:o||""};if(a&&o){let t={};try{t=await k.p1.getCollectionName({collectionId:o})}catch(e){console.error("获取合集名称失败",e)}(0,eI.nw)({...r,collectionName:(null===(e=t)||void 0===e?void 0:e.name)||"灵感合集"}),setTimeout(()=>{i(!1)},100)}let n=localStorage.getItem("inspirationCollectedInfo");if(n){let e=(0,S.KV)(n,{});(0,eI.nw)({...r,collectionName:(null===(t=(0,S.KV)(e.extendInfo,{}))||void 0===t?void 0:t.collectionName)||""}),setTimeout(()=>{i(!1)},100)}};(0,o.useEffect)(()=>{let e=localStorage.getItem("drawVideoParamsAiTool"),t=localStorage.getItem("drawVideoParamsWebui");if(t&&((0,f.$)({...JSON.parse(t)}),(0,y.setVideoGeneratorState)({drawSource:!0,promptMagicInit:!1})),e){let t=JSON.parse(e);80===t.generateType?(delete t.generateType,(0,eC.Qj)({...t,promptMagicInit:!1})):81===t.generateType?(delete t.generateType,(0,eS.Mb)({...t,promptMagicInit:!1})):(delete t.generateType,(0,y.setVideoGeneratorState)({...t,drawSource:!0,promptMagicInit:!1}))}eW();let i=(0,j.hC)("searchParams");("lastThreeMonths"!==i.timeRange||0!==i.generateType)&&(0,j.qb)({searchParams:{...i,timeRange:"lastThreeMonths",generateType:0}})},[]);let eB=(0,o.useCallback)(()=>{var e,t,i;if(ej)return;let l=window.scrollY<=100&&(null===(e=en.current)||void 0===e?void 0:e.length)<(null===(t=ed.current)||void 0===t?void 0:t.total)&&(null===(i=en.current)||void 0===i?void 0:i.length)>0&&es.current;l&&!q.current&&(eE(!0),q.current=setTimeout(()=>{q.current=null},300))},[eE,g,ej]),eY=(0,o.useCallback)(()=>{k.p1.getGenerateList().then(e=>{var t,i;if((null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.length)>0){let t=[],l=[],a=[],o=[];null===(i=e.data)||void 0===i||i.forEach((e,i)=>{22===e.bizType&&e.subStatus<2&&(0===e.taskMode?81===e.subType?o.push(e):t.push(e):1===e.taskMode&&(80===e.subType?a.push(e):81===e.subType?o.push(e):l.push(e)))}),t.length>0&&(0,j.qb)({tasks:t.map(e=>({...e,mediaType:V.MR}))}),l.length>0&&(0,eF.WF)({tasks:l.map(e=>({...e,mediaType:V.iC}))}),a.length>0&&(0,eR.$p)({tasks:a.map(e=>({...e,mediaType:V.nY}))}),o.length>0&&(0,eZ.KP)({tasks:o.map(e=>({...e,mediaType:V.Aw}))})}}).catch(e=>{console.error("Failed to fetch ongoing tasks:",e)})},[]);(0,o.useEffect)(()=>{eu({e:eb?"lib.image.editor.show":"lib.video.editor.show",t:2}),i(!0);let e=new URLSearchParams(window.location.search),t=e.get("fillimgid");return t&&(0,W.H)(t),em?(P(!0),eE(),eY(),window.addEventListener("scroll",eB)):P(!1),()=>{window.removeEventListener("scroll",eB),q.current&&clearTimeout(q.current)}},[]),(0,o.useEffect)(()=>{let e,t=0,l=()=>{ej||(clearTimeout(e),e=setTimeout(()=>{let e=window.scrollY,l=document.documentElement.scrollHeight,a=document.documentElement.clientHeight;Math.ceil(e+a)>=l?(i(!0),H(!1),ey(!1)):e<t&&e>100&&(H(!0),e<t&&t-e>(g?100:30)&&(i(!1),H(!0))),t=e<=0?0:e},100))};return window.addEventListener("scroll",l),()=>window.removeEventListener("scroll",l)},[ej]);let{generatorParams:eq,clearGeneratorParams:eQ}=(0,w.DO)(),eJ=(null==L?void 0:L.length)<(null==Q?void 0:Q.total);(0,o.useEffect)(()=>(ej?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[ej]);let eK=()=>{eQ(),(0,eI.nw)({inspirationLibraryOpen:!1}),p()},eX=()=>{let e=(0,j.hC)("searchParams").generateType,t=(0,j.hC)("tasks"),i=(0,eF.FU)("tasks"),l=eL(t,i),a=(0,V.jm)(l,e);a?ey(!0):((0,j.qb)({unReadTasks:[]}),ey(!1))},e$=()=>{let e=localStorage.getItem("notShowInspirationTip");e||(T.Y.emit("showInspirationTip",!0),localStorage.setItem("notShowInspirationTip","true"))},e0=()=>{let e=window.scrollY,t=document.documentElement.scrollHeight,i=document.documentElement.clientHeight;Math.ceil(e+i+600)>=t&&eP()},e1=()=>{eK(),eX(),e$(),e0()};(0,o.useEffect)(()=>(d(eD()),T.Y.on("submitEditorTask",e1),()=>{T.Y.off("submitEditorTask",e1)}),[]);let e2=(0,o.useMemo)(()=>!!(l===V.oZ.IMAGE&&ek.disablePromptInput||l===V.oZ.VIDEO&&eT.disablePromptInput),[eT.disablePromptInput,l,ek.disablePromptInput]);if(O)return(0,a.jsx)("div",{className:"flex justify-center items-center h-screen bg-[var(--editor-page-bg)]",children:(0,a.jsx)(m.Z,{size:g?30:50})});let e3={[V.oZ.IMAGE]:"图片创作",[V.oZ.VIDEO]:"视频创作",[V.oZ.DIGITAL_HUMAN]:"数字人创作",[V.oZ.ACTION_FOLLOW]:"动作模仿"};return 0===L.length&&0===eU.length&&!ev.current||(null==eq?void 0:eq.checkpointId)?(0,a.jsxs)("div",{className:"flex flex-col bg-[var(--editor-page-bg)] h-full flex-1",children:[(0,a.jsxs)("div",{className:"flex flex-col flex-1 items-center justify-center px-4 b768:px-0 ".concat(ej?"justify-between pb-5":"justify-center"),children:[(0,a.jsx)("h1",{className:"text-center b768:pb-3 pb-[28px] text-[36px] text-[#191919] dark:text-[#fff] font-[500]",children:e3[l]}),(0,a.jsxs)("h2",{className:"text-center text-[var(--color-select-text)] h-8 mb-[50px] w-full flex items-center justify-center flex-wrap",children:[(0,a.jsx)("img",{src:eo?h():v(),alt:"支持的模型",className:"h-8"}),(0,a.jsx)("span",{className:"ml-2 text-[20px] bg-[linear-gradient(90deg,#1E1E20_50%,#217EFD_100%)] dark:bg-[linear-gradient(90deg,#ffffff_50%,#6BB1FF_100%)] bg-clip-text text-transparent",children:"百变风格 超多模型供你选择"})]}),(0,a.jsx)("div",{className:"w-full ".concat(ej?"pb-5 relative z-[202]":""),children:(0,a.jsx)(b.Z,{entryValue:l})})]}),(0,a.jsxs)("div",{className:"".concat(l===V.oZ.DIGITAL_HUMAN||l===V.oZ.ACTION_FOLLOW?"opacity-0":""," relative"),children:[ej?(0,a.jsx)(eV,{}):(0,a.jsx)(ea,{isExpanded:B,onExpandedChange:Y}),l===V.oZ.DIGITAL_HUMAN&&(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-full "})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{}),(0,a.jsx)(Z.Z,{dataList:L,setHistoryList:U,selectType:1,isTeam:!1,source:"history"}),(0,a.jsx)("div",{id:"watermarkcontainer",className:"hidden"}),(0,a.jsxs)("div",{className:"px-4 relative flex flex-col items-center justify-between",style:{paddingBottom:"".concat(K,"px")},children:[eJ&&E&&L.length>0&&(0,a.jsx)("div",{className:"flex justify-center py-4",children:(0,a.jsx)("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})}),(0,a.jsx)(eA.Z,{data:L,getHistoryList:eE,setHistoryList:U,tasks:eU,curGenerateType:null==ep?void 0:ep.generateType}),!L.length&&!R&&!eU.length&&(0,a.jsx)("div",{className:"flex flex-col items-center justify-center h-[70vh]",children:(0,a.jsx)(s.default,{description:"暂无生成作品",styles:{image:{filter:eo?"brightness(0.3)":"brightness(1)",marginBottom:10}}})})]}),(0,a.jsx)("div",{ref:$,className:"px-4 b768:px-0 fixed bottom-0 pb-5 left-[calc(50%+var(--mantine-navbar-width,0px)/2)] transition-width duration-300 transform -translate-x-1/2 z-[50] ".concat(g?"w-full":""," ").concat(ej?"!z-[202]":""),children:(0,a.jsxs)("div",{className:"relative w-full b1024:w-[880px]  b1920:w-[920px] flex justify-center mx-auto",children:[(G||e_)&&!ej&&(0,a.jsx)(A,{scrollToBottom:eP,tasks:eU,classNames:"".concat(e2&&!g?"!right-[85px]":""," ").concat(u&&e2?"!top-[-48px]":""," ").concat(u?"top-[-12px]":"!top-[-48px]")}),(0,a.jsx)(b.Z,{entryValue:l})]})}),l!==V.oZ.DIGITAL_HUMAN&&l!==V.oZ.ACTION_FOLLOW&&(0,a.jsx)(eV,{}),eh&&(0,a.jsx)("div",{className:"flex justify-center items-center fixed w-screen h-screen top-0 left-0 bg-black/40 z-[202]",children:(0,a.jsx)(m.Z,{size:g?30:50,textClass:"!text-white"})}),!eG&&(0,a.jsx)("div",{className:"fixed right-4 z-[11] pt-4 ".concat(g?"top-[calc(var(--top-header-height))]":"top-[calc(var(--mantine-header-height)+var(--top-header-height))]"," "),children:(0,a.jsx)(eg,{onSearch:eH})})]})}},56215:function(e,t,i){"use strict";i.d(t,{Z:function(){return tp}});var l,a,o,r,n,s,d,c,u,m,p,v,g,h=i(52322),x=i(2784),f=i(7731),b=i(50603),j=i(47933),_=i(53625),y=i(56697),N=i(62443),w=i(11187);function I(){return(I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}var T=function(e){return x.createElement("svg",I({xmlns:"http://www.w3.org/2000/svg",width:2,height:10,fill:"none"},e),l||(l=x.createElement("path",{fill:"currentColor",d:"M1 8.209a.875.875 0 1 1 0 1.75.875.875 0 0 1 0-1.75m0-4.083a.875.875 0 1 1 0 1.75.875.875 0 0 1 0-1.75M1 .043a.875.875 0 1 1 0 1.75.875.875 0 0 1 0-1.75"})))};function k(){return(k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}var M=function(e){return x.createElement("svg",k({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none"},e),a||(a=x.createElement("path",{fill:"currentColor",d:"M12.834 12.775H7v-1.05h5.834zM9.533 1.633a1.167 1.167 0 0 1 1.65 0l.825.824a1.167 1.167 0 0 1 0 1.65l-8.08 8.08-.069.06a.6.6 0 0 1-.249.104l-2.373.387-.036.004a.293.293 0 0 1-.303-.303l.004-.036.389-2.373a.6.6 0 0 1 .103-.249l.06-.07zm-7.23 8.715-.194 1.183 1.184-.193 6.364-6.364-.99-.99zm8.138-7.973a.117.117 0 0 0-.165 0l-.866.866.99.99.865-.866a.117.117 0 0 0 0-.165z"})))};function D(){return(D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}var S=function(e){return x.createElement("svg",D({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none"},e),o||(o=x.createElement("path",{fill:"currentColor",d:"M12.192 7.582a2.86 2.86 0 0 1-2.859 2.86H4.185l.853.852-.743.743-1.667-1.668a.64.64 0 0 1 0-.907l1.667-1.668.743.743-.853.854h5.148c.999 0 1.809-.81 1.809-1.809v-.583h1.05zm-.82-3.953c.25.25.25.657 0 .907L9.705 6.204l-.743-.743.853-.854H4.667c-.999 0-1.809.81-1.809 1.809v.583h-1.05v-.583a2.86 2.86 0 0 1 2.859-2.858h5.148l-.853-.854.743-.743z"})))},C=i(5394),L=i(23363),U=i(3554),O=i(57842),P=i(80606),E=i(53629),V=i(56798),z=i(36429),A=i.n(z),Z=i(94055),R=i(99665),F=i(82240),G=i(61947);function H(){return(H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}var W=function(e){return x.createElement("svg",H({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none"},e),r||(r=x.createElement("path",{fill:"#fff",d:"M1.6 12.402h10.8v-1.4h1.2v2.601H.4v-2.6h1.2zm11.73-8.584a.733.733 0 0 1 0 1.036l-3.239 3.24-.848-.849 2.308-2.308h-4.55A5.4 5.4 0 0 0 1.6 10.336H.4a6.6 6.6 0 0 1 6.6-6.6h4.551L9.243 1.428l.848-.85z"})))},B=i(55208),Y=i(91595),q=i(82170),Q=i(39533),J=i(65858),K=i(34467),X=i(63880);let $=e=>{let{isGenerating:t}=e,{tipInfo:i,memberPackage:l}=(0,K.D)(),a=()=>{l&&(0,X.jU)({openSku:l.id,billingReferer:66})};if(i)return t?(0,h.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,h.jsx)("div",{className:"text-[12px] leading-[14px] underline text-[#FFDDA5] cursor-pointer font-bold",onClick:a,children:i.title}),(0,h.jsx)("div",{className:"text-[11px] leading-[13px] text-[white]",children:i.subtitle})]}):(0,h.jsxs)("div",{className:"border-[1px] flex gap-1 border-[#F4EBCD] rounded-[8px] bg-gradient-to-r from-[#F9F0DE] to-[#FCFAF4] px-[12px] py-[6px] text-[#A75A0A] leading-[16px] text-[11px] b768:text-[13px] cursor-pointer",onClick:a,children:[i.btnText," ",(0,h.jsx)("img",{src:"https://liblibai-online.liblib.cloud/web/c57118c862594c8da3377daa4a32e9cc/8c561697-797b-4165-8720-a2080584c67b.svg",alt:""})]})};var ee=i(31271);let et=e=>!!e&&e.includes("_lib_upscaled");var ei=e=>{let{list:t,genData:i,isLastTask:l,handleReEdit:a}=e,[o,r]=(0,x.useState)([]),[n,s]=(0,x.useState)(!1),[d,c]=(0,x.useState)(""),u=(0,x.useRef)({}),{isMobile:m}=(0,L.z9)(),[p,v]=(0,x.useState)({visible:!1,x:0,y:0,item:null});(0,x.useEffect)(()=>{r(t)},[t]);let g=(0,x.useMemo)(()=>{if(!(null==i?void 0:i.taskParam))return null;try{let e=JSON.parse(null==i?void 0:i.taskParam);return e}catch(e){return null}},[null==i?void 0:i.genData]),f=e=>"".concat(e,"?image_process=format,webp&x-oss-process=image/resize,w_",640,",m_lfit/format,webp"),b=e=>{if(!e)return!1;let t=(e=>{try{let t=e.replace(/\/+$/,""),i=t.split(/[#?]/)[0],l=i.match(/\.([a-z0-9]+)$/i);return l?l[1].toLowerCase():""}catch(e){return""}})(e);return!!["jpg","jpeg","png","gif","webp","bmp","svg"].includes(t)||(["mp4","mov","avi","mkv","webm","m4v","flv","wmv"].includes(t),!1)},j=(0,x.useCallback)((e,t)=>{m||(0,B.qb)({editorDetailData:{...e,paramsData:g},editorDetailModalOpen:!0,editorDetailFrom:"history",editorIndex:t,editorId:i.id})},[m,n,d]),_=async e=>{let t=await U.p1.detectMedia({sourceHttpUrl:e});return t},y=async e=>{if(et(e.originalVideoUrl)){let t=(null==e?void 0:e.taskParam)?JSON.parse(null==e?void 0:e.taskParam):{},i=(null==t?void 0:t.geniusPayload)?JSON.parse(null==t?void 0:t.geniusPayload):{},l=null==i?void 0:i.api_version,a=null==i?void 0:i.target_resolution;"normal"===l?c("已完成视频高清处理（极速，".concat(a,"）")):c("已完成视频高清处理（专业，".concat(a,"）")),s(!0)}else{let t=await _(e.originalVideoUrl);if(null==t?void 0:t.data){let{duration:e,size:i}=t.data;if(i&&i>104857600){c("暂仅支持100MB以内的视频"),s(!0);return}if(e&&e>600){c("暂不支持10分钟以上的视频"),s(!0);return}s(!1),c("")}}if(!b(null==e?void 0:e.videoUrl)){let t=u.current[e.id];t&&t.play().catch(e=>{console.warn("视频自动播放失败:",e)})}},w=e=>{if(s(!1),c(""),!b(null==e?void 0:e.videoUrl)){let t=u.current[e.id];t&&(t.pause(),t.currentTime=0)}},I=(e,t)=>{e.preventDefault(),e.stopPropagation(),v({visible:!0,x:e.clientX,y:e.clientY,item:t})},T=()=>{v({visible:!1,x:0,y:0,item:null})},k=async()=>{if(p.item){var e,t;D({e:"lib.digitalhuman.editor.download",t:2,var:{image_uuid:p.item.id,generate_id:p.item.generateId}});let{downloadUrl:i}=await (0,J.aj)({fileUrl:null===(e=p.item)||void 0===e?void 0:e.videoUrl,mediaType:2});(0,q.ZP)(i,null===(t=p.item)||void 0===t?void 0:t.originalName)}T()},M=async e=>{D({e:"lib.digitalhuman.editor.share",t:2,var:{image_uuid:e.id,generate_id:e.generateId}});try{let t=(0,Y.UV)("showShareVideoModal");t([{createTime:e.createTime,generateId:e.generateId,height:e.height,id:e.id,imageUrl:e.coverPathUrl||"",ossId:e.originalVideoUrl,width:e.width,imageId:"",originalImageUrl:e.coverPathUrl,originalVideoUrl:e.originalVideoUrl}],void 0,void 0,"video")}catch(e){console.error("分享视频失败",e)}},D=(0,C.T4)(),S=(e,t)=>(0,h.jsxs)("div",{className:"w-[248px] cursor-pointer",onClick:()=>{n||(D({e:"lib.video.editor.hd_panel.click",t:2,var:{}}),(0,B.qb)({isVideoEdit:!0}),j(e,t))},children:[(0,h.jsx)("div",{className:"w-[248px] h-[100px] rounded-lg overflow-hidden",children:(0,h.jsx)("img",{src:"https://liblibai-online.liblib.cloud/web/ef0097ae9da74189a0f5d604e98c77cd/86890f94-1b6d-447a-b7c1-11e192b519bd.gif",className:"w-full h-full object-cover"})}),(0,h.jsx)("div",{className:"text-[12px] font-medium text-[#0D0D0D] leading-[16px] pt-[16px]",children:"视频高清"}),(0,h.jsx)("p",{className:"text-[12px] text-[#4A535F] leading-[18px] py-[8px]",children:"智能提升视频分辨率,完美保留视频艺术效果,精美还原视频细节。"}),(0,h.jsx)("button",{className:A().actionButton,children:"立即体验"})]});return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("ul",{className:A().videoImgRow,children:null==o?void 0:o.slice(Math.max(o.length-1,0)).map((e,t)=>(0,h.jsxs)("li",{className:"group ".concat(A().videoImageCard),onContextMenu:e=>{e.preventDefault(),e.stopPropagation()},children:[b(null==e?void 0:e.videoUrl)?(0,h.jsx)("img",{src:f(null==e?void 0:e.videoUrl),className:A().imageContent,alt:"违规内容已被过滤"}):(0,h.jsxs)("div",{className:"".concat(A().tagWrapper),onMouseEnter:()=>y(e),onMouseLeave:()=>w(e),children:[(0,h.jsx)("img",{src:f(null==e?void 0:e.coverPathUrl),onClick:()=>{j(e,t)},onContextMenu:t=>I(t,e)}),(0,h.jsx)("video",{preload:"metadata",disablePictureInPicture:!0,ref:t=>{t&&(0,Q.Kz)(t),u.current[e.id]=t},src:null==e?void 0:e.videoUrl,poster:f(null==e?void 0:e.videoUrl),className:A().videoContent,controls:!0,loop:!0,muted:!0,controlsList:"nodownload noremoteplayback",onClick:()=>{j(e,t)},onContextMenu:t=>I(t,e),...(0,Q.SW)()}),(0,h.jsx)("div",{className:A().hoverCover,children:(0,h.jsx)("div",{className:"flex absolute left-[0px] top-[0px] justify-end gap-[0px] w-full h-[72px] rounded-t-lg px-[8px] py-[8px]",style:{background:"linear-gradient(0deg, rgba(0, 0, 0, 0.00) 7.39%, rgba(0, 0, 0, 0.80) 100%)"},children:(0,h.jsxs)("div",{className:A().iconWrapper,children:[(0,h.jsx)("button",{className:A().actionImage,onClick:()=>a(),children:(0,h.jsx)(R.Z,{})}),n?(0,h.jsx)(Z.default,{title:d,children:(0,h.jsx)("button",{disabled:n,className:"".concat(A().actionImage," ").concat(n?"opacity-50 cursor-not-allowed":""),children:(0,h.jsx)(G.Z,{})})}):(0,h.jsx)(N.default,{placement:"bottom",content:S(e,t),arrow:!1,zIndex:200,onOpenChange:e=>{e&&D({e:"lib.video.editor.hd_panel.show",t:2,var:{}})},children:(0,h.jsx)("button",{onClick:()=>{n||((0,B.qb)({isVideoEdit:!0}),j(e,t))},className:"".concat(A().actionImage," ").concat(n?"opacity-50 cursor-not-allowed":""),children:(0,h.jsx)(G.Z,{})})}),(0,h.jsx)(ee.o,{fileUrl:null==e?void 0:e.videoUrl,originalImageUrl:null==e?void 0:e.originalVideoUrl,mediaType:2,fileName:"video.mp4",reportData:{event:"lib.video.editor.download",type:2,vars:{video_uuid:e.id,generate_id:e.generateId},onReport:D},className:A().actionImage,iconSize:16}),(0,h.jsx)("div",{className:A().actionImage,onClick:()=>M(e),children:(0,h.jsx)(W,{})})]})})})]}),!m&&0==t&&l&&(0,h.jsx)("div",{className:"pt-3 text-right absolute right-0",children:(0,h.jsx)($,{isGenerating:!1})})]},e.id))}),(0,h.jsx)(F.Z,{visible:p.visible,x:p.x,y:p.y,onClose:T,onDownload:k,onShare:()=>{p.item&&M(p.item),T()},downloadText:"下载视频",shareText:"分享视频"})]})},el=i(30276),ea=i(35887),eo=e=>{let{generatorData:t}=e;if(!t)return null;let i=1===t.modelType?"标准模式":"专业模式",l="wan2.2-animate-move"===t.model?"参考动作":"角色场景融合",a=t.duration;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{className:A().size,children:i}),(0,h.jsx)("span",{className:A().size,children:l}),a&&(0,h.jsxs)("span",{className:A().size,children:[Math.floor(a),"s"]})]})},er=i(65829),en=e=>{let{modelImages:t,onImageClick:i,imageClassName:l}=e,{setShowFullGenerator:a}=(0,O.j)(),o=e=>{i&&(null==i||i(e),a(!0))},r=e=>{let t=null==e?void 0:e.videoUrl;return t?(0,ea.VP)(t):(0,er.sz)(e.url||e.imageUrl,120)},n=e=>{let t=!!(null==e?void 0:e.videoUrl);return(null==e?void 0:e.label)?e.label:t?"参考视频":"参考图"};return(0,h.jsx)("div",{className:"group/images relative flex cursor-pointer flex-shrink-0",children:t.map((e,i)=>(0,h.jsx)(Z.default,{placement:"top",title:n(e),children:(0,h.jsx)("div",{className:"relative transition-all duration-300 ease-out group-hover/images:ml-0 ".concat(0===i?"":"-ml-5"," ").concat(i>0?"group-hover/images:ml-1":""),style:{zIndex:t.length-i},children:(0,h.jsx)("img",{src:r(e),className:"w-10 h-10 rounded-lg object-cover shadow-md hover:shadow-lg hover:scale-110 transition-all duration-200 ".concat(l),alt:n(e),onClick:()=>o(e)})})},i))})};let es=e=>{var t;let{generatorData:i,videoItem:l}=e;return i?(0,h.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,h.jsxs)("div",{className:"text-sm text-[#217EFD] flex gap-1 font-bold",children:[(0,h.jsx)(el.Z,{}),"动作模仿"]}),(0,h.jsxs)("div",{className:"flex items-end gap-3",children:[i.images.length>0&&(0,h.jsx)(en,{imageClassName:"w-[36px] h-[48px]",modelImages:[{url:i.images[0],label:"角色"}]}),(null==i?void 0:null===(t=i.videos)||void 0===t?void 0:t.length)>0&&(0,h.jsx)(en,{imageClassName:"w-[36px] h-[48px]",modelImages:[{url:(0,ea.VP)(i.videos[0]),label:"动作"}]})]}),(0,h.jsx)("div",{className:"flex-1 relative",children:(0,h.jsx)("div",{className:"flex gap-2 overflow-x-auto flex-1 min-w-0 hide-scrollbar",children:(0,h.jsx)(eo,{generatorData:i})})})]}):null},{confirm:ed}=y.default;var ec=e=>{var t;let{videoItem:i,index:l,data:a,deleteImage:o}=e,r=(null==i?void 0:i.taskParam)?JSON.parse(null==i?void 0:i.taskParam):{},{isMobile:n}=(0,L.z9)(),s=null==r?void 0:null===(t=r.frontCustomerReq)||void 0===t?void 0:t.overallStore,d=(0,C.T4)(),{setShowFullGenerator:c,setSimpleGeneratorType:u}=(0,O.j)();try{s&&[].push({url:s.referenceList[0].url,label:"参考图"})}catch(e){console.warn("解析任务参数失败:",e)}let{generatorData:m}=s;return(0,h.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,h.jsx)(es,{generatorData:m,videoItem:i}),(0,h.jsx)(ei,{list:null==i?void 0:i.videos,genData:i,id:i.id,isLastTask:l===a.length-1,historyList:a,handleReEdit:()=>{let{frontCustomerReq:e}=r,{overallStore:t}=e,{generatorData:l}=t;c(!0),u(f.oZ.DIGITAL_HUMAN),i.videos&&(0,V.Qj)({referenceList:i.videos}),d({e:"lib.actionfollow.editor.reconfig",t:2,var:{generate_id:i.id,prompt:l.prompt,ckp_model_name:l.modelName,ckp_model_uuid:l.checkpointId,video_size:l.ratio,duration:l.duration,resolution:l.resolution,sd_priority:1===l.taskQueuePriority?"low":"high",sd_param:JSON.stringify(l)}})}}),(0,h.jsxs)("div",{className:A().action,children:[!n&&(0,h.jsxs)("span",{className:"".concat(A().actionSpan),onClick:()=>{let{frontCustomerReq:e}=r,{overallStore:t}=e,{generatorData:l}=t;if(c(!0),u(f.oZ.ACTION_FOLLOW),e){let{overallStore:t}=e;(0,E.Mb)({...t})}d({e:"lib.actionfollow.editor.reconfig",t:2,var:{generate_id:i.id,prompt:l.prompt,ckp_model_name:l.modelName,ckp_model_uuid:l.checkpointId,video_size:l.ratio,duration:l.duration,resolution:l.resolution,sd_priority:1===l.taskQueuePriority?"low":"high",sd_param:JSON.stringify(l)}})},children:[(0,h.jsx)(M,{}),(0,h.jsx)("span",{children:"重新编辑"})]}),(0,h.jsxs)("span",{className:"".concat(A().actionSpan),onClick:()=>{(0,P.YR)(r);let{frontCustomerReq:e}=r,{overallStore:t}=e,{generatorData:l}=t;d({e:"lib.actionfollow.editor.regen",t:2,var:{generate_id:i.id,prompt:l.prompt,ckp_model_name:l.modelName,ckp_model_uuid:l.checkpointId,video_size:l.ratio,duration:l.duration,resolution:l.resolution,sd_priority:1===l.taskQueuePriority?"low":"high",sd_param:JSON.stringify(l)}})},children:[(0,h.jsx)(S,{}),(0,h.jsx)("span",{children:"再次生成"})]}),(0,h.jsx)(N.default,{arrow:!1,placement:"right",classNames:{body:"!p-1 !rounded-[8px]"},content:(0,h.jsxs)("span",{className:"".concat(A().deleteAction),onClick:()=>{ed({title:"确定删除吗？",content:"删除后无法恢复",okText:"确定",cancelText:"取消",centered:!0,autoFocusButton:null,onOk(){var e;let t=null==i?void 0:null===(e=i.videos)||void 0===e?void 0:e[0];d({e:"lib.actionfollow.editor.delete",t:2,var:{image_uuid:t.id,generate_id:t.generateId}}),U.p1.deleteTask({generateId:i.id}).then(e=>{(null==e?void 0:e.code)===0?(o(i.id),w.ZP.success("删除成功")):w.ZP.warning("删除失败！")})}})},children:[(0,h.jsx)(_.J,{className:"".concat(A().actionTxt," icon-lib3-del"),fontSize:14}),(0,h.jsx)("span",{children:"删除该条记录"})]}),trigger:"click",children:(0,h.jsx)("span",{className:"".concat(A().actionSpan," b768:w-[32px] w-[28px]"),children:(0,h.jsx)(T,{})})})]})]},"".concat(i.id))},eu=i(27134);function em(){return(em=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}var ep=function(e){return x.createElement("svg",em({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),n||(n=x.createElement("path",{fill:"#666",fillRule:"evenodd",d:"m9.962 12.39-1.136-.296V6.673l1.216-.308c.667-.17 1.227-.308 1.254-.302.02 0 .037 1.49.037 3.314v3.316l-.117-.006c-.07 0-.635-.137-1.254-.296M4.666 11.027c0-1.824.016-3.32.043-3.32.021-.005.581.134 1.253.303l1.21.307-.01 2.7-.016 2.7-1.088.28c-.597.154-1.157.297-1.237.313l-.155.038zM12.826 8.318c0-6.02.005-6.343.096-6.317.048.016.523.138 1.05.271.529.138 1.052.27 1.164.297l.197.053-.01 5.707-.017 5.712-1.082.276c-.592.153-1.152.291-1.238.313l-.16.037zM.666 8.338c0-3.119.016-5.67.043-5.67.021 0 .581.138 1.248.303l1.216.307v5.055c0 2.773-.011 5.049-.022 5.049-.016 0-.581.143-1.253.313l-1.232.312z",clipRule:"evenodd"})))},ev=i(98574),eg=i(62285);function eh(){return(eh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}var ex=function(e){return x.createElement("svg",eh({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),s||(s=x.createElement("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.2,d:"M7.966 8a3.333 3.333 0 1 0 0-6.667 3.333 3.333 0 0 0 0 6.667M2.24 14.667C2.24 12.087 4.806 10 7.966 10"})),d||(d=x.createElement("path",{fill:"#fff",d:"M8.8 12.799a.6.6 0 1 1 1.2 0v1.8a.6.6 0 1 1-1.2 0zM11.1 10.466a.6.6 0 0 1 1.2 0V14.7a.6.6 0 1 1-1.2 0zM13.43 12.133a.6.6 0 0 1 1.2 0V14.6a.6.6 0 1 1-1.2 0z"})))},ef=i(36728);let eb=e=>!!e&&e.includes("_lib_upscaled");var ej=e=>{let{list:t,updateList:i,id:l,genData:a,historyList:o,isLastTask:r,handleReEdit:n}=e,[s,d]=(0,x.useState)([]),[c,u]=(0,x.useState)(!1),[m,p]=(0,x.useState)(""),[v,g]=(0,x.useState)(!1),f=(0,x.useRef)({}),{isMobile:b}=(0,L.z9)(),{handleDownload:j}=(0,ef.Ag)({isTeam:!1}),[y,w]=(0,x.useState)({visible:!1,x:0,y:0,item:null});(0,x.useEffect)(()=>{d(t)},[t]);let I=(0,x.useMemo)(()=>{if(!(null==a?void 0:a.taskParam))return null;try{let e=JSON.parse(null==a?void 0:a.taskParam);return e}catch(e){return null}},[null==a?void 0:a.genData]),T=e=>"".concat(e,"?image_process=format,webp&x-oss-process=image/resize,w_",640,",m_lfit/format,webp"),k=e=>{if(!e)return!1;let t=(e=>{try{let t=e.replace(/\/+$/,""),i=t.split(/[#?]/)[0],l=i.match(/\.([a-z0-9]+)$/i);return l?l[1].toLowerCase():""}catch(e){return""}})(e);return!!["jpg","jpeg","png","gif","webp","bmp","svg"].includes(t)||(["mp4","mov","avi","mkv","webm","m4v","flv","wmv"].includes(t),!1)},M=(0,x.useCallback)((e,t)=>{b||(0,B.qb)({editorDetailData:{...e,paramsData:I},editorDetailModalOpen:!0,editorDetailFrom:"history",editorIndex:t,editorId:a.id})},[b,c,m]),D=async e=>{let t=await U.p1.detectMedia({sourceHttpUrl:e});return t},S=async e=>{if(eb(e.originalVideoUrl)){let t=(null==e?void 0:e.taskParam)?JSON.parse(null==e?void 0:e.taskParam):{},i=(null==t?void 0:t.geniusPayload)?JSON.parse(null==t?void 0:t.geniusPayload):{},l=null==i?void 0:i.api_version,a=null==i?void 0:i.target_resolution;"normal"===l?p("已完成视频高清处理（极速，".concat(a,"）")):p("已完成视频高清处理（专业，".concat(a,"）")),u(!0)}else{let t=await D(e.originalVideoUrl);if(null==t?void 0:t.data){let{duration:e,size:i}=t.data;if(i&&i>104857600){p("暂仅支持100MB以内的视频"),u(!0);return}if(e&&e>600){p("暂不支持10分钟以上的视频"),u(!0);return}u(!1),p("")}}if(!k(null==e?void 0:e.videoUrl)){let t=f.current[e.id];t&&t.play().catch(e=>{console.warn("视频自动播放失败:",e)})}},O=e=>{if(u(!1),p(""),!k(null==e?void 0:e.videoUrl)){let t=f.current[e.id];t&&(t.pause(),t.currentTime=0,t.muted=!0)}},P=(e,t)=>{e.preventDefault(),e.stopPropagation(),w({visible:!0,x:e.clientX,y:e.clientY,item:t})},E=()=>{w({visible:!1,x:0,y:0,item:null})},V=async()=>{y.item&&(R({e:"lib.digitalhuman.editor.download",t:2,var:{image_uuid:y.item.id,generate_id:y.item.generateId}}),await q(y.item)),E()},z=async e=>{R({e:"lib.digitalhuman.editor.share",t:2,var:{image_uuid:e.id,generate_id:e.generateId}});try{let t=(0,Y.UV)("showShareVideoModal");t([{createTime:e.createTime,generateId:e.generateId,height:e.height,id:e.id,imageUrl:e.coverPathUrl||"",ossId:e.originalVideoUrl,width:e.width}],void 0,void 0,80===e.generateType?"digitalHuman":"video")}catch(e){console.error("分享视频失败",e)}},R=(0,C.T4)(),H=(e,t)=>(0,h.jsxs)("div",{className:"w-[248px] cursor-pointer",onClick:()=>{c||(R({e:"lib.video.editor.hd_panel.click",t:2,var:{}}),(0,B.qb)({isVideoEdit:!0}),M(e,t))},children:[(0,h.jsx)("div",{className:"w-[248px] h-[100px] rounded-lg overflow-hidden",children:(0,h.jsx)("img",{src:"https://liblibai-online.liblib.cloud/web/ef0097ae9da74189a0f5d604e98c77cd/86890f94-1b6d-447a-b7c1-11e192b519bd.gif",className:"w-full h-full object-cover"})}),(0,h.jsx)("div",{className:"text-[12px] font-medium text-[#0D0D0D] leading-[16px] pt-[16px]",children:"视频高清"}),(0,h.jsx)("p",{className:"text-[12px] text-[#4A535F] leading-[18px] py-[8px]",children:"智能提升视频分辨率,完美保留视频艺术效果,精美还原视频细节。"}),(0,h.jsx)("button",{className:A().actionButton,children:"立即体验"})]}),q=async e=>{await j({originalImageUrl:null==e?void 0:e.originalVideoUrl,fileUrl:null==e?void 0:e.videoUrl,imageUrl:null==e?void 0:e.coverPathUrl})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("ul",{className:A().videoImgRow,children:null==s?void 0:s.slice(Math.max(s.length-1,0)).map((e,t)=>(0,h.jsxs)("li",{className:"group ".concat(A().videoImageCard),onContextMenu:e=>{e.preventDefault(),e.stopPropagation()},children:[k(null==e?void 0:e.videoUrl)?(0,h.jsx)("img",{src:T(null==e?void 0:e.videoUrl),className:A().imageContent,alt:"违规内容已被过滤"}):(0,h.jsxs)("div",{className:"".concat(A().tagWrapper),onMouseEnter:()=>S(e),onMouseLeave:()=>O(e),children:[(0,h.jsx)("img",{src:T(null==e?void 0:e.coverPathUrl),onClick:()=>{M(e,t)},onContextMenu:t=>P(t,e)}),(0,h.jsx)("video",{preload:"metadata",disablePictureInPicture:!0,ref:t=>{t&&(0,Q.Kz)(t),f.current[e.id]=t},src:null==e?void 0:e.videoUrl,poster:T(null==e?void 0:e.videoUrl),className:A().videoContent,controls:!0,loop:!0,muted:!0,controlsList:"nodownload noremoteplayback",onClick:()=>{M(e,t)},onContextMenu:t=>P(t,e),...(0,Q.SW)()}),(0,h.jsx)("div",{className:A().hoverCover,children:(0,h.jsx)("div",{className:"flex absolute left-[0px] top-[0px] justify-end gap-[0px] w-full h-[72px] rounded-t-lg px-[8px] py-[8px]",style:{background:"linear-gradient(0deg, rgba(0, 0, 0, 0.00) 7.39%, rgba(0, 0, 0, 0.80) 100%)"},children:(0,h.jsxs)("div",{className:A().iconWrapper,children:[(0,h.jsx)("div",{className:A().actionImage,onClick:()=>n(),children:(0,h.jsx)(Z.default,{title:"重新配音",children:(0,h.jsx)(ex,{})})}),c?(0,h.jsx)(Z.default,{title:m,children:(0,h.jsx)("button",{disabled:c,className:"".concat(A().actionImage," ").concat(c?"opacity-50 cursor-not-allowed":""),children:(0,h.jsx)(G.Z,{})})}):(0,h.jsx)(N.default,{placement:"bottom",content:H(e,t),arrow:!1,zIndex:200,onOpenChange:e=>{e&&R({e:"lib.video.editor.hd_panel.show",t:2,var:{}})},children:(0,h.jsx)("button",{onClick:()=>{c||((0,B.qb)({isVideoEdit:!0}),M(e,t))},className:"".concat(A().actionImage," ").concat(c?"opacity-50 cursor-not-allowed":""),children:(0,h.jsx)(G.Z,{})})}),(0,h.jsx)(ee.o,{fileUrl:e.videoUrl,originalImageUrl:e.originalVideoUrl,mediaType:2,children:(0,h.jsx)("div",{className:A().actionImage,onClick:async()=>{R({e:"lib.digitalhuman.editor.download",t:2,var:{image_uuid:e.id,generate_id:e.generateId}}),q(e)},children:(0,h.jsx)(_.J,{class:"icon-lib3-down",fontSize:16})})}),(0,h.jsx)("div",{className:A().actionImage,onClick:()=>z(e),children:(0,h.jsx)(W,{})})]})})})]}),!b&&0==t&&r&&(0,h.jsx)("div",{className:"pt-3 text-right absolute right-0",children:(0,h.jsx)($,{isGenerating:!1})})]},e.id))}),(0,h.jsx)(F.Z,{visible:y.visible,x:y.x,y:y.y,onClose:E,onDownload:V,onShare:()=>{y.item&&z(y.item),E()},downloadText:"下载视频",shareText:"分享视频",downloadProps:y.item?{fileUrl:y.item.videoUrl,originalImageUrl:y.item.originalVideoUrl,mediaType:2,fileName:"video.mp4",reportData:{event:"lib.video.editor.download",type:2,vars:{video_uuid:y.item.id,generate_id:y.item.generateId},onReport:R}}:void 0})]})};let{confirm:e_}=y.default;var ey=e=>{var t,i,l,a,o,r,n,s,d,c;let{videoItem:u,index:m,data:p,setHistoryList:v,deleteImage:g}=e;null==u||null===(l=u.videos)||void 0===l||null===(i=l[0])||void 0===i||null===(t=i.param)||void 0===t||t.originalPrompt;let x=(null==u?void 0:u.taskParam)?JSON.parse(null==u?void 0:u.taskParam):{},b=[],{isMobile:j}=(0,L.z9)(),{colorScheme:y}=(0,eu.X)(),I=null==x?void 0:null===(a=x.frontCustomerReq)||void 0===a?void 0:a.overallStore,k=(null==x?void 0:x.geniusPayload)?JSON.parse(null==x?void 0:x.geniusPayload):{},D=(0,C.T4)(),{setShowFullGenerator:P,setSimpleGeneratorType:E}=(0,O.j)();try{I&&b.push({url:I.referenceList[0].url,label:"参考图"})}catch(e){console.warn("解析任务参数失败:",e)}let z=()=>{let{frontCustomerReq:e}=x,{overallStore:t}=e,{generatorData:i}=t;if(P(!0),E(f.oZ.DIGITAL_HUMAN),e){let{overallStore:t}=e;(0,V.Qj)({...t})}D({e:"lib.digitalhuman.editor.reconfig",t:2,var:{generate_id:u.id,prompt:i.prompt,ckp_model_name:i.modelName,ckp_model_uuid:i.checkpointId,video_size:i.ratio,duration:i.duration,resolution:i.resolution,sd_priority:1===i.taskQueuePriority?"low":"high",sd_param:JSON.stringify(i)}})},{generatorData:Z}=I;return(0,h.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,h.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,h.jsxs)("div",{className:"flex items-end justify-between gap-3 relative",children:[b.length>0?(0,h.jsx)(en,{imageClassName:"w-[36px] h-[48px]",modelImages:b}):null,(0,h.jsxs)("div",{className:"flex-1 max-h-[3.2em] overflow-auto absolute left-[48px] hover:max-h-[230px] w-[100%] top-0 hover:z-10 hover:bg-[#f0f0f0] rounded-lg p-[4px] pt-0 pb-0",children:[(0,h.jsxs)("div",{className:"".concat((null==Z?void 0:Z.audio)?"flex":""," gap-1 align-middle w-full"),children:[(0,h.jsx)("span",{className:"text-[#787878] text-sm leading-6 min-w-[42px]",children:"角色说: "}),(null==Z?void 0:Z.audio)?(0,h.jsx)(eg.Z,{audioUrl:null==Z?void 0:Z.audio}):(0,h.jsx)("span",{className:"text-sm text-[#333333] leading-6 break-all",children:null==Z?void 0:Z.sayContent})]}),(null==Z?void 0:Z.prompt)&&(0,h.jsxs)("div",{className:"gap-1 align-middle w-full",children:[(0,h.jsx)("span",{className:"text-[#787878] text-sm leading-6 min-w-[60px]",children:"动作描述: "}),(0,h.jsx)("span",{className:"text-sm text-[#333333] leading-6 break-all",children:null==Z?void 0:Z.prompt})]})]})]}),(0,h.jsx)("div",{className:"flex-1 relative",children:(0,h.jsxs)("div",{className:"flex gap-2 overflow-x-auto flex-1 min-w-0 hide-scrollbar",children:[(0,h.jsxs)("span",{className:"flex gap-1 ".concat(A().size),children:[(0,h.jsx)(ep,{})," 分辨率 ",k.resolution]}),(null==u?void 0:null===(r=u.videos)||void 0===r?void 0:null===(o=r[0])||void 0===o?void 0:o.width)?(0,h.jsxs)("span",{className:A().size,children:[null==u?void 0:null===(s=u.videos)||void 0===s?void 0:null===(n=s[0])||void 0===n?void 0:n.width,"*",null==u?void 0:null===(c=u.videos)||void 0===c?void 0:null===(d=c[0])||void 0===d?void 0:d.height]}):null]})})]}),(0,h.jsx)(ej,{list:null==u?void 0:u.videos,genData:u,id:u.id,isLastTask:m===p.length-1,historyList:p,handleReEdit:z}),(0,h.jsxs)("div",{className:A().action,children:[!j&&(0,h.jsxs)("span",{className:"".concat(A().actionSpan),onClick:z,children:[(0,h.jsx)(M,{}),(0,h.jsx)("span",{children:"重新编辑"})]}),(0,h.jsxs)("span",{className:"".concat(A().actionSpan),onClick:()=>{(0,ev.gC)(x);let{frontCustomerReq:e}=x,{overallStore:t}=e,{generatorData:i}=t;D({e:"lib.digitalhuman.editor.regen",t:2,var:{generate_id:u.id,prompt:i.prompt,ckp_model_name:i.modelName,ckp_model_uuid:i.checkpointId,video_size:i.ratio,duration:i.duration,resolution:i.resolution,sd_priority:1===i.taskQueuePriority?"low":"high",sd_param:JSON.stringify(i)}})},children:[(0,h.jsx)(S,{}),(0,h.jsx)("span",{children:"再次生成"})]}),(0,h.jsx)(N.default,{arrow:!1,placement:"right",classNames:{body:"!p-1 !rounded-[8px]"},content:(0,h.jsxs)("span",{className:"".concat(A().deleteAction),onClick:()=>{e_({title:"确定删除吗？",content:"删除后无法恢复",okText:"确定",cancelText:"取消",centered:!0,autoFocusButton:null,onOk(){var e;let t=null==u?void 0:null===(e=u.videos)||void 0===e?void 0:e[0];D({e:"lib.video.editor.delete",t:2,var:{image_uuid:t.id,generate_id:t.generateId}}),U.p1.deleteTask({generateId:u.id}).then(e=>{(null==e?void 0:e.code)===0?(g(u.id),w.ZP.success("删除成功")):w.ZP.warning("删除失败！")})}})},children:[(0,h.jsx)(_.J,{className:"".concat(A().actionTxt," icon-lib3-del"),fontSize:14}),(0,h.jsx)("span",{children:"删除该条记录"})]}),trigger:"click",children:(0,h.jsx)("span",{className:"".concat(A().actionSpan," b768:w-[32px] w-[28px]"),children:(0,h.jsx)(T,{})})})]})]},"".concat(u.id))},eN=i(25237),ew=i.n(eN),eI=i(56804),eT=i(28973);function ek(){return(ek=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}var eM=function(e){return x.createElement("svg",ek({xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none"},e),c||(c=x.createElement("path",{fill:"currentColor",d:"M11.037 1.705 6.742 6l4.295 4.295-.743.743-4.295-4.295-4.295 4.295-.743-.743L5.256 6 .96 1.705l.743-.743L6 5.257 10.294.962z"})))},eD=i(31407);function eS(){return(eS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}var eC=function(e){return x.createElement("svg",eS({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none"},e),u||(u=x.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",d:"M12.5 7c0 3.036-2.464 5.5-5.5 5.5A5.5 5.5 0 0 1 1.5 7c0-3.036 2.464-5.5 5.5-5.5s5.5 2.464 5.5 5.5M8.604 4.25 7 7.029"})))},eL=i(22900),eU=i(65942),eO=i(21854),eP=i(78182),eE=i(53907),eV=i(54941),ez=i(46792),eA=i(44930),eZ=i(68355),eR=i(64031),eF=e=>{let{isHD:t,loras:i=[],imageStyleList:l=[],videoEffectList:a=[],mediaType:o=f.oZ.IMAGE,templateList:r=[]}=e,n=o===f.oZ.IMAGE,{colorScheme:s}=(0,eu.X)(),d="dark"===s,c=e=>{let t=-1!==ea.v4.findIndex(t=>{var i;return null==e?void 0:null===(i=e.imageUrl)||void 0===i?void 0:i.includes(t)});return(0,h.jsx)(Z.default,{color:d?"#303030":"",placement:"top",title:"图片模型 权重：".concat(e.weight),children:(0,h.jsx)("div",{className:"".concat(A().imgModel," flex-shrink-0"),children:(0,h.jsxs)("div",{className:"".concat(A().mixModelName," !pl-[2px] relative"),children:[(0,h.jsx)("img",{src:"".concat(e.url||e.imageUrl).concat(t?"?x-oss-process=video/snapshot,t_0,f_jpg,m_fast":"","  "),className:"w-[24px] h-[24px] object-cover rounded-full"}),(0,h.jsx)("span",{className:"max-w-[180px] truncate",children:e.name}),(0,h.jsx)("span",{className:"absolute top-[2px] left- w-[24px] h-[24px] bg-[#000]/30 rounded-full text-center text-[12px] text-white leading-[24px]",children:e.weight})]})},"".concat(e.url||e.imageUrl))})},u=e=>{let t=-1!==ea.v4.findIndex(t=>{var i;return null==e?void 0:null===(i=e.imageUrl)||void 0===i?void 0:i.includes(t)}),i=(0,er.sz)(e.url||e.imageUrl,80);return(0,h.jsx)(Z.default,{color:d?"#303030":"",placement:"top",title:"视频特效",children:(0,h.jsx)("div",{className:"".concat(A().imgModel," !pl-[2px] relative cursor-pointer flex-shrink-0"),children:(0,h.jsxs)("div",{className:"".concat(A().mixModelName," !pl-[2px] relative cursor-pointer"),children:[t?(0,h.jsx)(h.Fragment,{children:e.webpUrl?(0,h.jsx)("img",{src:e.webpUrl,className:"w-[24px] h-[24px] object-cover rounded-full"}):(0,h.jsx)("video",{disablePictureInPicture:!0,loop:!0,muted:!0,autoPlay:!0,playsInline:!0,preload:"none",src:"".concat((null==e?void 0:e.url)||(null==e?void 0:e.imageUrl),"  "),className:"w-[24px] h-[24px] object-cover rounded-full"})}):(0,h.jsx)("img",{src:"".concat((null==e?void 0:e.url)||(null==e?void 0:e.imageUrl)?i:"").concat(t?"?x-oss-process=video/snapshot,t_0,f_jpg,m_fast":"","  "),className:"w-[24px] h-[24px] object-cover rounded-full"}),(0,h.jsx)("span",{className:"max-w-[130px] truncate",children:(null==e?void 0:e.name)||(null==e?void 0:e.modelName)})]})},"".concat((null==e?void 0:e.url)||(null==e?void 0:e.imageUrl)))},"".concat(e.url||e.imageUrl))},m=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=(0,er.sz)(e.url||e.imageUrl,80);return(0,h.jsx)(Z.default,{placement:"top",title:t?"图片模版":"图像风格",children:(0,h.jsx)("div",{className:"".concat(A().imgModel," flex-shrink-0"),children:(0,h.jsxs)("div",{className:A().mixModelName,children:[(0,h.jsx)("img",{src:"".concat(e.url||e.imageUrl?i:""),className:"w-[24px] h-[24px] object-cover rounded-full"}),e.name||(null==e?void 0:e.modelName)]})},"".concat(e.url||e.imageUrl))})};return(0,h.jsx)(h.Fragment,{children:!t&&(0,h.jsxs)(h.Fragment,{children:[(null==i?void 0:i.length)>0&&n?null==i?void 0:i.map(e=>c(e)):null,(null==l?void 0:l.length)>0&&n?null==l?void 0:l.map(e=>m(e)):null,(null==r?void 0:r.length)>0&&n?null==r?void 0:r.map(e=>m(e,!0)):null,(null==a?void 0:a.length)>0&&!n?null==a?void 0:a.map(e=>u(e)):null]})})},eG=e=>{var t,i,l,a;let{modelName:o,isHD:r,baseType:n,hdImageUrl:s,handleClickModelName:d,mediaType:c=f.oZ.IMAGE}=e,u=c===f.oZ.IMAGE?null===(i=f.rs)||void 0===i?void 0:null===(t=i[n])||void 0===t?void 0:t.icon:null===(a=f.ul)||void 0===a?void 0:null===(l=a[n])||void 0===l?void 0:l.icon;return(0,h.jsxs)(h.Fragment,{children:[o&&!r?(0,h.jsxs)("div",{className:"".concat(A().mixModelName," whitespace-nowrap !cursor-pointer"),onClick:d||void 0,children:[n&&u&&x.createElement(u),o]}):null,r?(0,h.jsxs)("span",{className:"".concat(A().size," !py-[2px] !pl-[2px]"),children:[s&&(0,h.jsx)("img",{src:(0,er.sz)(s,80),alt:"高清放大",className:"w-[28px] h-[28px] object-cover rounded-[8px]"}),(0,h.jsx)("span",{className:"text-[12px] ml-[6px]",children:c===f.oZ.IMAGE?"高清放大":"视频高清"})]}):null]})},eH=i(40070);function eW(){return(eW=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}var eB=function(e){return x.createElement("svg",eW({xmlns:"http://www.w3.org/2000/svg",width:12,height:13,fill:"none"},e),m||(m=x.createElement("path",{fill:"currentColor",d:"M6.577 4.502A1.5 1.5 0 0 1 8 6v4l-.002.077a1.5 1.5 0 0 1-1.42 1.421L6.5 11.5h-4a1.5 1.5 0 0 1-1.498-1.423L1 10V6a1.5 1.5 0 0 1 1.5-1.5h4zM2.5 5.4a.6.6 0 0 0-.6.6v4a.6.6 0 0 0 .6.6h4c.331 0 .6-.269.6-.6V6a.6.6 0 0 0-.6-.6zm7-3.9A1.5 1.5 0 0 1 11 3v5a1.5 1.5 0 0 1-1.5 1.5h-1v-.9h1c.331 0 .6-.269.6-.6V3a.6.6 0 0 0-.6-.6h-5a.6.6 0 0 0-.6.6v1H3V3a1.5 1.5 0 0 1 1.5-1.5z"})))};function eY(){return(eY=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}var eq=function(e){return x.createElement("svg",eY({xmlns:"http://www.w3.org/2000/svg",width:12,height:13,fill:"none"},e),p||(p=x.createElement("path",{fill:"currentColor",d:"M9.5 1.5A1.5 1.5 0 0 1 11 3v7a1.5 1.5 0 0 1-1.423 1.498L9.5 11.5h-7l-.077-.002a1.5 1.5 0 0 1-1.421-1.42L1 10V3a1.5 1.5 0 0 1 1.5-1.5zm-7 .9a.6.6 0 0 0-.6.6v7a.6.6 0 0 0 .6.6h7c.331 0 .6-.269.6-.6V3a.6.6 0 0 0-.6-.6zm5.95 3.1h-.9v-.3h-1.1v2.85H7v.9H5v-.9h.55V5.2h-1.1v.3h-.9V4.3h4.9z"})))},eQ=e=>{let{promptText:t,handleUsePrompt:i}=e,{setShowFullGenerator:l}=(0,O.j)(),a=(0,eH.V)({timeout:500});return(0,h.jsx)("div",{className:"".concat(A().prompt," relative z-[10] flex-1"),"data-content":t,children:(0,h.jsxs)("div",{className:"".concat(A().promptCont," absolute inset-0"),onMouseLeave:e=>{e.currentTarget.scrollTop=0},children:[t,i?(0,h.jsxs)("span",{className:A().promptCopy,children:[(0,h.jsxs)("span",{className:A().promptCopyItem,onClick:()=>{null==i||i(t),l(!0)},children:[(0,h.jsx)("span",{className:A().promptCopyItemIcon,children:(0,h.jsx)(eq,{})}),"使用提示词"]}),(0,h.jsxs)("span",{className:A().promptCopyItem,onClick:()=>{a.copy(t),w.ZP.success("已复制")},children:[(0,h.jsx)("span",{className:A().promptCopyItemIcon,children:(0,h.jsx)(eB,{})}),"复制"]})]}):null]})})},eJ=e=>{let{title:t,content:i}=e,l=(null==t?void 0:t.length)>10?"".concat(t.slice(0,10),"..."):t,a=(0,eH.V)({timeout:500}),o=()=>{a.copy(i),w.ZP.success("已复制")};return(0,h.jsx)(Z.default,{title:(0,h.jsx)(()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"text-[14px] font-[500] mb-2",children:t}),(0,h.jsxs)("div",{className:"text-[12px]",children:[(0,h.jsx)("span",{className:A().promptCopyItemIcon,onClick:o,children:(0,h.jsx)(eB,{})}),i]})]}),{}),styles:{body:{maxWidth:"586px",minWidth:"300px",width:"max-content",padding:"16px",whiteSpace:"pre-wrap",wordWrap:"break-word"}},children:(0,h.jsxs)("div",{className:A().mixModelName,children:["图片模版：",l]})})};let eK=eI.tY(),eX=ew()(()=>Promise.all([i.e(7642),i.e(7680)]).then(i.t.bind(i,97680,23)),{loadableGenerated:{webpack:()=>[97680]},ssr:!1});var e$=e=>{var t,i,l,a,o,r,n,s,d,c,u,m,p,v,g;let{task:b,getHistoryList:j,mediaType:_=f.oZ.IMAGE,isHiddenTask:y,isTemplate:N=!1}=e,[I,T]=(0,x.useState)(null==b?void 0:b.taskParams),[k,M]=(0,x.useState)(),[D,S]=(0,x.useState)([]),[O,E]=(0,x.useState)(),[V,z]=(0,x.useState)(),[Z,R]=(0,x.useState)([]),[F,G]=(0,x.useState)([]),[H,W]=(0,x.useState)([]),[B,Y]=(0,x.useState)([]),q=(0,x.useRef)([]),[Q,J]=(0,x.useState)(A().imgF1),[K,X]=(0,x.useState)(1),[ee,et]=(0,x.useState)(!0),[ei,el]=(0,x.useState)(),er=(0,C.T4)(),{colorScheme:es}=(0,eu.X)(),ed="dark"===es,[ec,em]=(0,x.useState)(null),[eh,ex]=(0,x.useState)(""),[ef,eb]=(0,x.useState)(null),{remainPriority:ej}=(0,eA.lw)(),{acceleratorCard:e_}=(0,eR.commercialStore)(),{isMobile:ey}=(0,L.z9)(),eN=_===f.oZ.IMAGE,ew=_===f.oZ.VIDEO,eI=_===f.oZ.DIGITAL_HUMAN,ek=_===f.oZ.ACTION_FOLLOW;(0,x.useEffect)(()=>{fetch("https://liblibai-online.liblib.cloud/web/70a305c50c704a778db114468830617b/42661d09-e1a0-47e5-86f6-ce257ddef46e.json").then(e=>e.json()).then(e=>em(e)).catch(e=>console.error("Error fetching Lottie JSON:",e))},[]),(0,x.useEffect)(()=>{if(null==b?void 0:b.generateId){el(null==b?void 0:b.generateId);let e={actionfollow:P.w5,digitalhuman:ev.w5,video:eP.w5,image:eO.w5}[_],t=e({generateId:b.generateId,onProgress:e=>{T(e)},getHistoryList:j,task:b,bizType:N?eL.GH:22});return()=>{t()}}},[null==b?void 0:b.generateId]);let eS=(0,x.useMemo)(()=>{var e;return(0,f.L6)(Number(null==b?void 0:null===(e=b.taskParams)||void 0===e?void 0:e.generateType))},[null==b?void 0:null===(t=b.taskParams)||void 0===t?void 0:t.generateType]);(0,x.useEffect)(()=>{var e,t,i,l,a,o,r,n,s,d,c;let u=null==I?void 0:null===(e=I.frontCustomerReq)||void 0===e?void 0:e.overallStore,m=(null==I?void 0:null===(i=I.frontCustomerReq)||void 0===i?void 0:null===(t=i.overallStore)||void 0===t?void 0:t.generatorData)||(null==b?void 0:b.taskParams),p=null==m?void 0:m.width,v=null==m?void 0:m.height,g=[],h=(null==I?void 0:I.batchSize)||(null==b?void 0:null===(r=b.taskParams)||void 0===r?void 0:null===(o=r.frontCustomerReq)||void 0===o?void 0:null===(a=o.overallStore)||void 0===a?void 0:null===(l=a.generatorData)||void 0===l?void 0:l.count),x=[],j=[],_=null,y=[],w=[],T=null;if(u){let e=(0,eE.qi)(u.generatorData.checkpointId,u.generatorData.baseType,(0,eV.p4)().supportModelList||[]),t=N?u.generalImages:ek?u.referenceList:(0,eU.cu)(e?u.generalImages:u.referenceList),i=(0,eU.cu)(u.referenceVideoList);eS&&(t=u.generalImages);let l=[{items:t,urlField:"url"}];if(Array.isArray(i)){let e=i.map(e=>{let t=(null==e?void 0:e.coverPathUrl)||(null==e?void 0:e.imageUrl)||(null==e?void 0:e.url);return(!t&&(null==e?void 0:e.videoUrl)||t&&(0,ea.NU)(t))&&(t=(0,ea.VP)(e.videoUrl||t)),t?{url:t,videoUrl:null==e?void 0:e.videoUrl,label:"参考视频",item:e}:null}).filter(e=>!!e);g.push(...e)}l.forEach(e=>{let{items:t,urlField:i}=e;if(Array.isArray(t)){let e=t.map(e=>{var t;return{url:(null==e?void 0:e[i])||(null==e?void 0:e.imageUrl),label:eN?null==e?void 0:e.label:(null===(t=f.r2)||void 0===t?void 0:t[null==e?void 0:e.referenceType])||"参考图",item:e}}).filter(e=>!!e.url);g.push(...e)}}),x=u.additionalNetwork||u.imageStyleList||[],j=u.imageStyleList||[],_=eN?null===(s=u.generatorData)||void 0===s?void 0:s.baseType:null===(d=u.generatorData)||void 0===d?void 0:d.modelKey,y=(null==u?void 0:u.videoEffectList)||[],T=u.templateInfo||null,w=u.templateList||[],q.current=y}R(x),eb(T),ex(null==u?void 0:u.video_url),G(j),W(w),Y(y),S(g),E(null==u?void 0:null===(n=u.generatorData)||void 0===n?void 0:n.modelName),z(_),ee&&(X(null==u?void 0:null===(c=u.generatorData)||void 0===c?void 0:c.taskQueuePriority),et(!1));let k={"9:16":9/16,"2:3":2/3,"3:4":3/4,"1:1":1,"4:3":4/3,"3:2":1.5,"16:9":16/9},D=1===h?{"9:16":A().imgF1,"2:3":A().imgF2,"3:4":A().imgF3,"1:1":A().oneImgF4,"4:3":A().oneImgF5,"3:2":A().oneImgF6,"16:9":A().imgF7}:{"9:16":A().imgF1,"2:3":A().imgF2,"3:4":A().imgF3,"1:1":A().imgF4,"4:3":A().imgF5,"3:2":A().imgF6,"16:9":A().imgF7},C=A().imgF1;if(p&&v&&p>0&&v>0){let e=p/v,t={};Object.keys(k).forEach(i=>{t[i]=Math.abs(e-k[i])});let i=Math.min(...Object.values(t)),l=Object.keys(t).filter(e=>t[e]===i),a=Object.keys(k),o=l[0];if(l.length>1){let e=l.map(e=>a.indexOf(e));o=a[Math.min(...e)]}C=D[o]||A().imgF1}J(C),M(m)},[I,b,eS]);let eH=async()=>{let e=eN?"lib.image.editor.cancel":"lib.video.editor.cancel";er({e:e,t:2,var:{}}),(null==b?void 0:b.generateId)&&await U.BP.stopTaskRequest({generateId:Number(null==b?void 0:b.generateId)||0}),eN?(0,eO.F6)(b.taskId):eI?(0,ev.F6)(b.taskId):ek?(0,P.F6)(b.taskId):(0,eP.F6)(b.taskId),w.ZP.success("".concat(eN?"生图":"视频","任务已取消，积分等权益已返还"))},eW=async()=>{var e,t,i;if(null==b?void 0:b.generateId){let e={generateId:null==b?void 0:b.generateId};e_.id&&e_.time&&(e.userCouponId=e_.id);let t=await U.BP.vipSpeedup(e),i=eN?(0,eO.tW)(t):(0,eP.BI)(t);if(i)return;eT.jT[String(t.code)]&&er({e:"training.billing.show",t:2,var:{train_billing_referer:42}}),X(2),w.ZP.success("加速成功")}let l=(0,eV.p4)("additionalNetwork"),a=eN?"lib.image.editor.jump":"lib.video.editor.jump",o={};if(eN)o={...o,ckp_model_uuid:k.modelUuid,ckp_version_uuid:k.versionUuid,lora_list:null==l?void 0:l.map(e=>({lora_name:e.name,lora_model_uuid:e.uuid,lora_version_uuid:e.versionId})),img_size:k.scale,img_width:k.width,img_height:k.height,img_cnt:k.count};else{let l="",a=(null===(e=q.current)||void 0===e?void 0:e.at(0))||(null===(t=(0,ez.getVideoGeneratorState)("videoEffectList"))||void 0===t?void 0:t.at(0));l=(null==a?void 0:null===(i=a.at(0))||void 0===i?void 0:i.name)||"",o={...o,ckp_model_uuid:k.checkpointId,video_size:k.ratio,duration:k.duration,resolution:k.resolution,sd_priority:1===k.taskQueuePriority?"low":"high",video_effect_name:l,sd_param:JSON.stringify(k)}}er({e:a,t:2,var:{prompt:k.prompt,ckp_model_name:k.modelName,...o}})},{SpeedAccelerationComponent:eB}=(0,eZ.Z)({queueNum:(null==I?void 0:I.queueNum)||0,vipSpeedup:eW,sence:eN?"ImageEditor":"VideoEditor"});(0,x.useCallback)(e=>{eN?(0,eV.ae)({generatorData:{...(0,eV.p4)().generatorData,...e}}):(0,ez.setVideoGeneratorState)({generatorData:{...(0,ez.getVideoGeneratorState)().generatorData,...e}})},[]);let eY=(null==I?void 0:I.batchSize)*(null==I?void 0:I.batchCount)||(null==b?void 0:null===(o=b.taskParams)||void 0===o?void 0:null===(a=o.frontCustomerReq)||void 0===a?void 0:null===(l=a.overallStore)||void 0===l?void 0:null===(i=l.generatorData)||void 0===i?void 0:i.count);return y?null:(0,h.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,h.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,h.jsxs)("div",{className:"flex items-end justify-between gap-3",children:[D.length>0&&!eS?(0,h.jsx)(en,{imageClassName:eI?"w-[36px] h-[48px]":"",modelImages:D}):null,ek&&(null==k?void 0:null===(r=k.videos)||void 0===r?void 0:r.length)>0&&!eS&&(0,h.jsx)(en,{imageClassName:eI?"w-[36px] h-[48px]":"",modelImages:[{url:(0,ea.VP)(k.videos[0]),label:"动作"}]}),eI?(0,h.jsxs)("div",{className:"flex-1 max-h-[3.2em] overflow-auto",children:[(0,h.jsxs)("div",{className:"".concat((null==k?void 0:k.audio)?"flex":""," gap-1 align-middle w-full"),children:[(0,h.jsx)("span",{className:"text-[#787878] text-sm leading-6 min-w-[42px]",children:"角色说 "}),(null==k?void 0:k.audio)?(0,h.jsx)(eg.Z,{audioUrl:null==k?void 0:k.audio}):(0,h.jsx)("span",{className:"text-sm text-[#333333] leading-6",children:null==k?void 0:k.sayContent})]}),(null==k?void 0:null===(n=k.prompt)||void 0===n?void 0:n.length)>0?(0,h.jsxs)("div",{className:"gap-1 align-middle w-full",children:[(0,h.jsx)("span",{className:"text-[#787878] text-sm leading-6 min-w-[60px]",children:"动作描述 "}),(0,h.jsx)("span",{className:"text-sm text-[#333333] leading-6",children:null==k?void 0:k.prompt})]}):null]}):(0,h.jsx)("div",{className:"flex-1",children:(null==k?void 0:null===(s=k.prompt)||void 0===s?void 0:s.length)>0?(0,h.jsx)(eQ,{promptText:null==k?void 0:k.prompt}):null})]}),(0,h.jsx)("div",{className:"flex-1 relative",children:(0,h.jsxs)("div",{className:"flex gap-2 overflow-x-auto flex-1 min-w-0 hide-scrollbar",children:[ek&&(0,h.jsx)(eo,{generatorData:k}),(0,h.jsx)(eG,{modelName:O||"",isHD:eS,baseType:V,mediaType:_,hdImageUrl:eN?null==D?void 0:null===(d=D[0])||void 0===d?void 0:d.url:(0,ea.VP)(eh)}),(0,h.jsx)(eF,{isHD:eS,loras:Z,imageStyleList:F,templateList:H,videoEffectList:B,mediaType:_}),eN&&(null==k?void 0:k.width)?(0,h.jsxs)("span",{className:A().size,children:[null==k?void 0:k.width,"x",null==k?void 0:k.height]}):null,(null==k?void 0:k.modelShortName)==="MiniMax"?(0,h.jsx)("span",{className:A().size,children:null==k?void 0:k.resolution}):null,(null==k?void 0:k.scale)&&(null==k?void 0:k.modelShortName)!=="MiniMax"?(0,h.jsx)("span",{className:A().size,children:(e=>{switch(e){case"custom":return"自定义比例";case"auto":case"adaptive":return"智能匹配";default:return e}})(null==k?void 0:k.scale)}):null,ew&&(0,h.jsxs)(h.Fragment,{children:[(null==k?void 0:k.ratio)?(0,h.jsx)("span",{className:A().size,children:D.length>0?"智能匹配":null==k?void 0:k.ratio}):null,(0,h.jsxs)("div",{className:A().size,children:[(0,h.jsx)(eC,{fontSize:14,className:"mr-[2px]"}),(null==k?void 0:k.duration)?(0,h.jsxs)("span",{children:[k.duration,"s"]}):null]})]}),eI&&(0,h.jsx)("div",{children:(0,h.jsx)("div",{className:"flex-1 relative",children:(0,h.jsxs)("div",{className:"flex gap-2 overflow-x-auto flex-1 min-w-0 hide-scrollbar",children:[(0,h.jsxs)("span",{className:"flex gap-1 ".concat(A().size),children:[(0,h.jsx)(ep,{})," 分辨率 ",null==k?void 0:k.resolution]}),(null==k?void 0:null===(u=k.videos)||void 0===u?void 0:null===(c=u[0])||void 0===c?void 0:c.width)?(0,h.jsxs)("span",{className:A().size,children:[null==k?void 0:null===(p=k.videos)||void 0===p?void 0:null===(m=p[0])||void 0===m?void 0:m.width,"*",null==k?void 0:null===(g=k.videos)||void 0===g?void 0:null===(v=g[0])||void 0===v?void 0:v.height]}):null]})})}),N&&ef&&(0,h.jsx)(eJ,{title:null==ef?void 0:ef.title,content:null==ef?void 0:ef.styleDescription})]})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("ul",{className:"grid gap-1 b768:grid-cols-4 ".concat(eN?"grid-cols-2":"grid-cols-1"),children:Array.from({length:eN?eY:1},(e,t)=>(0,h.jsxs)("li",{className:"group ".concat(A().loadingImageList," ").concat(Q," ").concat(eN?"":A().loadingVideoList),children:[(!eN||ey)&&eN||0!==t?null:(null==I?void 0:I.subStatus)===1?(0,h.jsxs)("div",{className:"".concat(A().loadingInfo," ").concat(ei&&2===K?"!text-[#FFDEAD]":""),children:["number"==typeof(null==I?void 0:I.percentCompleted)?(null==I?void 0:I.percentCompleted)+"% ":"","生成中..."]}):(null==I?void 0:I.queueNum)?(0,h.jsx)("div",{className:A().loadingInfo,children:ei&&2===K?(0,h.jsxs)("span",{className:"".concat(A().actionTxt," !text-[#FFDEAD]"),children:["第",null==I?void 0:I.queueNum,"位 正在为您加速…"]}):(0,h.jsxs)(h.Fragment,{children:["第",null==I?void 0:I.queueNum,"位 / 共",null==I?void 0:I.totalQueueNum,"位 排队中..."]})}):(0,h.jsx)("div",{className:A().loadingInfo,children:"正在加载资源"}),(0,h.jsx)("div",{className:A().tagWrapper,children:ec?(0,h.jsx)(eX,{animationData:ec,loop:!0,className:"absolute inset-0",rendererSettings:{preserveAspectRatio:"none"}}):null}),!ey&&0===t&&(0,h.jsx)("div",{className:"absolute h-[90px] flex flex-col-reverse right-0 bottom-0 left-0 px-2 pb-3 bg-gradient-to-b from-[#99999900] to-[#1A202680]",children:(0,h.jsx)($,{isGenerating:!0})})]},t))}),ey&&eN?(null==I?void 0:I.subStatus)===1?(0,h.jsxs)("div",{className:"text-[#787878] text-[12px] mt-1",children:["number"==typeof(null==I?void 0:I.percentCompleted)?(null==I?void 0:I.percentCompleted)+"% ":"","生成中..."]}):(null==I?void 0:I.queueNum)?(0,h.jsx)("div",{className:"text-[#787878] text-[12px] mt-1",children:ei&&2===K?(0,h.jsxs)("span",{className:"".concat(A().actionTxt," !text-[#FFDEAD]"),children:["第",null==I?void 0:I.queueNum,"位 正在为您加速…"]}):(0,h.jsxs)(h.Fragment,{children:["第",null==I?void 0:I.queueNum,"位 / 共",null==I?void 0:I.totalQueueNum,"位 排队中..."]})}):(0,h.jsx)("div",{className:"text-[#787878] text-[12px] mt-1",children:"正在加载资源"}):null]}),ei?(0,h.jsxs)("div",{className:A().action,children:[(null==I?void 0:I.subStatus)===0?(0,h.jsxs)("span",{className:"".concat(A().actionSpan," dark:bg-[var(--color-button-bg)] dark:hover:bg-[var(--color-button-bg)]"),onClick:()=>{eH()},children:[(0,h.jsx)(eM,{}),(0,h.jsx)("span",{className:A().actionTxt,children:"取消任务"})]}):null,!eK&&1===K&&(0,h.jsxs)("span",{className:"".concat(A().actionSpan," ").concat(A().vipBg," ").concat(ed?A().darkVipbg:""," !text-[#FFDEAD]"),style:{background:ed?"var(--color-button-bg)":"var(--img-edit-loading-speed)"},onClick:()=>{eW()},children:[(0,h.jsx)(eD.Z,{}),(0,h.jsx)("span",{className:A().actionTxt,children:"开启加速"})]}),2===K&&(0,h.jsxs)("span",{className:"text-[#787878] text-[12px]",children:["剩余加速次数",ej,"次"]})]}):null,eB()]})},e0=i(69185),e1=i(79971),e2=i(22884),e3=i(14959),e4=i(91633);function e6(){return(e6=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}i(6364);var e8=function(e){return x.createElement("svg",e6({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none"},e),v||(v=x.createElement("path",{fill:"currentColor",d:"M11.666.332a2 2 0 0 1 2 2v9.334a2 2 0 0 1-1.896 1.997l-.104.003H2.333l-.102-.003A2 2 0 0 1 .336 11.77l-.003-.103V2.332a2 2 0 0 1 2-2zM1.534 6.869v4.797a.8.8 0 0 0 .8.8h5.442a6.133 6.133 0 0 0-6.11-5.6zm.8-5.337a.8.8 0 0 0-.8.8v3.337l.132-.003c3.871 0 7.04 2.999 7.313 6.8h2.687a.8.8 0 0 0 .801-.8V2.332a.8.8 0 0 0-.8-.8zM9.665 3a1.334 1.334 0 1 1 0 2.668 1.334 1.334 0 0 1 0-2.668"})))},e5=i(19750),e7=i(32893);function e9(){return(e9=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e}).apply(this,arguments)}var te=function(e){return x.createElement("svg",e9({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none"},e),g||(g=x.createElement("path",{fill:"currentColor",d:"M11.337 9.213a.133.133 0 0 1 .234 0l.75 1.373 1.373.75a.134.134 0 0 1 0 .234l-1.372.75-.751 1.373a.133.133 0 0 1-.234 0l-.75-1.373-1.373-.75a.134.134 0 0 1 0-.234l1.372-.75zm.33-8.881a2 2 0 0 1 2 2v6h-1.2v-6a.8.8 0 0 0-.8-.8H2.332a.8.8 0 0 0-.8.8v9.334a.8.8 0 0 0 .8.8h6v1.2h-6l-.102-.003A2 2 0 0 1 .336 11.77l-.003-.103V2.332a2 2 0 0 1 2-2zm-6.6 5.273a1.267 1.267 0 0 1 1.928-1.08l2.278 1.393a1.267 1.267 0 0 1 0 2.161L6.995 9.472A1.267 1.267 0 0 1 5.067 8.39zM6.3 5.548a.1.1 0 0 0-.026.023.1.1 0 0 0-.008.034v2.786q.001.024.008.034a.1.1 0 0 0 .026.024q.019.01.033.01a.1.1 0 0 0 .034-.012l2.279-1.392a.1.1 0 0 0 .024-.024.07.07 0 0 0 0-.066.1.1 0 0 0-.024-.024L6.367 5.55a.1.1 0 0 0-.033-.01.1.1 0 0 0-.033.009"})))},tt=i(92127);let ti=e=>{let{icon:t,text:i,disabledText:l,onClick:a,className:o=""}=e,r=(0,h.jsx)("div",{className:"w-[26px] h-[26px] hover:!bg-[rgba(173,173,173,0.6)] flex-shrink-0 rounded-[8px] flex items-center justify-center text-white ".concat(l?"opacity-30 cursor-not-allowed hover:!none":""),onClick:l?void 0:a,children:t});return l?(0,h.jsx)(Z.default,{title:l,placement:"top",color:"#333",children:r}):(0,h.jsx)(N.default,{placement:"top",arrow:!1,content:"string"==typeof i?(0,h.jsx)("span",{className:"dark:text-white",children:i}):i,className:"dark:text-white",children:r})},{confirm:tl}=y.default,ta=eI.tY(),to=e=>{let{list:t,id:i,genData:l,setHistoryList:a,historyList:o,isLastTask:r,isTemplate:n=!1}=e,[s,d]=(0,x.useState)([]),{showShareImgModal:c}=(0,tt.W)(),{handleImageClick:u}=(0,b.i)(),m=(0,C.T4)(),{isMobile:p}=(0,L.z9)(),{changeEditorMediaType:v}=(0,e0.N)(),{setShowFullGenerator:g,simpleGeneratorType:f}=(0,O.j)(),j=(0,eV.uA)("supportModelList"),y=(0,eV.uA)("generatorData"),{handleDownload:N}=(0,ef.Ag)({isTeam:!1});(0,eR.useWatermarkSettingState)("removeWatermark");let{isVip:I}=(0,eA.RR)(),[T,k]=(0,x.useState)({visible:!1,x:0,y:0,item:null}),[M,D]=(0,x.useState)(null),[S,P]=(0,x.useState)({}),E=(0,x.useRef)(new Set),V=(0,x.useRef)({});(0,x.useEffect)(()=>{let e=localStorage.getItem("processedVideoButtonImages");if(e)try{let t=JSON.parse(e);E.current=new Set(t)}catch(e){console.warn("Failed to parse processed images from localStorage:",e)}},[]);let z=(0,x.useMemo)(()=>{if(!(null==l?void 0:l.taskParam))return null;try{let e=JSON.parse(null==l?void 0:l.taskParam);return e}catch(e){return null}},[null==l?void 0:l.genData]);(0,x.useEffect)(()=>{d(t)},[t]),(0,x.useEffect)(()=>{t&&t.length>0&&t.forEach(e=>{let t="".concat(e.id||e.imageId);if(E.current.has(t))return;let i=Date.now(),l=new Date(e.createdAt||e.createTime||e.updatedAt||i).getTime();if(i-l<1e4){E.current.add(t),localStorage.setItem("processedVideoButtonImages",JSON.stringify(Array.from(E.current))),P(e=>({...e,[t]:!0}));let e=setTimeout(()=>{P(e=>({...e,[t]:!1})),delete V.current[t]},5e3);V.current[t]=e}else E.current.add(t),localStorage.setItem("processedVideoButtonImages",JSON.stringify(Array.from(E.current)))})},[t]),(0,x.useEffect)(()=>()=>{Object.values(V.current).forEach(clearTimeout)},[]);let Z=e=>"".concat(e,"?image_process=format,webp&x-oss-process=image/resize,w_",640,",m_lfit/format,webp"),R=(e,t)=>{let i="".concat(e.id||e.imageId);t?D(i):D(null)},H=(0,x.useCallback)((e,t)=>{p||(0,B.qb)({editorDetailData:{...e,paramsData:z},editorDetailModalOpen:!0,editorDetailFrom:"history",editorIndex:t,editorId:l.id})},[p,z,l.id]),Y=e=>{m({e:"lib.image.editor.gen_video",t:2,var:{image_uuid:e.id,generate_id:e.generateId}});let t={url:e.imageUrl,width:e.width,height:e.height,enable:!0,referenceImage:e.imageUrl,originalImageUrl:e.originalImageUrl||e.imageUrl};(0,B.qb)({editorImage2VideoData:t}),v(eL.oZ.VIDEO),g(!0)},Q=async e=>{m({e:"lib.image.editor.share",t:2,var:{image_uuid:e.id,generate_id:e.generateId}});let t=[e].map(e=>{var t,i,l,a,o,r;let n=(null==e?void 0:null===(i=e.param)||void 0===i?void 0:null===(t=i.mixModels)||void 0===t?void 0:t.map(e=>{let{modelId:t,modelVersionId:i}=e;return{modelId:t,versionId:i}}))||[],s=(null==e?void 0:null===(a=e.param)||void 0===a?void 0:null===(l=a.mixModels)||void 0===l?void 0:l.map(e=>{let{modelId:t,modelName:i,modelVersionId:l,modelVersionName:a}=e;return{modelId:t,versionId:l,modelName:i,versionName:a}}))||[];return{type:"imageToolRecord",height:e.height,width:e.width,outputId:null==e?void 0:e.outputId,imageUrl:null==e?void 0:e.originalImageUrl,generateInfo:{...null==e?void 0:e.param,prompt:(null==e?void 0:null===(o=e.param)||void 0===o?void 0:o.originalPrompt)||(null==e?void 0:null===(r=e.param)||void 0===r?void 0:r.prompt),models:n},mixModels:s}});t&&c({batchType:2,shareImgs:{tags:[],images:t}})},K=async e=>{try{m({e:"lib.image.editor.delete",t:2,var:{image_uuid:e.id,generate_id:e.generateId}});let t=await U.p1.editorImgDelete({idList:[e.editorImageId],source:0});if((null==t?void 0:t.code)===0){if(w.ZP.success("删除成功"),a&&Array.isArray(o)){let t=o.map(t=>{if(t.id===i){var l;return{...t,images:(null===(l=t.images)||void 0===l?void 0:l.filter(t=>t.editorImageId!==e.editorImageId))||[]}}return t}),l=t.filter(e=>e.id!==i||e.images&&e.images.length>0);a(e=>[...l])}}else w.ZP.error((null==t?void 0:t.msg)||"删除失败")}catch(e){console.error("删除图片失败:",e),w.ZP.error("删除图片时发生错误")}};(0,x.useMemo)(()=>(0,eE.qi)(null==y?void 0:y.checkpointId,null==y?void 0:y.baseType,j),[y,j]);let X=(e,t)=>{e.preventDefault(),e.stopPropagation(),k({visible:!0,x:e.clientX,y:e.clientY,item:t})},et=()=>{k({visible:!1,x:0,y:0,item:null})},ei=async()=>{T.item&&await er(T.item),et()},el=(0,x.useMemo)(()=>{let{width:e,height:t}=(null==s?void 0:s[0])||{};return(0,e1.Xn)({w:e,h:t})},[s]),ea=e=>{if(f===eL.oZ.VIDEO){let t={url:e.imageUrl,width:e.width,height:e.height,enable:!0,referenceImage:e.imageUrl,originalImageUrl:e.originalImageUrl||e.imageUrl};(0,B.qb)({editorImage2VideoData:t});return}let t={...e,url:e.originalImageUrl,referenceImage:e.originalImageUrl};u(t,!0)},eo=async e=>{try{let t;let l=1===e.collected?0:1;if((null==(t=await U.p1.collectEditorImg({idList:[e.editorImageId],collected:l,bizType:22}))?void 0:t.code)===0&&(w.ZP.success(1===e.collected?"取消收藏成功":"收藏成功"),a&&Array.isArray(o))){let t=o.map(t=>{if(t.id===i){var a;return{...t,images:(null===(a=t.images)||void 0===a?void 0:a.map(t=>t.editorImageId===e.editorImageId?{...t,collected:l}:t))||[]}}return t});a(e=>[...t])}}catch(e){console.error("收藏图片失败:",e),w.ZP.error("收藏图片时发生错误")}},er=async e=>{await N({originalImageUrl:null==e?void 0:e.originalImageUrl,fileUrl:null==e?void 0:e.imageUrl,imageUrl:null==e?void 0:e.imageUrl})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("style",{children:"\n          .hack-antd-mask .ant-image-preview-close {\n            top: calc(32px + env(safe-area-inset-top));\n          }\n        "}),(0,h.jsx)("ul",{className:"grid grid-cols-2 gap-1 b768:grid-cols-4",children:null==s?void 0:s.slice(Math.max(s.length-4,0)).map((e,t)=>{let i=t===s.length-1;return(0,h.jsxs)("li",{className:"group ".concat(A().imageList),children:[p?(0,h.jsx)("div",{className:A().tagWrapper,style:{aspectRatio:(null==e?void 0:e.width)/(null==e?void 0:e.height),width:"content-fit"},children:(0,h.jsx)(e4.Z,{src:Z(null==e?void 0:e.imageUrl),style:{aspectRatio:(null==e?void 0:e.width)/(null==e?void 0:e.height),width:"content-fit"},rootClassName:"hack-antd-mask",preview:{toolbarRender:(t,i)=>(0,h.jsxs)("div",{className:"bg-[rgba(102,102,102,0.65)] border-[0.5px] border-[rgba(255,255,255,0.3)] rounded-[8px] px-3 py-1 backdrop-blur-[10px] text-white font-[500]",onClick:async t=>{let i;t.stopPropagation(),m({e:"lib.image.editor.download",t:2,var:{image_uuid:e.id,generate_id:e.generateId}});let l="true"===localStorage.getItem("removeWatermark");if(l&&I)i=null==e?void 0:e.imageUrl;else{let{downloadUrl:t}=await (0,J.aj)({fileUrl:null==e?void 0:e.imageUrl,mediaType:1,needAiWaterMark:!l});i=t||(null==e?void 0:e.imageUrl)}ta?(await eI.o$(i),w.ZP.success("图片已保存到相册")):(0,q.ZP)(i)},children:[(0,h.jsx)(_.J,{class:"icon-lib3-down",fontSize:16}),(0,h.jsx)("span",{children:"下载"})]})}})}):(0,h.jsxs)("div",{className:A().tagWrapper,onClick:()=>n?"undefined":H(e,t),onContextMenu:t=>n?"undefined":X(t,e),onMouseEnter:()=>n?"undefined":R(e,!0),onMouseLeave:()=>n?"undefined":R(e,!1),style:{aspectRatio:(null==e?void 0:e.width)/(null==e?void 0:e.height),width:"content-fit",height:"content-fit",backgroundColor:"#20242A"},children:[(0,h.jsx)(e4.Z,{src:Z(null==e?void 0:e.imageUrl),style:{aspectRatio:(null==e?void 0:e.width)/(null==e?void 0:e.height),width:"content-fit"},preview:!!n&&{src:null==e?void 0:e.imageUrl}}),(0,h.jsx)("div",{className:"flex absolute left-[8px] bottom-[8px] z-10",children:(0,h.jsxs)("div",{className:"".concat(A().actionImagev," transition-opacity duration-300 cursor-pointer ").concat(S["".concat(e.id||e.imageId)]||M==="".concat(e.id||e.imageId)?"opacity-100":"opacity-0 pointer-events-none"),onClick:t=>{t.stopPropagation(),Y(e)},children:[(0,h.jsx)(te,{}),"图生视频"]})}),n?null:(0,h.jsxs)("div",{className:"".concat(A().hoverCover),children:[(0,h.jsxs)("div",{className:"flex absolute right-2 top-2 justify-end items-center gap-[2px] h-[29px] rounded-lg bg-[rgba(51,51,51,0.3)] backdrop-blur-[10px] w-fit px-[1px]",style:{border:"0.5px solid rgba(255, 255, 255, 0.1)"},children:[(0,h.jsx)("div",{className:A().actionImage,onClick:t=>{t.stopPropagation(),eo(e)},children:1===e.collected?(0,h.jsx)(e5.Z,{}):(0,h.jsx)(e7.Z,{})}),(0,h.jsx)(ee.o,{fileUrl:null==e?void 0:e.imageUrl,originalImageUrl:null==e?void 0:e.originalImageUrl,mediaType:1,className:A().actionImage,iconSize:16,children:(0,h.jsx)("div",{className:A().actionImage,onClick:t=>{t.stopPropagation(),m({e:"lib.image.editor.download",t:2,var:{image_uuid:e.id,generate_id:e.generateId}}),er(e)},children:(0,h.jsx)(_.J,{class:"icon-lib3-down",fontSize:16})})}),(0,h.jsx)("div",{className:A().actionImage,onClick:t=>{t.stopPropagation(),Q(e)},children:(0,h.jsx)(W,{})}),(0,h.jsx)("div",{className:A().actionImage,onClick:t=>{t.stopPropagation(),tl({title:"确定删除选中的图片吗？",content:"删除后无法恢复",okText:"确定",cancelText:"取消",centered:!0,autoFocusButton:null,onOk(){K(e)}})},children:(0,h.jsx)(_.J,{className:"icon-border_delete",fontSize:16})})]}),(0,h.jsxs)("div",{className:"flex absolute right-2 bottom-2 justify-end items-center gap-[2px] h-[29px] rounded-lg bg-[rgba(51,51,51,0.3)] backdrop-blur-[10px] w-fit px-[1px]",style:{border:"0.5px solid rgba(255, 255, 255, 0.1)"},onClick:e=>{e.stopPropagation(),e.preventDefault()},children:[(0,h.jsx)(ti,{icon:(0,h.jsx)(G.Z,{}),text:"高清放大",onClick:i=>{el||(H(e,t),(0,eV.ae)({toolImageMode:"imageEnlargement"}))},disabledText:el}),(0,h.jsx)(ti,{icon:(0,h.jsx)(e8,{}),text:"作为参考图",onClick:()=>ea(e)})]})]})]}),!p&&i&&r&&s.length>1&&(0,h.jsx)("div",{className:"pt-3 text-right absolute right-0",children:(0,h.jsx)($,{isGenerating:!1})})]},t)})}),(0,h.jsx)(F.Z,{visible:T.visible,x:T.x,y:T.y,onDownload:ei,onClose:et,onShare:()=>{T.item&&Q(T.item),et()},downloadText:"下载图片",shareText:"分享图片",downloadProps:T.item?{fileUrl:T.item.imageUrl,originalImageUrl:T.item.originalImageUrl,mediaType:1,fileName:"image.png",reportData:{event:"lib.image.editor.download",type:2,vars:{image_uuid:T.item.id,generate_id:T.item.generateId},onReport:m}}:void 0})]})},{confirm:tr}=y.default,tn=e=>{var t,i,l,a,o,r,n,s,d,c,u,m,p,v,g,b,j,y;let{imageItem:I,index:k,data:D,handleImageClickUpload:P,deleteImage:E,setHistoryList:V,scrollToBottom:z,isTemplate:R=!1}=e,F=(null==I?void 0:null===(l=I.images)||void 0===l?void 0:null===(i=l[0])||void 0===i?void 0:null===(t=i.param)||void 0===t?void 0:t.originalPrompt)||"",G=null,H=null,W=[],B=[],Y=[],q=null,Q=(null==I?void 0:I.generateType)===f.MB,J=(null==I?void 0:I.taskParam)?JSON.parse(null==I?void 0:I.taskParam):{},K=null==J?void 0:null===(a=J.frontCustomerReq)||void 0===a?void 0:a.overallStore,X=[],$=null,{colorScheme:ee}=(0,eu.X)(),et="dark"===ee,{isMobile:ei}=(0,L.z9)(),el=(0,eV.uA)("additionalNetwork"),eo=(0,C.T4)(),{setShowFullGenerator:es,simpleGeneratorType:ed}=(0,O.j)(),{changeEditorMediaType:ec}=(0,e0.N)(),em=(0,eV.uA)("generatorData"),ep=(0,x.useCallback)(e=>{(0,eV.ae)({generatorData:{...(0,eV.p4)().generatorData,...e}})},[]);try{let e=(0,eE.qi)(K.generatorData.checkpointId,K.generatorData.baseType,(0,eV.p4)().supportModelList||[]),t=R?K.generalImages:(0,eU.cu)(e?K.generalImages:K.referenceList);if(Q&&(t=K.generalImages),K.generatorData.baseType!==f.q2.Midjourney||(null===(v=t)||void 0===v?void 0:v.length)||(t=(0,e1.B1)(K.generalImages)),K)switch([{items:t,urlField:"url"}].forEach(e=>{let{items:t,urlField:i}=e;if(Array.isArray(t)){let e=t.map(e=>({url:(null==e?void 0:e[i])||(null==e?void 0:e.imageUrl),label:(null==e?void 0:e.label)||"参考图",item:e})).filter(e=>!!e.url);X.push(...e)}}),G=(null===(g=K.generatorData)||void 0===g?void 0:g.modelName)||null,H=(null===(b=K.generatorData)||void 0===b?void 0:b.baseType)||null,W=K.additionalNetwork||[],B=K.imageStyleList||[],Y=K.templateList||[],q=K.templateInfo||null,null===(j=K.generatorData)||void 0===j?void 0:j.scale){case"custom":$="自定义比例";break;case"auto":case"adaptive":$="智能匹配";break;default:$=(null===(y=K.generatorData)||void 0===y?void 0:y.scale)||null}}catch(e){console.warn("解析任务参数失败:",e)}let ev=D.length-1===k,eg=e=>{let t=-1!==ea.v4.findIndex(t=>{var i;return null==e?void 0:null===(i=e.imageUrl)||void 0===i?void 0:i.includes(t)}),i=(0,er.sz)(e.url||e.imageUrl,80);return(0,h.jsx)(Z.default,{color:et?"#303030":"",placement:"top",title:"图片模型 权重：".concat(e.weight),children:(0,h.jsxs)("div",{className:"".concat(A().mixModelName," !pl-[2px] relative cursor-pointer flex-shrink-0"),onClick:()=>{var t,i;let l=(null===(i=f.rs)||void 0===i?void 0:null===(t=i[K.generatorData.baseType])||void 0===t?void 0:t.imageStyleMax)||1,a=new Map,o={...e},r=o.uuid;r&&a.set(r,o),el.forEach(e=>{let t=e.uuid;t&&!a.has(t)&&a.set(t,e)}),ed!==f.oZ.IMAGE&&ec(f.oZ.IMAGE),es(!0),ep({baseType:K.generatorData.baseType,checkpointId:K.generatorData.checkpointId}),(0,eV.ae)({additionalNetwork:Array.from(a.values()).splice(0,l),imageStyleList:[],templateList:[]})},children:[(0,h.jsx)("img",{src:"".concat(e.url||e.imageUrl?i:"").concat(t?"?x-oss-process=video/snapshot,t_0,f_jpg,m_fast":"","  "),className:"w-[24px] h-[24px] object-cover rounded-full"}),(0,h.jsx)("span",{className:"max-w-[130px] truncate",children:(null==e?void 0:e.name)||(null==e?void 0:e.modelName)}),(0,h.jsx)("span",{className:"absolute top-[2px] left- w-[24px] h-[24px] bg-[#000]/30 rounded-full text-center text-[12px] text-white leading-[24px]",children:e.weight})]},e.url||e.imageUrl)},e.url||e.imageUrl)},eh=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=(0,er.sz)(e.url||e.imageUrl,80);return(0,h.jsx)(Z.default,{placement:"top",title:t?"图片模版":"图像风格",children:(0,h.jsxs)("div",{className:"".concat(A().mixModelName," cursor-pointer flex-shrink-0"),onClick:()=>{ed!==f.oZ.IMAGE&&ec(f.oZ.IMAGE),t&&ex(e),es(!0),ep({baseType:K.generatorData.baseType,checkpointId:K.generatorData.checkpointId});let i={additionalNetwork:[]};t?i.templateList=[{...e}]:i.imageStyleList=[{...e}],(0,eV.ae)(i)},children:[(0,h.jsx)("img",{src:i,className:"w-[24px] h-[24px] object-cover rounded-full"}),e.name||(null==e?void 0:e.modelName)]})},e.url||e.imageUrl)},{setTemplateConfig:ex}=(0,e2.e)({updateGeneratorData:ep,setConfig:e3.TU});return(0,h.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,h.jsxs)("div",{className:"flex flex-col gap-3",children:[!Q&&(0,h.jsxs)("div",{className:"flex items-end justify-between gap-3",children:[X.length>0?(0,h.jsx)(en,{modelImages:X,onImageClick:e=>{let t={width:e.item.width,height:e.item.height,url:e.item.originalImageUrl||e.item.url,referenceImage:e.item.originalImageUrl||e.item.url};P(t,!0)}}):null,F.length>0?(0,h.jsx)(eQ,{promptText:F,handleUsePrompt:e=>{ed!==f.oZ.IMAGE?(0,ez.setVideoGeneratorState)({generatorData:{...(0,ez.getVideoGeneratorState)().generatorData,prompt:e}}):ep({prompt:e})}}):null]}),(0,h.jsx)("div",{className:"flex-1 relative",children:(0,h.jsxs)("div",{className:"flex gap-2 overflow-x-auto flex-1 min-w-0 hide-scrollbar",children:[(0,h.jsx)(eG,{modelName:G,isHD:Q,handleClickModelName:()=>{ed!==f.oZ.IMAGE&&ec(f.oZ.IMAGE),es(!0);let{frontCustomerReq:e}=J,{overallStore:t}=e;ep({...t.generatorData,prompt:em.prompt}),(0,eV.ae)({additionalNetwork:[],imageStyleList:[]})},baseType:H,hdImageUrl:null==X?void 0:null===(o=X[0])||void 0===o?void 0:o.url}),W.length>0?W.map(e=>eg(e)):null,B.length>0?B.map(e=>eh(e)):null,Y.length>0?Y.map(e=>eh(e,!0)):null,(null==I?void 0:null===(n=I.images)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:r.width)?(0,h.jsxs)("span",{className:A().size,children:[null==I?void 0:null===(d=I.images)||void 0===d?void 0:null===(s=d[0])||void 0===s?void 0:s.width,"*",null==I?void 0:null===(u=I.images)||void 0===u?void 0:null===(c=u[0])||void 0===c?void 0:c.height]}):null,$?(0,h.jsx)("span",{className:A().size,children:$}):null,R&&q&&(0,h.jsx)(eJ,{title:null===(m=q)||void 0===m?void 0:m.title,content:null===(p=q)||void 0===p?void 0:p.styleDescription})]})})]}),(0,h.jsx)(to,{list:null==I?void 0:I.images,genData:I,id:null==I?void 0:I.id,setHistoryList:V,historyList:D,isLastTask:ev,isTemplate:R}),(0,h.jsxs)("div",{className:"".concat(A().action),children:[!Q&&(0,h.jsxs)("div",{className:"".concat(A().actionSpan),onClick:()=>{var e,t,i,l;let{frontCustomerReq:a}=J,{overallStore:o}=a,{generatorData:r,generalImages:n,referenceList:s}=o;r.baseType===f.q2.Midjourney&&n.length&&s&&(o.referenceList=(0,e1.B1)(n)),ex((null==o?void 0:null===(e=o.templateList)||void 0===e?void 0:e[0])||{}),(0,eV.ae)({...o}),ed!==f.oZ.IMAGE&&ec(f.oZ.IMAGE),es(!0),eo({e:"lib.image.editor.reconfig",t:2,var:{generate_id:I.id,prompt:J.originalPrompt,ckp_model_name:J.checkPointName,ckp_model_uuid:J.checkPointModelId,ckp_version_uuid:J.checkPointModelUuid,lora_list:null==o?void 0:null===(t=o.additionalNetwork)||void 0===t?void 0:t.map(e=>({lora_name:e.name,lora_model_uuid:e.uuid,lora_version_uuid:e.versionId})),img_size:null==o?void 0:null===(i=o.generatorData)||void 0===i?void 0:i.scale,img_cnt:null==o?void 0:null===(l=o.generatorData)||void 0===l?void 0:l.count}})},children:[(0,h.jsx)(M,{}),(0,h.jsx)("span",{children:"重新编辑"})]}),(0,h.jsxs)("div",{className:"".concat(A().actionSpan),onClick:()=>{var e,t,i,l;(0,eO.qJ)(J);let{frontCustomerReq:a}=J,{overallStore:o}=a;eo({e:"lib.image.editor.regen",t:2,var:{generate_id:I.id,prompt:J.originalPrompt,ckp_model_name:J.checkPointName,ckp_model_uuid:J.checkPointModelId,ckp_version_uuid:J.checkPointModelUuid,lora_list:null==o?void 0:null===(e=o.additionalNetwork)||void 0===e?void 0:e.map(e=>({lora_name:e.name,lora_model_uuid:e.uuid,lora_version_uuid:e.versionId})),img_size:null==o?void 0:null===(t=o.generatorData)||void 0===t?void 0:t.scale,img_cnt:null==o?void 0:null===(i=o.generatorData)||void 0===i?void 0:i.count,sd_priority:(null==o?void 0:null===(l=o.generatorData)||void 0===l?void 0:l.taskQueuePriority)===1?"low":"high"}}),z()},children:[(0,h.jsx)(S,{}),(0,h.jsx)("span",{children:"再次生成"})]}),(0,h.jsx)(N.default,{arrow:!1,placement:"right",content:(0,h.jsxs)("div",{className:"".concat(A().deleteAction),onClick:()=>{tr({title:"确定删除吗？",content:"删除后无法恢复",okText:"确定",cancelText:"取消",centered:!0,autoFocusButton:null,onOk(){var e;U.p1.deleteTask({generateId:I.id}).then(e=>{(null==e?void 0:e.code)===0?(E(I.id),w.ZP.success("删除成功")):w.ZP.warning("删除失败！")}),eo({e:"lib.editor.delete.batch",t:2,var:{image_id_list:null==I?void 0:null===(e=I.images)||void 0===e?void 0:e.map(e=>e.id)}})}})},children:[(0,h.jsx)(_.J,{className:"".concat(A().actionTxt," icon-lib3-del"),fontSize:14}),(0,h.jsx)("span",{children:"删除该条记录"})]}),trigger:"click",classNames:{body:"!p-1 !rounded-[8px]"},children:(0,h.jsx)("span",{className:"".concat(A().actionSpan," b768:w-[32px] w-[28px]"),children:(0,h.jsx)(T,{})})})]})]},"".concat(I.id))},ts=e=>!!e&&e.includes("_lib_upscaled");var td=e=>{let{list:t,updateList:i,id:l,genData:a,setHistoryList:o,historyList:r,isLastTask:n}=e,[s,d]=(0,x.useState)([]),[c,u]=(0,x.useState)(!1),[m,p]=(0,x.useState)(""),v=(0,x.useRef)({}),{isMobile:g}=(0,L.z9)(),{handleDownload:f}=(0,ef.Ag)({isTeam:!1}),[b,j]=(0,x.useState)({visible:!1,x:0,y:0,item:null});(0,x.useEffect)(()=>{d(t)},[t]);let y=(0,x.useMemo)(()=>{if(!(null==a?void 0:a.taskParam))return null;try{let e=JSON.parse(null==a?void 0:a.taskParam);return e}catch(e){return null}},[null==a?void 0:a.genData]),I=e=>(0,er.sz)(e,640),T=e=>{if(!e)return!1;let t=(e=>{try{let t=e.replace(/\/+$/,""),i=t.split(/[#?]/)[0],l=i.match(/\.([a-z0-9]+)$/i);return l?l[1].toLowerCase():""}catch(e){return""}})(e);return!!["jpg","jpeg","png","gif","webp","bmp","svg"].includes(t)||(["mp4","mov","avi","mkv","webm","m4v","flv","wmv"].includes(t),!1)},k=(0,x.useCallback)((e,t)=>{g||(0,B.qb)({editorDetailData:{...e,paramsData:y},editorDetailModalOpen:!0,editorDetailFrom:"history",editorIndex:t,editorId:a.id})},[g,c,m]),M=async e=>{let t=await U.p1.detectMedia({sourceHttpUrl:e});return t},D=async e=>{if(ts(e.originalVideoUrl)){let t=(null==e?void 0:e.taskParam)?JSON.parse(null==e?void 0:e.taskParam):{},i=(null==t?void 0:t.geniusPayload)?JSON.parse(null==t?void 0:t.geniusPayload):{},l=null==i?void 0:i.api_version,a=null==i?void 0:i.target_resolution;"normal"===l?p("已完成视频高清处理（极速，".concat(a,"）")):p("已完成视频高清处理（专业，".concat(a,"）")),u(!0)}else{let t=await M(e.originalVideoUrl);if(null==t?void 0:t.data){let{duration:e,size:i}=t.data;if(i&&i>104857600){p("暂仅支持100MB以内的视频"),u(!0);return}if(e&&e>600){p("暂不支持10分钟以上的视频"),u(!0);return}u(!1),p("")}}if(!T(null==e?void 0:e.videoUrl)){let t=v.current[e.id];t&&t.play().catch(e=>{console.warn("视频自动播放失败:",e)})}},S=e=>{if(u(!1),p(""),!T(null==e?void 0:e.videoUrl)){let t=v.current[e.id];t&&(t.pause(),t.currentTime=0,t.muted=!0)}},O=(e,t)=>{e.preventDefault(),e.stopPropagation(),j({visible:!0,x:e.clientX,y:e.clientY,item:t})},P=()=>{j({visible:!1,x:0,y:0,item:null})},E=async()=>{b.item&&(z({e:"lib.video.editor.download",t:2,var:{video_uuid:b.item.id,generate_id:b.item.generateId}}),await q(b.item)),P()},V=async e=>{z({e:"lib.video.editor.share",t:2,var:{image_uuid:e.id,generate_id:e.generateId}});try{let t=(0,Y.UV)("showShareVideoModal");t([{createTime:e.createTime,generateId:e.generateId,height:e.height,id:e.id,imageUrl:e.coverPathUrl||"",ossId:e.originalVideoUrl,width:e.width}])}catch(e){console.error("分享视频失败",e)}},z=(0,C.T4)(),R=(e,t)=>(0,h.jsxs)("div",{className:"w-[248px] cursor-pointer",onClick:()=>{c||(z({e:"lib.video.editor.hd_panel.click",t:2,var:{}}),(0,B.qb)({isVideoEdit:!0}),k(e,t))},children:[(0,h.jsx)("div",{className:"w-[248px] h-[100px] rounded-lg overflow-hidden",children:(0,h.jsx)("img",{src:"https://liblibai-online.liblib.cloud/web/ef0097ae9da74189a0f5d604e98c77cd/86890f94-1b6d-447a-b7c1-11e192b519bd.gif",className:"w-full h-full object-cover"})}),(0,h.jsx)("div",{className:"text-[12px] font-medium text-[#0D0D0D] leading-[16px] pt-[16px] dark:text-[#fff]",children:"视频高清"}),(0,h.jsx)("p",{className:"text-[12px] text-[#4A535F] leading-[18px] py-[8px] dark:text-[#fff]",children:"智能提升视频分辨率,完美保留视频艺术效果,精美还原视频细节。"}),(0,h.jsx)("button",{className:A().actionButton,children:"立即体验"})]}),H=async e=>{try{let t=1===e.collected?0:1,i=await U.p1.collectEditorVideo({idList:[e.editorVideoId],collected:t,bizType:22});if((null==i?void 0:i.code)===0&&(w.ZP.success(1===e.collected?"取消收藏成功":"收藏成功"),o&&Array.isArray(r))){let i=r.map(i=>{if(i.id===l){var a;return{...i,videos:(null===(a=i.videos)||void 0===a?void 0:a.map(i=>i.editorVideoId===e.editorVideoId?{...i,collected:t}:i))||[]}}return i});o(e=>[...i])}}catch(e){console.error("收藏视频失败:",e),w.ZP.error("收藏视频时发生错误")}},q=async e=>{await f({originalImageUrl:null==e?void 0:e.originalVideoUrl,fileUrl:null==e?void 0:e.videoUrl,imageUrl:null==e?void 0:e.videoUrl})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("ul",{className:A().videoImgRow,children:null==s?void 0:s.slice(Math.max(s.length-1,0)).map((e,t)=>(0,h.jsxs)("li",{className:"group ".concat(A().videoImageCard),onContextMenu:e=>{e.preventDefault(),e.stopPropagation()},children:[T(null==e?void 0:e.videoUrl)?(0,h.jsx)("img",{src:I(null==e?void 0:e.videoUrl),className:A().imageContent,alt:"违规内容已被过滤"}):(0,h.jsxs)("div",{className:"".concat(A().tagWrapper),onMouseEnter:()=>D(e),onMouseLeave:()=>S(e),children:[(0,h.jsx)("img",{src:I(null==e?void 0:e.coverPathUrl),onClick:()=>{k(e,t)},onContextMenu:t=>O(t,e)}),(0,h.jsx)("video",{preload:"metadata",disablePictureInPicture:!0,ref:t=>{t&&(0,Q.Kz)(t),v.current[e.id]=t},src:null==e?void 0:e.videoUrl,poster:I("".concat(null==e?void 0:e.videoUrl,"?x-oss-process=video/snapshot,t_0,f_jpg,m_fast")),className:A().videoContent,controls:!0,loop:!0,muted:!0,controlsList:"nodownload noremoteplayback",onClick:()=>{k(e,t)},onContextMenu:t=>O(t,e),...(0,Q.SW)()}),(0,h.jsx)("div",{className:A().hoverCover,children:(0,h.jsx)("div",{className:"flex absolute left-[0px] top-[0px] justify-end gap-[0px] w-full h-[72px] rounded-t-lg px-[8px] py-[8px]",style:{background:"linear-gradient(0deg, rgba(0, 0, 0, 0.00) 7.39%, rgba(0, 0, 0, 0.80) 100%)"},children:(0,h.jsxs)("div",{className:A().iconWrapper,children:[(0,h.jsx)("div",{className:A().actionImage,onClick:()=>H(e),children:1===e.collected?(0,h.jsx)(e5.Z,{}):(0,h.jsx)(e7.Z,{})}),c?(0,h.jsx)(Z.default,{title:m,children:(0,h.jsx)("button",{disabled:c,className:"".concat(A().actionImage," ").concat(c?"opacity-50 cursor-not-allowed":""),children:(0,h.jsx)(G.Z,{})})}):(0,h.jsx)(N.default,{placement:"bottom",content:R(e,t),arrow:!1,zIndex:200,onOpenChange:e=>{e&&z({e:"lib.video.editor.hd_panel.show",t:2,var:{}})},children:(0,h.jsx)("button",{onClick:()=>{c||((0,B.qb)({isVideoEdit:!0}),k(e,t))},className:"".concat(A().actionImage," ").concat(c?"opacity-50 cursor-not-allowed":""),children:(0,h.jsx)(G.Z,{})})}),(0,h.jsx)(ee.o,{fileUrl:null==e?void 0:e.videoUrl,originalImageUrl:null==e?void 0:e.originalVideoUrl,mediaType:2,fileName:"video.mp4",className:A().actionImage,iconSize:16,children:(0,h.jsx)("div",{className:A().actionImage,onClick:t=>{t.stopPropagation(),z({e:"lib.video.editor.download",t:2,var:{video_uuid:e.id,generate_id:e.generateId}}),q(e)},children:(0,h.jsx)(_.J,{class:"icon-lib3-down",fontSize:16})})}),(0,h.jsx)("div",{className:A().actionImage,onClick:()=>V(e),children:(0,h.jsx)(W,{})})]})})})]}),!g&&0==t&&n&&(0,h.jsx)("div",{className:"pt-3 text-right absolute right-0",children:(0,h.jsx)($,{isGenerating:!1})})]},e.id))}),(0,h.jsx)(F.Z,{visible:b.visible,x:b.x,y:b.y,onClose:P,onDownload:E,onShare:()=>{b.item&&V(b.item),P()},downloadText:"下载视频",shareText:"分享视频",downloadProps:b.item?{fileUrl:b.item.videoUrl,originalImageUrl:b.item.originalVideoUrl,mediaType:2,fileName:"video.mp4",reportData:{event:"lib.video.editor.download",type:2,vars:{video_uuid:b.item.id,generate_id:b.item.generateId},onReport:z}}:void 0})]})};let{confirm:tc}=y.default,tu=eI.tY();var tm=e=>{var t,i,l,a,o,r,n,s,d,c,u,m,p,v,g,b;let{videoItem:j,index:y,data:I,setHistoryList:k,deleteImage:D,scrollToBottom:P}=e,{changeEditorMediaType:E}=(0,e0.N)(),V=(null==j?void 0:null===(l=j.videos)||void 0===l?void 0:null===(i=l[0])||void 0===i?void 0:null===(t=i.param)||void 0===t?void 0:t.originalPrompt)||"",z=null,R=null,F=(null==j?void 0:j.taskParam)?JSON.parse(null==j?void 0:j.taskParam):{},G=[],H=null,W=[],B=null,{isMobile:Y}=(0,L.z9)(),{colorScheme:K}=(0,eu.X)(),X="dark"===K;null==j||null===(o=j.videos)||void 0===o||null===(a=o[0])||void 0===a||a.originalVideoUrl;let $=null==F?void 0:null===(r=F.frontCustomerReq)||void 0===r?void 0:r.overallStore,ee=(null==F?void 0:F.geniusPayload)?JSON.parse(null==F?void 0:F.geniusPayload):{},et=(0,C.T4)(),{setShowFullGenerator:ei,simpleGeneratorType:el}=(0,O.j)(),eo=(0,ez.useVideoGeneratorState)("generatorData");(0,eR.useWatermarkSettingState)("removeWatermark");let{isVip:es}=(0,eA.RR)(),ed=(0,x.useCallback)(e=>{(0,ez.setVideoGeneratorState)({generatorData:{...(0,ez.getVideoGeneratorState)().generatorData,...e}})},[]);try{if($){let e=(0,eU.cu)($.referenceList),t=(0,eU.cu)($.referenceVideoList);if(Array.isArray(t)){let e=t.map(e=>{let t=(null==e?void 0:e.coverPathUrl)||(null==e?void 0:e.imageUrl)||(null==e?void 0:e.url);return(!t&&(null==e?void 0:e.videoUrl)||t&&(0,ea.NU)(t))&&(t=(0,ea.VP)(e.videoUrl||t)),t?{url:t,videoUrl:null==e?void 0:e.videoUrl,label:"参考视频",item:e}:null}).filter(e=>!!e);G.push(...e)}[{videoItems:e,urlField:"url"}].forEach(e=>{let{videoItems:t,urlField:i}=e;if(Array.isArray(t)){let e=t.map(e=>{var t;let l=(null===(t=f.r2)||void 0===t?void 0:t[null==e?void 0:e.referenceType])||"参考图";return{url:null==e?void 0:e[i],label:l,item:e}}).filter(e=>!!e.url);G.push(...e)}}),z=(null===(p=$.generatorData)||void 0===p?void 0:p.modelName)||null,H=(null===(v=$.generatorData)||void 0===v?void 0:v.duration)||null,R=(null===(g=$.generatorData)||void 0===g?void 0:g.modelKey)||null,W=$.videoEffectList||[],B=e.length>0?"智能匹配":(null===(b=$.generatorData)||void 0===b?void 0:b.ratio)||null}}catch(e){console.warn("解析任务参数失败:",e)}let ec=(e,t)=>{let i=-1!==ea.v4.findIndex(t=>{var i;return null==e?void 0:null===(i=e.imageUrl)||void 0===i?void 0:i.includes(t)}),l=(0,er.sz)(e.url||e.imageUrl,80);return(0,h.jsx)(Z.default,{color:X?"#303030":"",placement:"top",title:"视频特效",children:(0,h.jsx)("div",{className:"".concat(A().imgModel," !pl-[2px] relative cursor-pointer flex-shrink-0"),children:(0,h.jsxs)("div",{className:"".concat(A().mixModelName," !pl-[2px] relative cursor-pointer"),onClick:()=>{el!==f.oZ.VIDEO&&E(f.oZ.VIDEO),ei(!0),ed({...t.generatorData,prompt:eo.prompt}),(0,ez.setVideoGeneratorState)({videoEffectList:t.videoEffectList})},children:[i?(0,h.jsx)(h.Fragment,{children:e.webpUrl?(0,h.jsx)("img",{src:e.webpUrl,className:"w-[24px] h-[24px] object-cover rounded-full"}):(0,h.jsx)("video",{disablePictureInPicture:!0,loop:!0,muted:!0,autoPlay:!0,preload:"none",src:"".concat(e.url||e.imageUrl," "),className:"w-[24px] h-[24px] object-cover rounded-full",...(0,Q.SW)()})}):(0,h.jsx)("img",{src:"".concat(e.url||e.imageUrl?l:""," ").concat(i?"?x-oss-process=video/snapshot,t_0,f_jpg,m_fast":"","  "),className:"w-[24px] h-[24px] object-cover rounded-full"}),(0,h.jsx)("span",{className:"max-w-[180px] truncate",children:e.name}),(0,h.jsx)("span",{className:"absolute top-[2px] left- w-[24px] h-[24px] bg-[#000]/30 rounded-full text-center text-[12px] text-white leading-[24px]",children:e.weight})]})},"".concat(e.url||e.imageUrl))},"".concat(e.url||e.imageUrl))};return(0,h.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,h.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,h.jsxs)("div",{className:"flex items-end justify-between gap-3",children:[G.length>0&&j.generateType!==f.X9?(0,h.jsx)(en,{modelImages:G}):null,V.length>0&&j.generateType!==f.X9?(0,h.jsx)(eQ,{promptText:V,handleUsePrompt:e=>{el===f.oZ.VIDEO?ed({prompt:e}):(0,eV.ae)({generatorData:{...(0,eV.p4)().generatorData,prompt:e}})}}):null]}),(0,h.jsx)("div",{className:"flex-1 relative",children:(0,h.jsxs)("div",{className:"flex gap-2 overflow-x-auto flex-1 min-w-0 hide-scrollbar",children:[(0,h.jsx)(eG,{modelName:z,isHD:j.generateType===f.X9,handleClickModelName:()=>{el!==f.oZ.VIDEO&&E(f.oZ.VIDEO);let{frontCustomerReq:e}=F,{overallStore:t}=e;ed({...t.generatorData,prompt:eo.prompt}),(0,ez.setVideoGeneratorState)({videoEffectList:[]}),ei(!0)},baseType:R,hdImageUrl:(0,ea.VP)((null==ee?void 0:ee.video_url)||""),mediaType:f.oZ.VIDEO}),W.length>0&&j.generateType!==f.X9?W.map(e=>ec(e,$)):null,(null==j?void 0:null===(s=j.videos)||void 0===s?void 0:null===(n=s[0])||void 0===n?void 0:n.width)?(0,h.jsxs)("span",{className:A().size,children:[null==j?void 0:null===(c=j.videos)||void 0===c?void 0:null===(d=c[0])||void 0===d?void 0:d.width,"*",null==j?void 0:null===(m=j.videos)||void 0===m?void 0:null===(u=m[0])||void 0===u?void 0:u.height]}):null,B?(0,h.jsx)("span",{className:A().size,children:B}):null,(0,h.jsxs)("span",{className:A().size,children:[(0,h.jsx)(eC,{fontSize:14,className:"mr-[2px]"}),H?(0,h.jsxs)("span",{children:[H,"s"]}):null]})]})})]}),(0,h.jsx)(td,{list:null==j?void 0:j.videos,genData:j,id:j.id,isLastTask:y===I.length-1,setHistoryList:k,historyList:I}),(0,h.jsxs)("div",{className:A().action,children:[j.generateType!==f.X9?(0,h.jsxs)("span",{className:"".concat(A().actionSpan),onClick:()=>{var e;let{frontCustomerReq:t}=F,{overallStore:i}=t,{generatorData:l}=i,a="";null==i||null===(e=i.videoEffectList)||void 0===e||e.forEach(e=>{var t;if(a=e.name,null===(t=e.templateInfo)||void 0===t?void 0:t.length){let{storeConfig:t,pageConfig:i}=(0,eU.Du)({templateInfo:e.templateInfo,callbacks:{setVideoGeneratorState:ez.setVideoGeneratorState}});(0,e3.zV)(i),Object.keys(t).length>0&&ed(t)}}),el!==f.oZ.VIDEO&&E(f.oZ.VIDEO),ei(!0),i&&(0,ez.setVideoGeneratorState)({...i}),et({e:"lib.video.editor.reconfig",t:2,var:{generate_id:j.id,prompt:l.prompt,ckp_model_name:l.modelName,ckp_model_uuid:l.checkpointId,video_size:l.ratio,duration:l.duration,resolution:l.resolution,sd_priority:1===l.taskQueuePriority?"low":"high",video_effect_name:a,sd_param:JSON.stringify(l)}})},children:[(0,h.jsx)(M,{}),(0,h.jsx)("span",{children:"重新编辑"})]}):null,(0,h.jsxs)("span",{className:"".concat(A().actionSpan),onClick:()=>{var e;(0,eP.GY)(F);let{frontCustomerReq:t}=F,{overallStore:i}=t,{generatorData:l}=i,a="";null==i||null===(e=i.videoEffectList)||void 0===e||e.forEach(e=>{a=e.name}),et({e:"lib.video.editor.regen",t:2,var:{generate_id:j.id,prompt:l.prompt,ckp_model_name:l.modelName,ckp_model_uuid:l.checkpointId,video_size:l.ratio,duration:l.duration,resolution:l.resolution,sd_priority:1===l.taskQueuePriority?"low":"high",video_effect_name:a,sd_param:JSON.stringify(l)}}),P()},children:[(0,h.jsx)(S,{}),(0,h.jsx)("span",{children:"再次生成"})]}),Y&&(0,h.jsxs)("div",{className:"".concat(A().actionSpan),onClick:async()=>{var e;let t;let i=null==j?void 0:null===(e=j.videos)||void 0===e?void 0:e[0];et({e:"lib.video.editor.download",t:2,var:{video_uuid:i.id,generate_id:i.generateId}});let l="true"===localStorage.getItem("removeWatermark");if(l&&es)t=null==i?void 0:i.originalVideoUrl;else{let{downloadUrl:e}=await (0,J.aj)({fileUrl:null==i?void 0:i.originalVideoUrl,mediaType:2,needAiWaterMark:!l});t=e||(null==i?void 0:i.originalVideoUrl)}tu?(await eI.Rr(t),w.ZP.success("视频已保存到相册")):(0,q.ZP)(t)},children:[(0,h.jsx)(_.J,{class:"icon-lib3-down",fontSize:14}),(0,h.jsx)("span",{children:"下载"})]}),(0,h.jsx)(N.default,{arrow:!1,placement:"right",classNames:{body:"!p-1 !rounded-[8px]"},content:(0,h.jsxs)("span",{className:"".concat(A().deleteAction),onClick:()=>{tc({title:"确定删除吗？",content:"删除后无法恢复",okText:"确定",cancelText:"取消",centered:!0,autoFocusButton:null,onOk(){var e;let t=null==j?void 0:null===(e=j.videos)||void 0===e?void 0:e[0];et({e:"lib.video.editor.delete",t:2,var:{image_uuid:t.id,generate_id:t.generateId}}),U.p1.deleteTask({generateId:j.id}).then(e=>{(null==e?void 0:e.code)===0?(D(j.id),w.ZP.success("删除成功")):w.ZP.warning("删除失败！")})}})},children:[(0,h.jsx)(_.J,{className:"".concat(A().actionTxt," icon-lib3-del"),fontSize:14}),(0,h.jsx)("span",{children:"删除该条记录"})]}),trigger:"click",children:(0,h.jsx)("span",{className:"".concat(A().actionSpan," b768:w-[32px] w-[28px]"),children:(0,h.jsx)(T,{})})})]})]},"".concat(j.id))},tp=e=>{let{data:t,getHistoryList:i,setHistoryList:l,tasks:a,curGenerateType:o,isTemplate:r=!1}=e,n=(0,x.useRef)(null),{handleImageClick:s}=(0,b.i)();(0,x.useEffect)(()=>{a.length>0&&(0,j.DF)()},[a.length]);let d=()=>{n.current&&setTimeout(()=>{var e;null===(e=n.current)||void 0===e||e.scrollIntoView({behavior:"auto"})},100)};(0,x.useLayoutEffect)(()=>{(null==t?void 0:t.length)&&d()},[]);let c=(0,x.useCallback)(e=>{null==l||l(t.filter(t=>t.id!==e))},[t,l]),u=e=>e!==o&&0!=o,m={[f.MR]:f.oZ.IMAGE,[f.iC]:f.oZ.VIDEO,[f.nY]:f.oZ.DIGITAL_HUMAN,[f.Aw]:f.oZ.ACTION_FOLLOW},p=(e,i)=>(0,h.jsx)(tn,{imageItem:e,index:i,data:t,handleImageClickUpload:s,deleteImage:c,setHistoryList:l,scrollToBottom:d,isTemplate:r},e.id),v=(e,i)=>(0,h.jsx)(ey,{videoItem:e,index:i,data:t,deleteImage:c,setHistoryList:l},e.id),g=(e,i)=>(0,h.jsx)(tm,{videoItem:e,index:i,data:t,deleteImage:c,setHistoryList:l,scrollToBottom:d},e.id),_=(e,i)=>(0,h.jsx)(ec,{videoItem:e,index:i,data:t,deleteImage:c},e.id),y=(e,t)=>{var i;return(null===(i=e.images)||void 0===i?void 0:i.length)>0?p(e,t):e.videos&&80===e.videos[0].generateType?v(e,t):e.videos&&81===e.videos[0].generateType?_(e,t):g(e,t)};return(0,h.jsxs)("div",{className:"max-w-[976px] mx-auto flex flex-col b768:gap-12 gap-8 w-full pt-4",children:[null==t?void 0:t.map((e,t)=>y(e,t)),a&&a.map(e=>{let t=(null==e?void 0:e.mediaType)?m[e.mediaType]:f.oZ.IMAGE;return(0,h.jsx)(e$,{task:e,getHistoryList:i,mediaType:t,isHiddenTask:u(null==e?void 0:e.mediaType),isTemplate:r},e.taskId)}),(0,h.jsx)("div",{ref:n})]})}},25620:function(e,t,i){"use strict";i.d(t,{$:function(){return r},H:function(){return n}});var l=i(41625),a=i(46792),o=i(7731);let r=e=>{if(e.generateType){var t,i,l,r,n,s,d,c,u,m;switch(e.generateType){case 11:(null===(t=e.img2VideoReqVO)||void 0===t?void 0:t.image)&&(0,a.setVideoGeneratorState)({generatorData:{...(0,a.getVideoGeneratorState)().generatorData,prompt:e.img2VideoReqVO.prompt||"",modelKey:e.img2VideoReqVO.modelName},videoEffectList:[]});break;case 29:e.text2VideoTongYi&&(0,a.setVideoGeneratorState)({generatorData:{...(0,a.getVideoGeneratorState)().generatorData,prompt:e.text2VideoTongYi.prompt+(e.text2VideoTongYi.negPrompt||""),modelKey:e.text2VideoTongYi.modelName},referenceList:[],videoEffectList:[]});break;case 30:(null===(i=e.img2VideoTongYi)||void 0===i?void 0:i.imageUrl)&&(0,a.setVideoGeneratorState)({generatorData:{...(0,a.getVideoGeneratorState)().generatorData,prompt:e.img2VideoTongYi.prompt+(e.img2VideoTongYi.negPrompt||""),modelKey:e.img2VideoTongYi.modelName},referenceList:[{url:e.img2VideoTongYi.imageUrl,originalImageUrl:e.img2VideoTongYi.imageUrl,imageUrl:null===(l=e.img2VideoTongYi)||void 0===l?void 0:l.imageUrl,width:e.img2VideoTongYi.width||1024,height:e.img2VideoTongYi.height||1024,enable:!0}],videoEffectList:[]});break;case 34:if(e.img2VideoKling){let t="";t="single",e.img2VideoKling.imageUrl&&e.img2VideoKling.imageUrl,(0,a.setVideoGeneratorState)({generatorData:{...(0,a.getVideoGeneratorState)().generatorData,imageType:t,prompt:e.img2VideoKling.prompt||"",modelKey:e.img2VideoKling.modelName},referenceList:e.img2VideoKling.imageUrl?[{url:e.img2VideoKling.imageUrl,originalImageUrl:e.img2VideoKling.imageUrl,imageUrl:e.img2VideoKling.imageUrl,width:(null===(r=e.img2VideoKling)||void 0===r?void 0:r.width)||1024,height:(null===(n=e.img2VideoKling)||void 0===n?void 0:n.height)||1024,enable:!0}]:[],videoEffectList:[]})}break;case 37:if(e.geniusPayload){let t=JSON.parse(e.geniusPayload);(0,a.setVideoGeneratorState)({generatorData:{...(0,a.getVideoGeneratorState)().generatorData,prompt:t.prompt||"",modelKey:t.model,ratio:(null===(s=t.selectRatio)||void 0===s?void 0:s.toString())||"",motionMode:t.movement_amplitude,style:t.style},referenceList:(t.images||[]).map(e=>({url:e,originalImageUrl:e,imageUrl:e,enable:!0})),videoEffectList:[]})}break;case 38:if(e.geniusPayload){let t=JSON.parse(e.geniusPayload),i="single";(null===(d=t.images)||void 0===d?void 0:d.length)===2?(i="tail",t.images[0],t.images[0],t.images[1]):(i="single",t.images[0]),(0,a.setVideoGeneratorState)({generatorData:{...(0,a.getVideoGeneratorState)().generatorData,prompt:t.prompt||"",modelKey:t.model,motionMode:t.movement_amplitude,duration:t.duration||5,imageType:i},referenceList:(t.images||[]).map(e=>({url:e,originalImageUrl:e,imageUrl:e,width:t.width||1024,height:t.height||1024,enable:!0})),videoEffectList:[]})}break;case 43:if(e.geniusPayload){let t=JSON.parse(e.geniusPayload),i="16:9",l=null==t?void 0:t.width,o=null==t?void 0:t.height,r={"1280x720":{selectRatio:0,aspectRatio:"16:9"},"720x1280":{selectRatio:1,aspectRatio:"9:16"},"960x960":{selectRatio:2,aspectRatio:"1:1"}}["".concat(l,"x").concat(o)];r&&r.aspectRatio&&(i=r.aspectRatio),(0,a.setVideoGeneratorState)({generatorData:{...(0,a.getVideoGeneratorState)().generatorData,prompt:t.prompt||"",modelKey:t.model,ratio:i,duration:t.duration||5},referenceList:(t.images||[]).map(e=>({url:e,originalImageUrl:e,imageUrl:e,enable:!0})),videoEffectList:[]})}break;case 44:if(e.geniusPayload){let t=JSON.parse(e.geniusPayload),i="";2===t.modeType?(null===(c=t.images)||void 0===c?void 0:c.length)===2?(i="tail",t.images[0],t.images[0],t.images[1]):(i="single",t.images[0]):(i="multi",t.images[0],t.images),(0,a.setVideoGeneratorState)({generatorData:{...(0,a.getVideoGeneratorState)().generatorData,imageType:i,prompt:t.prompt||"",modelKey:t.model,quality:"high"===t.quality?"high":"low",duration:t.duration||5},referenceList:(t.images||[]).map(e=>({url:e,originalImageUrl:e,imageUrl:e,width:t.width||768,height:t.height||768,enable:!0})),videoEffectList:[]})}break;case 47:if(e.geniusPayload){let t=JSON.parse(e.geniusPayload);(0,a.setVideoGeneratorState)({generatorData:{...(0,a.getVideoGeneratorState)().generatorData,prompt:t.prompt||"",modelKey:t.model,ratio:t.ratio||"",resolution:t.resolution||"",duration:t.duration||5},referenceList:(t.images||[]).map(e=>({url:e,originalImageUrl:e,imageUrl:e,width:t.sourceImageWidth||t.width||1024,height:t.sourceImageHeight||t.height||1024,enable:!0})),videoEffectList:[]})}break;case 48:if(e.geniusPayload){let t=JSON.parse(e.geniusPayload),i="single";(null===(u=t.images)||void 0===u?void 0:u.length)===2?(i="tail",t.images[0],t.images[0],t.images[1]):(i="single",t.images[0]),(0,a.setVideoGeneratorState)({generatorData:{...(0,a.getVideoGeneratorState)().generatorData,prompt:t.prompt||"",modelKey:o.Dp.Seedancev10Lite,imageType:i,resolution:t.resolution||"",duration:t.duration||5},referenceList:(t.images||[]).map(e=>({url:e,originalImageUrl:e,imageUrl:e,width:t.sourceImageWidth||t.width||1024,height:t.sourceImageHeight||t.height||1024,enable:!0})),videoEffectList:[]})}break;case 41:if(e.geniusPayload){let t=JSON.parse(e.geniusPayload);(0,a.setVideoGeneratorState)({generatorData:{...(0,a.getVideoGeneratorState)().generatorData,prompt:t.prompt||"",modelKey:t.model,resolution:t.resolution||"",duration:t.duration||5},referenceList:(t.images||[]).map(e=>({url:e,originalImageUrl:e,imageUrl:e,width:t.sourceImageWidth||t.width||1024,height:t.sourceImageHeight||t.height||1024,enable:!0})),videoEffectList:[]})}break;case 42:if(e.geniusPayload){let t=JSON.parse(e.geniusPayload);(null===(m=t.images)||void 0===m?void 0:m.length)===2?(t.images[0],t.images[0],t.images[1]):t.images[0],(0,a.setVideoGeneratorState)({generatorData:{...(0,a.getVideoGeneratorState)().generatorData,prompt:t.prompt||"",modelKey:t.model,imageType:t.imageType||"",resolution:t.resolution||"",duration:t.duration||5},referenceList:(t.images||[]).map(e=>({url:e,originalImageUrl:e,imageUrl:e,width:t.width||768,height:t.height||768,enable:!0})),videoEffectList:[]})}}}},n=async e=>{if(!e)return;let t=await (0,l.Ci)(e);if(t)try{let e=JSON.parse(t),{frontCustomerReq:i}=e;(null==i?void 0:i.overallStore)?(0,a.setVideoGeneratorState)(i.overallStore):(null==i?void 0:i.tabType)&&r(e)}catch(e){}}},34467:function(e,t,i){"use strict";i.d(t,{D:function(){return s}});var l=i(2784),a=i(84027),o=i(28879),r=i.n(o),n=i(51675);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{}=e,[t,i]=(0,l.useState)(null),[o,s]=(0,l.useState)(0),d=(0,l.useRef)(null),c=(0,n.T)(),u=(0,l.useMemo)(()=>null==t?void 0:t.memberPackage,[t]),m=(0,l.useMemo)(()=>{let e=(null==u?void 0:u.discountPercent)||0;return e%10==0?e/10:e},[u]),p=(0,l.useMemo)(()=>{let e=(null==u?void 0:u.countdownSeconds)||0;return r()(new Date((e-o)*1e3)).format("HH:mm:ss")},[u,o]),v=(0,l.useMemo)(()=>{let e=(null==u?void 0:u.originalPrice)||0,t=(null==u?void 0:u.firstMonthPrice)||0;return(e-t)/100},[u]),g=(0,l.useMemo)(()=>({title:"升级会员，首月低至".concat(((null==u?void 0:u.firstMonthPrice)||10)/100,"元"),subtitle:"解锁会员可商用模型，免排队",btnText:"会员首月低至 ".concat(((null==u?void 0:u.firstMonthPrice)||10)/100," 元")}),[m]),h=(0,l.useMemo)(()=>({title:"续费会员立享 ".concat(m," 折优惠"),subtitle:"解锁会员可商用模型，免排队",btnText:"续费会员"}),[m]),x=(0,l.useMemo)(()=>({title:"积分不够用？升级会员",subtitle:"权益叠加，更划算！",btnText:"升级会员"}),[]),f=(0,l.useMemo)(()=>{let e=(null==u?void 0:u.countdownSeconds)||0;return e?{title:"续费会员限时立减 \xa5".concat(v),subtitle:"优惠倒计时：".concat(p),btnText:"续费会员"}:{title:"提前续期会员，限时立减 \xa5".concat(v),subtitle:"全年优惠限时享",btnText:"续费会员"}},[u,v,p]),b=(0,l.useMemo)(()=>({title:"升级会员，积分叠加",subtitle:"使用积分更划算！",btnText:"升级会员"}),[]),j=(0,l.useMemo)(()=>{let e=null==t?void 0:t.group;switch(e){case 1:return g;case 7:return h;default:return null}},[t,g,h,x,f,b]),_=(0,l.useCallback)(async()=>{try{let e=await (0,a.eo)();(null==e?void 0:e.data)&&(i(e.data),y())}catch(e){console.error("Failed to fetch policy:",e)}},[]),y=(0,l.useCallback)(()=>{s(0),d.current=setInterval(()=>{s(e=>e+1)},1e3)},[]),N=(0,l.useCallback)(()=>{d.current&&(clearInterval(d.current),d.current=null)},[]),w=(0,l.useCallback)(()=>{c({e:"strategy_card_click",var:{user_type:null==t?void 0:t.group,button_type:j.btnText,source:"generator"}})},[t,j]);return(0,l.useEffect)(()=>(_(),()=>{N()}),[]),(0,l.useEffect)(()=>{t&&c({e:"strategy_card_exposure",var:{user_type:t.group,source:"generator"}})},[t]),{policyInfo:t,countup:o,tipInfo:j,memberPackage:u,discount:m,restTime:p,priceDown:v,fetchPolicy:_,startCount:y,stopCount:N,purchaseVipSku:w}}},50590:function(e,t,i){"use strict";i.r(t);var l=i(52322),a=i(95974),o=i(40045);let r=()=>(0,l.jsx)(o.Z,{});r.PageLayout=e=>(0,l.jsx)(a.I,{sidebarDefaultCollapsed:!0,topbarProps:{showTrainBtn:!0,showPowerBtn:!0,showSdBtn:!0,showVipButton:!0},metaHeaderProps:{title:"图片视频生成器 - LiblibAI"},...e}),t.default=r},94443:function(e,t,i){"use strict";i.d(t,{Sr:function(){return p},Wi:function(){return u},bw:function(){return s},km:function(){return m},qQ:function(){return d},rz:function(){return c}});var l=i(3554),a=i(67894),o=i(63880),r=i(11187),n=i(64031);let s=(e,t,i,l)=>{if(e||t.have)return!1;let o=((null==i?void 0:i.uuid)||"")+a.I.localKey,r=localStorage.getItem(o);if(r){let e=JSON.parse(r)||a.I.localData;if(e.time>=a.I.maxTime||Date.now()-new Date(e.lastOpenTime).getTime()<a.I.intervalTime)return!1}return!0},d=async()=>{try{let e=await l.DL.getExperienceCard({businessType:2,type:2});return e}catch(e){return null}},c=async()=>{try{var e;let t=await l.DL.getActivityCard({couponId:2});if((null===(e=t.couponList)||void 0===e?void 0:e.length)>0){let{lastAmount:e,id:i}=t.couponList[0];return n.commercialStore.getState().setAcceleratorCard({have:!0,time:e,id:i,showTime:t.isShow||!1}),(0,o.XK)({type:"refresh_vip_info",data:null}),r.ZP.success("领取成功"),!0}}catch(e){r.ZP.error("领取失败，请稍后再试"),console.error("领取加速卡失败:",e)}return!1},u=(e,t)=>{let i=((null==e?void 0:e.uuid)||"")+a.I.localKey;localStorage.setItem(i,JSON.stringify({time:t,lastOpenTime:new Date().toISOString()}))},m=e=>{let t=((null==e?void 0:e.uuid)||"")+a.I.localKey,i=localStorage.getItem(t);if(i){let e=JSON.parse(i)||a.I.localData;return e.time+1}return 1},p=async e=>{try{let t=((null==e?void 0:e.uuid)||"")+a.I.localKey,i=localStorage.getItem(t);if(i){let e=JSON.parse(i)||a.I.localData;if(e.time>=a.I.maxTime||Date.now()-new Date(e.lastOpenTime).getTime()<a.I.intervalTime)return{card:null,abTestGroup:null}}let l=await d();if((null==l?void 0:l.id)&&(null==l?void 0:l.abtest)){let e=l.abtest.group;return{card:l,abTestGroup:e}}return{card:null,abTestGroup:null}}catch(e){return{card:null,abTestGroup:null}}}},68355:function(e,t,i){"use strict";i.d(t,{T:function(){return b},Z:function(){return j}});var l=i(52322),a=i(2784),o=i(64031),r=i(44930),n=i(94443),s=i(51675),d=i(37787),c=i.n(d);let u=e=>{let{show:t,onClose:i,className:r,getCard:n,queueNum:d}=e,{total:u}=(0,o.commercialStore)(),m=(0,s.T)(),{sence:p}=a.useContext(b);return((0,a.useEffect)(()=>{t&&m({e:"queue_jump_card_novice.show",var:{from:p}})},[t]),t)?(0,l.jsxs)("div",{className:"".concat(c().speedBoxWrap," ").concat(r||""),children:[(0,l.jsx)("div",{className:c().speedbg}),(0,l.jsxs)("div",{className:c().speedBoxAbtest,children:[(0,l.jsx)("div",{className:c().title,children:"开启生图加速"}),(0,l.jsxs)("div",{className:c().tips,children:[(0,l.jsx)("span",{className:c().tipsLeft}),(0,l.jsxs)("span",{className:c().tipsCenter,children:["当前生图排队人数 ",(0,l.jsx)("span",{className:c().tipn,children:d})]}),(0,l.jsx)("span",{className:c().tipsRight})]}),(0,l.jsxs)("div",{className:c().countWrap,children:[(0,l.jsx)("span",{className:c().conut,children:u}),(0,l.jsx)("span",{className:c().numt,children:"次"}),(0,l.jsx)("span",{className:c().countLine}),(0,l.jsxs)("div",{className:c().countTip,children:[(0,l.jsx)("div",{className:c().coTip,children:"生图加速特权"}),(0,l.jsx)("div",{className:c().conutTip,children:"告别排队等待"})]})]}),(0,l.jsx)("img",{className:c().closeBox,src:"https://liblibai-online.liblib.cloud/web/ef0097ae9da74189a0f5d604e98c77cd/26333927-fd9f-4886-a639-bd59caaeb946.png",width:"32",onClick:()=>{i(),m({e:"queue_jump_card_novice.close",var:{from:p}})}}),(0,l.jsx)("div",{className:c().getBtn,onClick:n,children:"领取加速体验卡"})]})]}):null};var m=e=>{let{className:t,queueNum:i}=e||{},[r,d]=(0,a.useState)(!1),c=(0,o.useCurrentUser)(),m=(0,s.T)(),{sence:p}=a.useContext(b),v=(0,a.useCallback)(async()=>{await (0,n.rz)(),m({e:"queue_jump_card_novice.receive",var:{from:p}}),d(!1)},[]),g=a.useRef(!0),h=(0,a.useCallback)(()=>{g.current&&(g.current=!1,d(!0))},[null==c?void 0:c.uuid]);return[{show:h},(0,l.jsx)(u,{show:r,queueNum:i,onClose:()=>d(!1),className:t,getCard:v})]},p=i(1111),v=i.n(p);let g=e=>{let{onClose:t,className:i,getCard:r,queueNum:n}=e,{total:d}=(0,o.commercialStore)(),c=(0,s.T)(),{sence:u}=a.useContext(b);return(0,a.useEffect)(()=>{c({e:"accelerate_card_pop.show",var:{from:u}})},[]),(0,l.jsx)("div",{className:"".concat(v().speedBoxWrap," ").concat(i||""),children:(0,l.jsxs)("div",{className:v().speedBox,children:[(0,l.jsx)("div",{className:v().title,children:"免费体验插队加速"}),(0,l.jsx)("div",{className:v().tips,children:(0,l.jsxs)("span",{className:v().tipsCenter,children:["当前生图排队人数 ",(0,l.jsx)("span",{className:v().tipn,children:n||0})]})}),(0,l.jsxs)("div",{className:v().countWrap,children:[(0,l.jsxs)("div",{className:v().countTip,children:[(0,l.jsx)("div",{className:v().coTip,children:"生图加速特权"}),(0,l.jsx)("div",{className:v().conutTip,children:"告别排队等待"})]}),(0,l.jsx)("span",{className:v().countLine}),(0,l.jsx)("span",{className:v().conut,children:d||10}),(0,l.jsx)("span",{className:v().numt,children:"次"})]}),(0,l.jsx)("img",{className:v().closeBox,src:"https://liblibai-online.liblib.cloud/web/1656e2f1b3c74f1ba823b610f1b2cbdf/a6d3e935-e687-4079-a3d2-b7af9b324ed7.png",width:"24",onClick:()=>{t(),c({e:"accelerate_card_pop.close",var:{from:u}})}}),(0,l.jsx)("div",{className:v().getBtn,onClick:r,children:"开启加速"})]})})};var h=e=>{let{queueNum:t,vipSpeedup:i}=e,[r,d]=(0,a.useState)(!1),c=(0,o.useCurrentUser)(),u=(0,s.T)(),{sence:m}=a.useContext(b),p=(0,a.useCallback)(async()=>{await (0,n.rz)()},[i]),v=(0,a.useCallback)(()=>{h.current&&(h.current=!1,p(),d(!0),u&&u({e:"accelerate_card_pop.receive",var:{from:m}}),setTimeout(()=>{d(!1)},1e4))},[null==c?void 0:c.uuid]),h=(0,a.useRef)(!0),x=r?(0,l.jsx)(g,{queueNum:t||0,onClose:()=>d(!1),getCard:()=>{i(),d(!1)}}):void 0;return{abtestB:{show:v},abtestBComponent:x}},x=i(78323),f=i.n(x);let b=a.createContext({sence:""});function j(e){let{queueNum:t,vipSpeedup:s,sence:d}=e,{isVip:c}=(0,r.RR)(),{acceleratorCard:u,setTotal:p}=(0,o.commercialStore)(),v=(0,o.useCurrentUser)(),[g,x]=a.useState(null),j=(0,a.useRef)(!1),[_,y]=m({className:f().businessSpeedAbtest,queueNum:t}),{abtestB:N,abtestBComponent:w}=h({queueNum:t||0,vipSpeedup:s}),I=a.useCallback(async()=>{if(console.log("[SpeedAcceleration] AB测试检测开始:",{isDetected:j.current,isVip:c,hasAcceleratorCard:u.have,currentUserId:null==v?void 0:v.id,sence:d}),j.current||c||u.have){console.log("[SpeedAcceleration] AB测试检测跳过:",{reason:j.current?"已检测":c?"是VIP":"已有加速卡"});return}let{abTestGroup:e,card:t}=await (0,n.Sr)(v);if(console.log("[SpeedAcceleration] AB测试检测结果:",{group:e,card:t?{timesLimit:t.timesLimit}:null}),t&&p(t.timesLimit||0),e){console.log("[SpeedAcceleration] 设置AB测试组:",e),x(e),j.current=!0,"newuser_priority_pay_exp_1"===e?(console.log("[SpeedAcceleration] 显示A组测试"),_.show()):"newuser_priority_pay_exp_2"===e&&(console.log("[SpeedAcceleration] 显示B组测试"),N.show());let t=(0,n.km)(v);console.log("[SpeedAcceleration] 更新本地存储:",{times:t}),(0,n.Wi)(v,t)}},[c,u.have,v,_.show,N.show]);(0,a.useEffect)(()=>{console.log("[SpeedAcceleration] Queue监听:",{queueNum:t,queueLimit:i.g.QUEUE_NUM_LIMIT||10,shouldTrigger:t&&t>=(i.g.QUEUE_NUM_LIMIT||10),isVip:c,hasAcceleratorCard:u.have,sence:d}),t&&t>=(i.g.QUEUE_NUM_LIMIT||10)&&(console.log("[SpeedAcceleration] 触发AB测试检测"),I())},[t,I]);let T=a.useCallback(()=>"newuser_priority_pay_exp_1"===g?y:"newuser_priority_pay_exp_2"===g?w:void 0,[g,y,w]);return{SpeedAccelerationComponent:()=>(0,l.jsx)(b.Provider,{value:{sence:d},children:(0,l.jsx)(T,{})})}}},76882:function(e,t,i){"use strict";i.d(t,{c:function(){return a}});let l=[],a=e=>{if(!e)return e;let t=e.data||[];if(!t.length)return e;let i=e.page;1===i&&(l=[]);let a=[];t.forEach(e=>{let t=function(e){let t=e.isActivity?1:0;return"".concat(e.uuid,"_").concat(t)}(e);!e.uuid||l.includes(t)||(a.push(e),l.push(t))});let o={...e,data:a};return o}},87234:function(e){e.exports={imgListWrap:"editor-recommend_imgListWrap___vJGa",imgItemCard:"editor-recommend_imgItemCard__dZzC6",imgItem:"editor-recommend_imgItem__Te_qn",imgHoverBg:"editor-recommend_imgHoverBg__TGttD",imgBtn:"editor-recommend_imgBtn__Q_zi3",imgBtnItem:"editor-recommend_imgBtnItem__tZGy3",rotate_animation:"editor-recommend_rotate_animation__1qQIg",rotate_active:"editor-recommend_rotate_active__dodVz",rotate:"editor-recommend_rotate__lOOKV",imgListWrapTitleLeftTitle:"editor-recommend_imgListWrapTitleLeftTitle__C33K0",imgListWrapTitleLeftTitleText:"editor-recommend_imgListWrapTitleLeftTitleText__W6Jz_",expandIcon:"editor-recommend_expandIcon__5Esq8",expanded:"editor-recommend_expanded__7FsWQ",container:"editor-recommend_container__Wvh5u",collapsed:"editor-recommend_collapsed__Or5W4",scrollContainer:"editor-recommend_scrollContainer__eXbZS",contentWrapper:"editor-recommend_contentWrapper__XqA5n",arrowButtonWrap:"editor-recommend_arrowButtonWrap__fVYi6",arrowButtonbgRight:"editor-recommend_arrowButtonbgRight__xCby_",arrowButton:"editor-recommend_arrowButton__lMXdN",loadingIndicator:"editor-recommend_loadingIndicator__0QD_B",loadingSpinner:"editor-recommend_loadingSpinner__FDTpG",spin:"editor-recommend_spin__ZYclf",imgItemCardActive:"editor-recommend_imgItemCardActive__vu1Rz"}},55825:function(e){e.exports={editorSearchContainer:"editor-search_editorSearchContainer__C_qRb",timeDropdown:"editor-search_timeDropdown__Zbzn3",generationTypeDropdown:"editor-search_generationTypeDropdown__WqtGY",timeSelectWrapper:"editor-search_timeSelectWrapper__byQ3d",separator:"editor-search_separator__LtBsm",generationTypeWrapper:"editor-search_generationTypeWrapper__cWO5_",select:"editor-search_select__7Lv7O",suffixIcon:"editor-search_suffixIcon__jOPi4",timeDropdownContent:"editor-search_timeDropdownContent__KDrBV",dateRangeSection:"editor-search_dateRangeSection__nTKdM",datePickerWrapper:"editor-search_datePickerWrapper__zlZ_2",dateLabel:"editor-search_dateLabel__Ld5Zc",datePicker:"editor-search_datePicker__IHw2y",timeOption:"editor-search_timeOption__yZyVb",timeOptionSelected:"editor-search_timeOptionSelected__S9C8z",generationTypeOptionSelected:"editor-search_generationTypeOptionSelected__oSxRc",checkIcon:"editor-search_checkIcon__ipSX6",generationTypeDropdownContent:"editor-search_generationTypeDropdownContent__8KUsV",generationTypeOption:"editor-search_generationTypeOption___wuNh",unReadTag:"editor-search_unReadTag__w_5cW",editorSearchContainerDark:"editor-search_editorSearchContainerDark__Pqt2G",datePickerDropdown:"editor-search_datePickerDropdown__Vrg_W"}},40679:function(e){e.exports={inspirationLibrary:"inspiration-library_inspirationLibrary__btDvs",entry:"inspiration-library_entry__K2YZp",inspirationLibraryContent:"inspiration-library_inspirationLibraryContent__NQV3a",inspirationList:"inspiration-library_inspirationList__5kA4M",inspirationBottomBg:"inspiration-library_inspirationBottomBg__sBzyG",inspirationLibraryOpen:"inspiration-library_inspirationLibraryOpen___ArJz",slideUp:"inspiration-library_slideUp__o7N1D",inspirationDark:"inspiration-library_inspirationDark__he7_z",inspirationLibraryMobile:"inspiration-library_inspirationLibraryMobile__PXsA2"}},36429:function(e){e.exports={imgRow:"editor-historyList_imgRow__zDr0F",videoImgRow:"editor-historyList_videoImgRow__Z0vIT",imageList:"editor-historyList_imageList__JhDhL",tagWrapper:"editor-historyList_tagWrapper__3mwsh",imgF1:"editor-historyList_imgF1__mR9Lv",imgF2:"editor-historyList_imgF2__vay6q",imgF3:"editor-historyList_imgF3__NQnpK",imgF4:"editor-historyList_imgF4__jsOr0",imgF5:"editor-historyList_imgF5__RXwF4",imgF6:"editor-historyList_imgF6__7WIoi",imgF7:"editor-historyList_imgF7__FOOVf",oneImgF4:"editor-historyList_oneImgF4__48JVa",oneImgF5:"editor-historyList_oneImgF5__07KOC",oneImgF6:"editor-historyList_oneImgF6__ALL6g",videoList:"editor-historyList_videoList___PwpL",tagWrapperVideo:"editor-historyList_tagWrapperVideo__jBz0l",prompt:"editor-historyList_prompt__dpV8A",promptCont:"editor-historyList_promptCont__yma5J",promptCopyItem:"editor-historyList_promptCopyItem__DCxiL",promptCopyItemIcon:"editor-historyList_promptCopyItemIcon__gq90n",promptCopy:"editor-historyList_promptCopy__NB7jG",action:"editor-historyList_action__QXDU0",actionSpan:"editor-historyList_actionSpan__lotrL",dark:"editor-historyList_dark__y1GZr",deleteAction:"editor-historyList_deleteAction__Y_XRG",size:"editor-historyList_size__B7c3n",imgLabel:"editor-historyList_imgLabel__km1N2",imgModelWrap:"editor-historyList_imgModelWrap__vR_sS",imgModelWrapHover:"editor-historyList_imgModelWrapHover__4VT8K",imgModelWrapHoverBg:"editor-historyList_imgModelWrapHoverBg__pIgLw",mixModelWrap:"editor-historyList_mixModelWrap__b2Gfd",mixModel:"editor-historyList_mixModel__fuOBY",mixModelHover:"editor-historyList_mixModelHover__sthvn",mixModelName:"editor-historyList_mixModelName__p8DBY",hoverCover:"editor-historyList_hoverCover__QwTdt",hoverBg:"editor-historyList_hoverBg__pMoEI",actionImage:"editor-historyList_actionImage__7Hjnk",actionImagev:"editor-historyList_actionImagev__dxdv4",PopoverText:"editor-historyList_PopoverText__k0z16",videoContent:"editor-historyList_videoContent__q3LPB",iconWrapper:"editor-historyList_iconWrapper__Tswzw",actionButton:"editor-historyList_actionButton__q4jAD",videoImageCard:"editor-historyList_videoImageCard__S4CHI",sizeFlex:"editor-historyList_sizeFlex__Qc_Ly",imgModel:"editor-historyList_imgModel__8pTMs",loadingInfo:"editor-historyList_loadingInfo__eoH1A",actionTxt:"editor-historyList_actionTxt__F_rqI",loadingImageList:"editor-historyList_loadingImageList__ZRZrA",loadingVideoList:"editor-historyList_loadingVideoList__Z82nZ"}},78323:function(e){e.exports={businessSpeedAbtest:"Business_businessSpeedAbtest__uExUZ"}},1111:function(e){e.exports={speedBoxWrap:"speed_c_speedBoxWrap__kzEdi",speedBox:"speed_c_speedBox__77_CC",title:"speed_c_title___yCjH",tips:"speed_c_tips__TZhPX",tipsLeft:"speed_c_tipsLeft__NNjhB",tipsCenter:"speed_c_tipsCenter__q49oE",tipsRight:"speed_c_tipsRight__Ven7J",tipn:"speed_c_tipn__1UInS",closeBox:"speed_c_closeBox__tlT1a",countWrap:"speed_c_countWrap__dldh3",conut:"speed_c_conut__QdcZq",countLine:"speed_c_countLine__2zyfn",numt:"speed_c_numt__SluZJ",countTip:"speed_c_countTip__vras7",coTip:"speed_c_coTip__93_SC",conutTip:"speed_c_conutTip__ko4k3",getBtn:"speed_c_getBtn__7QXck",getTip:"speed_c_getTip__ZgGrd",speedbg:"speed_c_speedbg__6smYN"}},37787:function(e){e.exports={speedBox:"speed_speedBox__n00KU",title:"speed_title__8t_JQ",tips:"speed_tips__Cbe47",countWrap:"speed_countWrap__TotJn",countTipWrap:"speed_countTipWrap__FywWU",coTip:"speed_coTip__yz6XR",conutTip:"speed_conutTip__lIz_R",countLine:"speed_countLine__tZsXV",conut:"speed_conut__s6yxS",numt:"speed_numt__oheuH",closeBox:"speed_closeBox__WLOU9",getBtn:"speed_getBtn__zu3O2",getTip:"speed_getTip__ehWxo",speedBoxAbtest:"speed_speedBoxAbtest__Gj9DT",highlight:"speed_highlight__ZRSBm",tipsLeft:"speed_tipsLeft__ffouI",tipsCenter:"speed_tipsCenter__0WgRT",tipsRight:"speed_tipsRight__ETby0",countTip:"speed_countTip__oRKN9",tipn:"speed_tipn__V5SUY",speedbg:"speed_speedbg__9tnq7"}},7319:function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxMCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTcuNjQ2NDggMy4xNDc0NkM3Ljg0MTc1IDIuOTUyMjUgOC4xNTgyNyAyLjk1MjIyIDguMzUzNTIgMy4xNDc0NkM4LjU0ODMyIDMuMzQyNzQgOC41NDg1OCAzLjY1OTM3IDguMzUzNTIgMy44NTQ0OUw1LjM1MzUyIDYuODU0NDlDNS4xNTg0IDcuMDQ5NjEgNC44NDE3OCA3LjA0OTMyIDQuNjQ2NDggNi44NTQ0OUwxLjY0NjQ4IDMuODU0NDlDMS40NTEyMiAzLjY1OTIzIDEuNDUxMjIgMy4zNDI3MiAxLjY0NjQ4IDMuMTQ3NDZDMS44NDE3NSAyLjk1MjI1IDIuMTU4MjcgMi45NTIyMiAyLjM1MzUyIDMuMTQ3NDZMNSA1Ljc5Mzk1TDcuNjQ2NDggMy4xNDc0NloiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuNiIvPgo8cGF0aCBkPSJNNy42NDY0OCA3LjE0NzQ2QzcuODQxNzUgNi45NTIyNSA4LjE1ODI3IDYuOTUyMjIgOC4zNTM1MiA3LjE0NzQ2QzguNTQ4MzIgNy4zNDI3NCA4LjU0ODU4IDcuNjU5MzcgOC4zNTM1MiA3Ljg1NDQ5TDUuMzUzNTIgMTAuODU0NUM1LjE1ODQgMTEuMDQ5NiA0Ljg0MTc4IDExLjA0OTMgNC42NDY0OCAxMC44NTQ1TDEuNjQ2NDggNy44NTQ0OUMxLjQ1MTIyIDcuNjU5MjMgMS40NTEyMiA3LjM0MjcyIDEuNjQ2NDggNy4xNDc0NkMxLjg0MTc1IDYuOTUyMjUgMi4xNTgyNyA2Ljk1MjIyIDIuMzUzNTIgNy4xNDc0Nkw1IDkuNzkzOTVMNy42NDY0OCA3LjE0NzQ2WiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC42Ii8+Cjwvc3ZnPgo="},30051:function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxMCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTcuNjQ2NDggMy4xNDc0NkM3Ljg0MTc1IDIuOTUyMjUgOC4xNTgyNyAyLjk1MjIyIDguMzUzNTIgMy4xNDc0NkM4LjU0ODMyIDMuMzQyNzQgOC41NDg1OCAzLjY1OTM3IDguMzUzNTIgMy44NTQ0OUw1LjM1MzUyIDYuODU0NDlDNS4xNTg0IDcuMDQ5NjEgNC44NDE3OCA3LjA0OTMyIDQuNjQ2NDggNi44NTQ0OUwxLjY0NjQ4IDMuODU0NDlDMS40NTEyMiAzLjY1OTIzIDEuNDUxMjIgMy4zNDI3MiAxLjY0NjQ4IDMuMTQ3NDZDMS44NDE3NSAyLjk1MjI1IDIuMTU4MjcgMi45NTIyMiAyLjM1MzUyIDMuMTQ3NDZMNSA1Ljc5Mzk1TDcuNjQ2NDggMy4xNDc0NloiIGZpbGw9IiM2NjY2NjYiLz4KPHBhdGggZD0iTTcuNjQ2NDggNy4xNDc0NkM3Ljg0MTc1IDYuOTUyMjUgOC4xNTgyNyA2Ljk1MjIyIDguMzUzNTIgNy4xNDc0NkM4LjU0ODMyIDcuMzQyNzQgOC41NDg1OCA3LjY1OTM3IDguMzUzNTIgNy44NTQ0OUw1LjM1MzUyIDEwLjg1NDVDNS4xNTg0IDExLjA0OTYgNC44NDE3OCAxMS4wNDkzIDQuNjQ2NDggMTAuODU0NUwxLjY0NjQ4IDcuODU0NDlDMS40NTEyMiA3LjY1OTIzIDEuNDUxMjIgNy4zNDI3MiAxLjY0NjQ4IDcuMTQ3NDZDMS44NDE3NSA2Ljk1MjI1IDIuMTU4MjcgNi45NTIyMiAyLjM1MzUyIDcuMTQ3NDZMNSA5Ljc5Mzk1TDcuNjQ2NDggNy4xNDc0NloiIGZpbGw9IiM2NjY2NjYiLz4KPC9zdmc+Cg=="},55:function(e){e.exports="https://liblibai-web-static.liblib.cloud/liblibai_v4_online/static/_next/static/images/modeIBg.080fabb98d227540dbb1f14e494904ef.png"},16409:function(e){e.exports="https://liblibai-web-static.liblib.cloud/liblibai_v4_online/static/_next/static/images/modeIBgDark.835e60821dad7099eab68d5c4623da49.png"}},function(e){e.O(0,[3866,2812,5417,4043,4282,6023,7905,9506,4741,1059,436,6116,1633,4749,7538,755,4875,4658,8943,8799,2739,3354,5014,8596,4321,9405,886,5195,7539,6155,1127,9210,8505,2110,2866,830,613,6281,4009,1055,2926,7725,9517,6378,9774,2888,179],function(){return e(e.s=54372)}),_N_E=e.O()}]);



window.onload = function() {
  // 这里写你要执行的代码
  console.log("所有资源加载完成，执行核心逻辑");
  // 示例：操作DOM、初始化组件、绑定事件等
  const btn = document.getElementById("saveBtn");
  if (btn) {
    btn.addEventListener("click", () => {
      alert("按钮点击触发");
    });
  }
};
